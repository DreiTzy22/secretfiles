<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DigiNursing v2</title>
  <link rel="icon" type="image/png" href="capybara/cute-capibara-character-different-poses.png">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&family=Nunito:wght@400;600;700&family=Dancing+Script:wght@500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --pink-light: #fff0f5;
      --pink-mid: #ffc0d9;
      --pink-accent: #ff85b3;
      --pink-dark: #e91e8c;
      --pink-soft: #ffe4ec;
      --white: #fffafc;
      --text: #5c3a4a;
      --shadow: rgba(233, 30, 140, 0.15);
      /* Capybara / chill nature */
      --capybara-brown: #8B7355;
      --capybara-dark: #6B5344;
      --capybara-sage: #9CAF88;
      --capybara-grass: #7CB342;
      --capybara-warm: #A0826D;
      /* Nursing / care */
      --nursing-blue: #64B5F6;
      --nursing-light: #B3E5FC;
      --nursing-soft: #E3F2FD;
      --nursing-red: #E57373;
      --nursing-teal: #4DB6AC;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Nunito', sans-serif;
      background: linear-gradient(165deg, #fff5f9 0%, #ffe4ef 25%, #E8F5E9 50%, #E3F2FD 75%, #ffd6e8 100%);
      color: var(--text);
      min-height: 100vh;
      padding: 2rem;
      background-attachment: fixed;
      position: relative;
      overflow-x: hidden;
    }

    body::before {
      content: '';
      position: fixed;
      inset: 0;
      background-image:
        url('capybara/cute-capibara-character-different-poses.png'),
        url('capybara/cute-capibara-character-different-poses.png'),
        radial-gradient(circle at 10% 20%, rgba(156, 175, 136, 0.08) 0%, transparent 25%),
        radial-gradient(circle at 90% 80%, rgba(100, 181, 246, 0.08) 0%, transparent 25%);
      background-size: 200px auto, 180px auto, auto, auto;
      background-position: 2% 88%, 98% 88%, 0 0, 0 0;
      background-repeat: no-repeat, no-repeat, no-repeat, no-repeat;
      opacity: 0.3;
      pointer-events: none;
      z-index: 0;
    }

    h1 {
      font-family: 'Quicksand', sans-serif;
      font-size: 2.75rem;
      text-align: center;
      margin-bottom: 0.5rem;
      background: linear-gradient(135deg, var(--pink-dark), var(--pink-accent), var(--capybara-brown));
      background-size: 200% auto;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-weight: 700;
    }

    .tagline {
      text-align: center;
      font-size: 1rem;
      color: var(--capybara-brown);
      margin-bottom: 2rem;
      font-weight: 600;
      letter-spacing: 0.15em;
    }

    .tagline span { margin: 0 0.5rem; color: var(--nursing-blue); }

    .header-with-capybara {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 1.5rem;
      margin-bottom: 0.5rem;
      flex-wrap: wrap;
    }

    .header-capybara {
      width: 80px;
      height: 80px;
      object-fit: contain;
      opacity: 0.9;
    }

    .header-capybara.left { transform: scaleX(-1); }

    .container {
      max-width: 900px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
      gap: 2rem;
      position: relative;
      z-index: 1;
    }

    /* Message Card - nursing care vibes */
    .message-card {
      background: linear-gradient(145deg, var(--white), var(--nursing-soft));
      border-radius: 24px;
      padding: 1.75rem 2rem;
      box-shadow: 0 8px 32px var(--shadow), 0 0 0 1px rgba(100, 181, 246, 0.3);
      border: 2px solid var(--nursing-blue);
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .message-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 12px 40px rgba(233, 30, 140, 0.2);
    }

    .message-card h2 {
      font-family: 'Quicksand', sans-serif;
      font-size: 1.3rem;
      margin-bottom: 0.75rem;
      color: var(--nursing-blue);
      font-weight: 700;
    }

    .message-card h2::before { content: '‚ù§Ô∏è '; }

    .message-card textarea {
      width: 100%;
      min-height: 100px;
      padding: 1rem;
      border: 2px solid var(--nursing-light);
      border-radius: 16px;
      font-family: 'Nunito', sans-serif;
      font-size: 1rem;
      resize: vertical;
      transition: border-color 0.2s;
      background: var(--pink-light);
    }

    .message-card textarea:focus {
      outline: none;
      border-color: var(--nursing-blue);
      background: white;
    }

    .message-card textarea::placeholder {
      color: #c99ab0;
    }

    /* Photo Booth - capybara chill vibes */
    .photo-booth {
      background: linear-gradient(145deg, var(--white), rgba(156, 175, 136, 0.15));
      border-radius: 24px;
      padding: 1.75rem 2rem;
      box-shadow: 0 8px 32px var(--shadow), 0 0 0 1px rgba(139, 115, 85, 0.25);
      border: 2px solid var(--capybara-sage);
    }

    .photo-booth h2 {
      font-family: 'Quicksand', sans-serif;
      font-size: 1.3rem;
      margin-bottom: 1rem;
      color: var(--capybara-brown);
      font-weight: 700;
    }

    .photo-booth h2::before { content: 'üì∑ '; }

    .camera-container {
      position: relative;
      background: linear-gradient(145deg, #9CAF88 0%, #7CB342 50%, #64B5F6 100%);
      border-radius: 20px;
      overflow: hidden;
      aspect-ratio: 4/3;
      max-height: 400px;
      border: 3px solid var(--capybara-sage);
      box-shadow: inset 0 0 20px rgba(255,255,255,0.3), 0 4px 20px rgba(139, 115, 85, 0.2);
    }

    #video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      transform: scaleX(-1);
    }

    .camera-placeholder {
      position: absolute;
      inset: 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: white;
      background: linear-gradient(145deg, #8B7355 0%, #7CB342 50%, #4DB6AC 100%);
      gap: 0.75rem;
      text-shadow: 0 1px 2px rgba(0,0,0,0.2);
    }

    .camera-placeholder.hidden {
      display: none;
    }

    .placeholder-capybara {
      width: 72px;
      height: 72px;
      object-fit: contain;
      opacity: 0.9;
    }

    .camera-placeholder svg {
      width: 48px;
      height: 48px;
      opacity: 0.7;
    }

    .controls {
      display: flex;
      gap: 0.75rem;
      margin-top: 1rem;
      flex-wrap: wrap;
      align-items: center;
    }

    .timer-options {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-left: auto;
    }

    .timer-options span {
      font-size: 0.85rem;
      color: var(--text);
      font-weight: 600;
    }

    .timer-btn {
      padding: 0.4rem 0.75rem;
      font-size: 0.85rem;
      border-radius: 12px;
      border: 2px solid var(--pink-mid);
      background: var(--pink-light);
      color: var(--pink-dark);
      font-family: 'Quicksand', sans-serif;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.15s;
    }

    .timer-btn:hover {
      background: var(--pink-mid);
      color: white;
    }

    .timer-btn.active {
      background: var(--pink-accent);
      border-color: var(--pink-dark);
      color: white;
    }

    .filter-options {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .filter-options span {
      font-size: 0.85rem;
      color: var(--text);
      font-weight: 600;
    }

    .filter-btn {
      width: 44px;
      height: 44px;
      padding: 6px;
      border: 2px solid var(--pink-mid);
      border-radius: 12px;
      background: var(--pink-light);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.15s;
      font-size: 1.2rem;
    }

    .filter-btn:hover {
      background: var(--pink-mid);
      transform: scale(1.05);
    }

    .filter-btn.active {
      background: linear-gradient(135deg, var(--pink-accent), var(--nursing-teal));
      border-color: var(--capybara-brown);
      box-shadow: 0 0 0 2px rgba(139, 115, 85, 0.3);
    }

    .effect-options {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .effect-options span {
      font-size: 0.85rem;
      color: var(--text);
      font-weight: 600;
    }

    .filter-overlay-canvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 5;
      display: none;
      transform: scaleX(-1);
    }

    .countdown-overlay {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.4);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 10;
      border-radius: 20px;
    }

    .countdown-overlay.visible {
      display: flex;
    }

    .grid-overlay {
      position: absolute;
      inset: 0;
      pointer-events: none;
      z-index: 4;
      display: none;
      border-radius: 20px;
    }

    .grid-overlay.visible {
      display: block;
      background-image:
        linear-gradient(to right, transparent calc(33.33% - 1px), rgba(255,255,255,0.5) calc(33.33% - 1px), rgba(255,255,255,0.5) calc(33.33% + 1px), transparent calc(33.33% + 1px)),
        linear-gradient(to right, transparent calc(66.67% - 1px), rgba(255,255,255,0.5) calc(66.67% - 1px), rgba(255,255,255,0.5) calc(66.67% + 1px), transparent calc(66.67% + 1px)),
        linear-gradient(to bottom, transparent calc(33.33% - 1px), rgba(255,255,255,0.5) calc(33.33% - 1px), rgba(255,255,255,0.5) calc(33.33% + 1px), transparent calc(33.33% + 1px)),
        linear-gradient(to bottom, transparent calc(66.67% - 1px), rgba(255,255,255,0.5) calc(66.67% - 1px), rgba(255,255,255,0.5) calc(66.67% + 1px), transparent calc(66.67% + 1px));
      background-size: 100% 100%;
      background-repeat: no-repeat;
    }

    .flash-overlay {
      position: absolute;
      inset: 0;
      background: white;
      pointer-events: none;
      z-index: 15;
      opacity: 0;
      transition: opacity 0.05s;
      border-radius: 20px;
    }

    .flash-overlay.flash {
      opacity: 1;
      animation: flash-burst 0.25s ease-out forwards;
    }

    @keyframes flash-burst {
      0% { opacity: 1; }
      100% { opacity: 0; }
    }

    .effect-btn {
      padding: 0.4rem 0.65rem;
      font-size: 0.9rem;
      border-radius: 12px;
      border: 2px solid var(--pink-mid);
      background: var(--pink-light);
      cursor: pointer;
      transition: transform 0.15s, background 0.15s;
    }

    .effect-btn:hover, .effect-btn.active {
      background: var(--pink-mid);
      color: white;
    }

    .effect-btn.active {
      border-color: var(--capybara-brown);
      box-shadow: 0 0 0 2px rgba(139, 115, 85, 0.3);
    }

    .toggle-option {
      display: flex;
      align-items: center;
      gap: 0.4rem;
      font-size: 0.85rem;
      color: var(--text);
      font-weight: 600;
      cursor: pointer;
    }

    .toggle-option input {
      accent-color: var(--pink-accent);
    }

    .countdown-number {
      font-family: 'Quicksand', sans-serif;
      font-size: 5rem;
      font-weight: 700;
      color: white;
      text-shadow: 0 0 20px rgba(233, 30, 140, 0.6);
      animation: countdown-pulse 1s ease-out;
    }

    @keyframes countdown-pulse {
      0% { transform: scale(0.5); opacity: 0; }
      30% { transform: scale(1.2); opacity: 1; }
      70% { transform: scale(1); opacity: 1; }
      100% { transform: scale(1); opacity: 0.8; }
    }

    .btn {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 16px;
      font-family: 'Quicksand', sans-serif;
      font-size: 0.95rem;
      font-weight: 700;
      cursor: pointer;
      transition: transform 0.15s, opacity 0.15s, box-shadow 0.15s;
    }

    .btn:hover {
      transform: translateY(-2px);
    }

    .btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--pink-dark), var(--pink-accent));
      color: white;
      box-shadow: 0 4px 15px rgba(233, 30, 140, 0.4);
    }

    .btn-primary:hover:not(:disabled) {
      box-shadow: 0 6px 20px rgba(233, 30, 140, 0.5);
    }

    .btn-secondary {
      background: linear-gradient(135deg, #ff85b3, #ffb3d0);
      color: white;
      box-shadow: 0 4px 15px rgba(255, 133, 179, 0.4);
    }

    .btn-outline {
      background: transparent;
      color: var(--pink-dark);
      border: 2px solid var(--pink-accent);
    }

    .btn-outline:hover:not(:disabled) {
      background: var(--pink-light);
    }

    /* Gallery - blend */
    .gallery {
      background: linear-gradient(145deg, var(--white), rgba(156, 175, 136, 0.08));
      border-radius: 24px;
      padding: 1.75rem 2rem;
      box-shadow: 0 8px 32px var(--shadow), 0 0 0 1px rgba(139, 115, 85, 0.2);
      border: 2px solid var(--capybara-warm);
    }

    .gallery h2 {
      font-family: 'Quicksand', sans-serif;
      font-size: 1.3rem;
      margin-bottom: 1rem;
      color: var(--capybara-brown);
      font-weight: 700;
    }

    .gallery h2::before { content: 'üñºÔ∏è '; }

    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 0.75rem;
    }

    .gallery-item {
      position: relative;
      aspect-ratio: 1;
      border-radius: 16px;
      overflow: hidden;
      box-shadow: 0 4px 15px var(--shadow);
      border: 2px solid var(--capybara-sage);
      cursor: pointer;
      transition: border-color 0.2s, box-shadow 0.2s;
    }

    .gallery-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .gallery-item .download-btn {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 0.5rem;
      background: linear-gradient(to top, rgba(233, 30, 140, 0.9), rgba(255, 133, 179, 0.9));
      color: white;
      font-size: 0.75rem;
      font-weight: 600;
      border: none;
      cursor: pointer;
      opacity: 0;
      transition: opacity 0.2s;
      font-family: 'Quicksand', sans-serif;
    }

    .gallery-item:hover .download-btn {
      opacity: 1;
    }

    .gallery-empty {
      text-align: center;
      padding: 2rem;
      color: var(--pink-accent);
      font-style: italic;
    }

    /* Nursing Mini Game */
    .minigame-section {
      background: linear-gradient(145deg, var(--white), var(--nursing-soft));
      border-radius: 24px;
      padding: 1.75rem 2rem;
      box-shadow: 0 8px 32px var(--shadow), 0 0 0 1px rgba(100, 181, 246, 0.3);
      border: 2px solid var(--nursing-blue);
    }

    .minigame-section h2 {
      font-family: 'Quicksand', sans-serif;
      font-size: 1.3rem;
      margin-bottom: 0.5rem;
      color: var(--nursing-blue);
      font-weight: 700;
    }

    .minigame-section h2::before { content: 'ü©∫ '; }

    /* Budget Tracker */
    .budget-section {
      background: linear-gradient(145deg, var(--white), rgba(77, 182, 172, 0.12));
      border-radius: 24px;
      padding: 1.75rem 2rem;
      box-shadow: 0 8px 32px var(--shadow), 0 0 0 1px rgba(77, 182, 172, 0.3);
      border: 2px solid var(--nursing-teal);
    }

    .budget-section h2 {
      font-family: 'Quicksand', sans-serif;
      font-size: 1.3rem;
      margin-bottom: 1rem;
      color: var(--nursing-teal);
      font-weight: 700;
    }

    .budget-section h2::before { content: 'üí∞ '; }

    .budget-overview {
      display: flex;
      gap: 1rem;
      flex-wrap: wrap;
      margin-bottom: 1.5rem;
    }

    .budget-card {
      flex: 1;
      min-width: 140px;
      padding: 1rem 1.25rem;
      border-radius: 16px;
      text-align: center;
    }

    .budget-card.total {
      background: linear-gradient(145deg, var(--nursing-soft), var(--pink-light));
      border: 2px solid var(--nursing-teal);
    }

    .budget-card.spent {
      background: linear-gradient(145deg, #FFEBEE, #ffd6e0);
      border: 2px solid var(--pink-accent);
    }

    .budget-card.remaining {
      background: linear-gradient(145deg, #E8F5E9, #C8E6C9);
      border: 2px solid var(--capybara-sage);
    }

    .budget-card-label {
      font-size: 0.8rem;
      color: var(--capybara-brown);
      font-weight: 600;
      margin-bottom: 0.25rem;
    }

    .budget-card-value {
      font-family: 'Quicksand', sans-serif;
      font-size: 1.5rem;
      font-weight: 700;
    }

    .budget-card.total .budget-card-value { color: var(--nursing-teal); }
    .budget-card.spent .budget-card-value { color: var(--pink-dark); }
    .budget-card.remaining .budget-card-value { color: var(--capybara-sage); }

    .budget-form {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
      align-items: flex-end;
      margin-bottom: 1.5rem;
    }

    .budget-form-group {
      display: flex;
      flex-direction: column;
      gap: 0.25rem;
    }

    .budget-form-group label {
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--capybara-brown);
    }

    .budget-form input, .budget-form select {
      padding: 0.5rem 0.75rem;
      border: 2px solid var(--nursing-light);
      border-radius: 12px;
      font-family: 'Nunito', sans-serif;
      font-size: 0.95rem;
    }

    .budget-form input:focus, .budget-form select:focus {
      outline: none;
      border-color: var(--nursing-teal);
    }

    .budget-expense-list {
      max-height: 300px;
      overflow-y: auto;
    }

    .budget-expense-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0.75rem 1rem;
      background: var(--pink-light);
      border-radius: 12px;
      margin-bottom: 0.5rem;
      border: 1px solid rgba(255, 133, 179, 0.3);
    }

    .budget-expense-item .expense-info {
      flex: 1;
    }

    .budget-expense-item .expense-desc {
      font-weight: 600;
      color: var(--text);
    }

    .budget-expense-item .expense-meta {
      font-size: 0.8rem;
      color: var(--capybara-brown);
    }

    .budget-expense-item .expense-amount {
      font-family: 'Quicksand', sans-serif;
      font-weight: 700;
      color: var(--pink-dark);
      margin-right: 0.75rem;
    }

    .budget-expense-item button.budget-delete {
      padding: 0.35rem 0.6rem;
      border: none;
      background: var(--nursing-red);
      color: white;
      border-radius: 8px;
      cursor: pointer;
      font-size: 0.85rem;
    }

    .budget-expense-item button.budget-delete:hover {
      opacity: 0.9;
    }

    .budget-empty {
      text-align: center;
      padding: 2rem;
      color: var(--capybara-brown);
      font-style: italic;
    }

    .receipt-modal-box {
      max-width: 360px;
    }

    .receipt-output {
      font-family: 'Courier New', monospace;
      font-size: 0.9rem;
      background: #fff;
      padding: 1.5rem;
      border: 2px dashed var(--capybara-brown);
      border-radius: 8px;
      text-align: center;
      line-height: 1.6;
      color: #333;
    }

    .receipt-output .receipt-title {
      font-size: 1.1rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      border-bottom: 1px solid #ccc;
      padding-bottom: 0.5rem;
    }

    .receipt-output .receipt-date {
      font-size: 0.8rem;
      color: #666;
      margin-bottom: 1rem;
    }

    .receipt-output .receipt-line {
      display: flex;
      justify-content: space-between;
      gap: 1rem;
      margin: 0.25rem 0;
    }

    .receipt-output .receipt-divider {
      border-top: 1px dashed #999;
      margin: 0.5rem 0;
    }

    .receipt-output .receipt-total {
      font-weight: 700;
      font-size: 1rem;
      margin-top: 0.5rem;
    }

    .receipt-actions {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 1rem;
    }

    @media print {
      .modal-overlay#receipt-modal { background: white; padding: 0; }
      .receipt-actions, .modal-box .btn { display: none !important; }
      .receipt-output { border: 1px solid #333; }
    }

    /* Mini Test */
    .minitest-section {
      background: linear-gradient(145deg, var(--white), var(--nursing-soft));
      border-radius: 24px;
      padding: 1.75rem 2rem;
      box-shadow: 0 8px 32px var(--shadow), 0 0 0 1px rgba(100, 181, 246, 0.3);
      border: 2px solid var(--nursing-blue);
    }
    .minitest-section h2 { font-family: 'Quicksand', sans-serif; font-size: 1.3rem; margin-bottom: 0.5rem; color: var(--nursing-blue); font-weight: 700; }
    .minitest-config h3 { font-size: 1rem; margin: 1rem 0 0.5rem; color: var(--capybara-brown); }
    .minitest-topics { display: flex; flex-wrap: wrap; gap: 1rem; margin-bottom: 0.5rem; }
    .minitest-topics label { font-weight: 600; cursor: pointer; }
    .minitest-types { display: flex; flex-direction: column; gap: 0.5rem; max-width: 320px; }
    .minitest-type-row { display: flex; justify-content: space-between; align-items: center; gap: 1rem; }
    .minitest-type-row input { width: 70px; padding: 0.4rem; border: 2px solid var(--nursing-light); border-radius: 8px; }
    .minitest-total { font-weight: 700; color: var(--nursing-teal); margin-top: 0.5rem; }
    .minitest-error { color: var(--nursing-red); font-size: 0.9rem; }
    .minitest-exam-wrap { margin-top: 1.5rem; }
    .minitest-progress { display: flex; justify-content: space-between; margin-bottom: 1rem; font-size: 0.95rem; }
    .minitest-nav { display: flex; gap: 0.75rem; margin-top: 1rem; flex-wrap: wrap; }
    .minitest-question { padding: 1rem; background: var(--pink-light); border-radius: 12px; margin-bottom: 1rem; border: 1px solid rgba(255,133,179,0.3); }
    .minitest-question .q-type { font-size: 0.75rem; font-weight: 700; color: var(--nursing-teal); margin-bottom: 0.25rem; }
    .minitest-question .q-text { font-weight: 600; margin-bottom: 0.75rem; }
    .minitest-sata-opt { display: flex; align-items: flex-start; gap: 0.5rem; margin: 0.5rem 0; cursor: pointer; }
    .minitest-sata-opt input { margin-top: 0.25rem; }
    .minitest-fib-input { width: 100%; max-width: 300px; padding: 0.5rem; border: 2px solid var(--nursing-light); border-radius: 8px; margin-top: 0.5rem; }
    .minitest-id-input { width: 100%; max-width: 400px; padding: 0.5rem; border: 2px solid var(--nursing-light); border-radius: 8px; margin-top: 0.5rem; }
    .minitest-results { margin-top: 1.5rem; padding: 1.5rem; background: linear-gradient(135deg, var(--pink-light), var(--nursing-soft)); border-radius: 16px; }
    .minitest-review { margin-top: 1.5rem; max-height: 400px; overflow-y: auto; padding-right: 0.5rem; }
    .minitest-review-item { padding: 0.75rem 1rem; margin-bottom: 0.75rem; border-radius: 12px; border-left: 4px solid; font-size: 0.9rem; }
    .minitest-review-item.correct { background: #E8F5E9; border-color: #4CAF50; }
    .minitest-review-item.wrong { background: #FFEBEE; border-color: #E57373; }
    .minitest-review-item .review-q { font-weight: 600; margin-bottom: 0.25rem; color: var(--capybara-brown); }
    .minitest-review-item .review-ans { font-size: 0.85rem; margin-top: 0.25rem; }
    .minitest-review-item .review-correct { color: #2E7D32; font-weight: 600; }
    .minitest-review-item .review-yours { color: #C62828; }

    .minigame-section > p {
      font-size: 0.9rem;
      color: var(--capybara-brown);
      margin-bottom: 1rem;
    }

    .minigame-board {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 0.6rem;
      max-width: 320px;
      margin: 0 auto 1rem;
    }

    .minigame-card {
      aspect-ratio: 1;
      background: linear-gradient(145deg, var(--nursing-light), var(--nursing-soft));
      border: 2px solid var(--nursing-blue);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      cursor: pointer;
      transition: transform 0.2s, box-shadow 0.2s;
      user-select: none;
    }

    .minigame-card:hover:not(.flipped):not(.matched) {
      transform: scale(1.03);
      box-shadow: 0 4px 12px rgba(100, 181, 246, 0.4);
    }

    .minigame-card.flipped,
    .minigame-card.matched {
      cursor: default;
      background: linear-gradient(145deg, #fff, var(--pink-light));
      border-color: var(--pink-accent);
    }

    .minigame-card.matched {
      opacity: 0.9;
      box-shadow: 0 0 0 2px var(--pink-accent);
    }

    .minigame-card .card-back {
      color: var(--nursing-blue);
      font-size: 1.5rem;
    }

    .minigame-stats {
      display: flex;
      justify-content: center;
      gap: 1.5rem;
      margin-bottom: 1rem;
      font-size: 0.95rem;
      font-weight: 600;
      color: var(--capybara-brown);
    }

    .minigame-actions {
      display: flex;
      justify-content: center;
      gap: 0.75rem;
    }

    .minigame-win {
      text-align: center;
      padding: 1rem;
      background: linear-gradient(135deg, var(--pink-light), var(--nursing-soft));
      border-radius: 16px;
      margin-top: 1rem;
      font-weight: 700;
      color: var(--pink-dark);
      display: none;
    }

    .minigame-win.visible {
      display: block;
      animation: minigame-celebration 0.5s ease-out;
    }

    @keyframes minigame-celebration {
      0% { transform: scale(0.9); opacity: 0; }
      50% { transform: scale(1.05); }
      100% { transform: scale(1); opacity: 1; }
    }

    .minigame-panel { display: none; }
    .minigame-panel.visible { display: block; }

    .game-selector {
      display: flex;
      justify-content: center;
      gap: 0.5rem;
      margin-bottom: 1.25rem;
      flex-wrap: wrap;
    }

    .game-btn {
      padding: 0.5rem 1rem;
      border-radius: 12px;
      border: 2px solid var(--nursing-blue);
      background: var(--nursing-soft);
      color: var(--nursing-blue);
      font-family: 'Quicksand', sans-serif;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .game-btn:hover {
      background: var(--nursing-light);
      transform: translateY(-1px);
    }

    .game-btn.active {
      background: linear-gradient(135deg, var(--nursing-blue), var(--nursing-teal));
      border-color: var(--capybara-brown);
      color: white;
    }

    /* Care Quiz */
    .quiz-topic-selector {
      padding: 1rem;
      background: var(--pink-light);
      border-radius: 12px;
      margin-bottom: 1rem;
      border: 2px solid var(--nursing-light);
    }
    .quiz-topic-prompt {
      margin: 0 0 0.75rem;
      font-weight: 600;
      color: var(--capybara-brown);
    }
    .quiz-topic-options {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem 1.5rem;
      margin-bottom: 1rem;
    }
    .quiz-topic-options label {
      display: flex;
      align-items: center;
      gap: 0.4rem;
      cursor: pointer;
      font-size: 0.95rem;
    }
    .quiz-topic-options input[type="checkbox"] {
      width: 18px;
      height: 18px;
      accent-color: var(--nursing-blue);
    }
    .quiz-topic-error {
      color: #C62828;
      font-size: 0.9rem;
      margin: 0 0 0.5rem;
    }
    .quiz-topic-error.hidden { display: none; }

    .quiz-subject {
      display: inline-block;
      font-size: 0.75rem;
      font-weight: 700;
      color: white;
      background: var(--nursing-blue);
      padding: 0.25rem 0.6rem;
      border-radius: 8px;
      margin-bottom: 0.6rem;
      letter-spacing: 0.05em;
    }

    .quiz-subject.med-surg { background: var(--nursing-teal); }
    .quiz-subject.psych { background: var(--pink-accent); }
    .quiz-subject.pharmacology { background: #9C27B0; }
    .quiz-subject.ethics { background: var(--capybara-brown); }
    .quiz-subject.procedures { background: var(--capybara-sage); }

    .quiz-question {
      font-size: 1.05rem;
      font-weight: 600;
      color: var(--capybara-brown);
      margin-bottom: 1rem;
      line-height: 1.4;
    }

    .quiz-options {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      max-width: 400px;
      margin: 0 auto 1rem;
    }

    .quiz-option {
      padding: 0.75rem 1rem;
      border-radius: 12px;
      border: 2px solid var(--nursing-light);
      background: var(--pink-light);
      cursor: pointer;
      transition: all 0.2s;
      text-align: left;
      font-size: 0.95rem;
    }

    .quiz-option:hover {
      border-color: var(--nursing-blue);
      background: var(--nursing-soft);
    }

    .quiz-option.correct {
      border-color: #4CAF50;
      background: #E8F5E9;
    }

    .quiz-option.wrong {
      border-color: #E57373;
      background: #FFEBEE;
    }

    .quiz-wrong-review {
      margin-top: 1.5rem;
      padding: 1rem;
      background: #FFF8E1;
      border-radius: 12px;
      border: 1px solid #FFE082;
    }
    .quiz-wrong-review h4 {
      margin: 0 0 1rem;
      font-size: 1rem;
      color: var(--capybara-brown);
    }
    .quiz-wrong-item {
      padding: 0.75rem;
      margin-bottom: 0.75rem;
      background: #fff;
      border-radius: 10px;
      border-left: 4px solid #E57373;
    }
    .quiz-wrong-item:last-child { margin-bottom: 0; }
    .quiz-wrong-item .wrong-q {
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: var(--capybara-brown);
    }
    .quiz-wrong-item .wrong-your {
      color: #C62828;
      font-weight: 500;
      margin-bottom: 0.25rem;
    }
    .quiz-wrong-item .wrong-correct {
      color: #2E7D32;
      font-weight: 600;
    }

    /* Hidden dev: live user count badge */
    #dev-presence-badge {
      display: none;
      position: fixed;
      bottom: 12px;
      right: 12px;
      padding: 6px 12px;
      background: rgba(0,0,0,0.75);
      color: #7fdbff;
      font-family: monospace;
      font-size: 12px;
      border-radius: 8px;
      z-index: 99999;
      pointer-events: none;
    }
    #dev-presence-badge.visible { display: block; }

    /* Word Scramble */
    .scramble-display {
      font-size: 2rem;
      letter-spacing: 0.3em;
      font-weight: 700;
      color: var(--capybara-brown);
      margin: 1rem 0;
      font-family: 'Quicksand', monospace;
      min-height: 2.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .scramble-buttons {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 0.5rem;
      margin: 1rem 0;
      min-height: 60px;
    }
    .scramble-btn {
      width: 44px;
      height: 44px;
      border-radius: 12px;
      border: 2px solid var(--nursing-blue);
      background: var(--nursing-soft);
      font-size: 1.2rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.15s;
    }
    .scramble-btn:hover {
      background: var(--nursing-light);
      transform: scale(1.05);
    }
    .scramble-chosen {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 0.5rem;
      min-height: 52px;
      margin: 1rem 0;
    }

    /* Capture preview */
    #capture-preview {
      display: none;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    #capture-preview.visible {
      display: block;
    }

    #video.hidden {
      display: none;
    }

    /* Love Letter Output - nursing care + pink */
    .love-letter-section {
      background: linear-gradient(145deg, #ffecf3, var(--nursing-soft));
      border-radius: 24px;
      padding: 1.75rem 2rem;
      box-shadow: 0 8px 32px var(--shadow), 0 0 0 1px rgba(100, 181, 246, 0.25);
      border: 2px solid var(--nursing-blue);
    }

    .love-letter-section h2 {
      font-family: 'Quicksand', sans-serif;
      font-size: 1.3rem;
      margin-bottom: 1rem;
      color: var(--nursing-blue);
      font-weight: 700;
    }

    .love-letter-section h2::before { content: 'üíå '; }

    /* Love letter card - paper/envelope styling */
    .love-letter-output {
      position: relative;
      max-width: 560px;
      margin: 0 auto;
      background:
        radial-gradient(ellipse at 20% 20%, rgba(255, 240, 245, 0.6) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 80%, rgba(255, 230, 240, 0.5) 0%, transparent 50%),
        linear-gradient(180deg, #fffcf7 0%, #fff8f5 20%, #fff5f9 50%, #fff0f5 100%);
      border-radius: 8px;
      padding: 2.5rem 2rem;
      box-shadow:
        0 1px 3px rgba(139, 115, 85, 0.06),
        0 8px 32px rgba(233, 30, 140, 0.1),
        0 0 0 1px rgba(255, 182, 193, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.95);
      border: 1px solid rgba(233, 30, 140, 0.15);
      min-height: 400px;
      overflow: visible;
      transition: box-shadow 0.4s ease, transform 0.3s ease;
      animation: love-letter-appear 0.6s ease-out;
    }

    @keyframes love-letter-appear {
      from { opacity: 0; transform: translateY(8px) scale(0.98); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }

    .love-letter-output:hover {
      box-shadow:
        0 2px 8px rgba(139, 115, 85, 0.08),
        0 16px 40px rgba(233, 30, 140, 0.14),
        0 0 0 1px rgba(255, 182, 193, 0.5),
        inset 0 1px 0 rgba(255, 255, 255, 1);
    }

    /* Decorative top edge - envelope flap feel */
    .love-letter-output::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 8px;
      background: linear-gradient(90deg,
        transparent 0%,
        rgba(255, 192, 217, 0.5) 15%,
        rgba(233, 30, 140, 0.2) 35%,
        rgba(156, 175, 136, 0.25) 50%,
        rgba(233, 30, 140, 0.2) 65%,
        rgba(255, 192, 217, 0.5) 85%,
        transparent 100%);
      pointer-events: none;
      border-radius: 8px 8px 0 0;
    }

    /* Corner accents */
    .love-letter-output .corner-flourish {
      position: absolute;
      font-size: 1.2rem;
      opacity: 0.35;
      pointer-events: none;
    }
    .love-letter-output .corner-flourish.tl { top: 20px; left: 20px; }
    .love-letter-output .corner-flourish.tr { top: 20px; right: 20px; transform: scaleX(-1); }
    .love-letter-output .corner-flourish.bl { bottom: 20px; left: 20px; transform: scaleY(-1); }
    .love-letter-output .corner-flourish.br { bottom: 20px; right: 20px; transform: scale(-1); }

    .love-letter-content {
      position: relative;
      z-index: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 1.25rem;
      margin-top: 0.25rem;
    }

    .love-letter-title {
      font-family: 'Dancing Script', cursive;
      font-size: 1.6rem;
      font-weight: 600;
      color: var(--capybara-brown);
      margin: 0;
      letter-spacing: 0.04em;
    }

    .love-letter-title::after {
      content: '';
      display: block;
      width: 60px;
      height: 2px;
      margin: 0.5rem auto 0;
      background: linear-gradient(90deg, transparent, rgba(156, 175, 136, 0.5), transparent);
    }

    .love-letter-photos {
      display: flex;
      flex-wrap: wrap;
      gap: 0.6rem;
      justify-content: center;
      align-items: center;
      width: 100%;
    }

    .love-letter-photos.layout-1 { justify-content: center; }
    .love-letter-photos.layout-1 .love-letter-photo-frame { flex: 0 0 auto; max-width: 180px; }

    .love-letter-photos.layout-2 .love-letter-photo-frame { flex: 1 1 calc(50% - 0.5rem); min-width: 100px; max-width: 140px; }

    .love-letter-photos.layout-3 {
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-template-rows: auto auto;
    }
    .love-letter-photos.layout-3 .love-letter-photo-frame:nth-child(1) {
      grid-column: 1 / -1;
      justify-self: center;
      max-width: 180px;
    }
    .love-letter-photos.layout-3 .love-letter-photo-frame:nth-child(2),
    .love-letter-photos.layout-3 .love-letter-photo-frame:nth-child(3) {
      justify-self: center;
      max-width: 120px;
    }

    .love-letter-photo-frame {
      flex: 1 1 calc(50% - 0.5rem);
      min-width: 100px;
      max-width: 140px;
      background: #fff;
      padding: 6px 6px 20px;
      border-radius: 2px;
      box-shadow:
        0 2px 4px rgba(139, 115, 85, 0.1),
        0 6px 20px rgba(139, 115, 85, 0.15);
      transition: transform 0.25s ease, box-shadow 0.25s ease;
    }

    .love-letter-photo-frame:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(139, 115, 85, 0.12), 0 12px 28px rgba(139, 115, 85, 0.18);
    }

    .love-letter-photo {
      width: 100%;
      aspect-ratio: 4/3;
      object-fit: cover;
      display: block;
      border-radius: 1px;
    }

    .love-letter-photos-wrap {
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.5rem;
    }

    .love-letter-photo-placeholder {
      width: 100%;
      max-width: 280px;
      padding: 2rem;
      background: linear-gradient(145deg, rgba(255, 245, 250, 0.8), rgba(232, 245, 233, 0.6));
      border-radius: 12px;
      border: 2px dashed rgba(156, 175, 136, 0.4);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--capybara-brown);
      font-style: italic;
      font-size: 0.9rem;
      text-align: center;
      opacity: 0.95;
    }

    /* Message area - handwritten letter feel */
    .love-letter-message {
      font-family: 'Nunito', sans-serif;
      font-size: 1.05rem;
      line-height: 1.8;
      color: #5c3a4a;
      white-space: pre-wrap;
      word-break: break-word;
      text-align: center;
      padding: 1rem 1.25rem 0.75rem;
      min-height: 3.5em;
      max-width: 420px;
      margin: 0 auto;
      border-radius: 8px;
      background: linear-gradient(to bottom, transparent, rgba(255, 240, 247, 0.4));
    }

    .love-letter-message.empty {
      color: #b8a4ad;
      font-style: italic;
    }

    .love-letter-date {
      font-family: 'Dancing Script', cursive;
      font-size: 1rem;
      color: var(--capybara-warm);
      margin-top: 0.5rem;
      opacity: 0.9;
    }

    /* Flower picker for love letter decoration */
    .flower-picker {
      margin-bottom: 1rem;
      padding: 1rem;
      background: linear-gradient(145deg, #fff9fc, rgba(255, 192, 217, 0.15));
      border-radius: 16px;
      border: 1px solid rgba(233, 30, 140, 0.15);
    }

    .flower-picker-label {
      font-size: 0.9rem;
      color: var(--capybara-brown);
      font-weight: 600;
      margin-bottom: 0.6rem;
      display: block;
    }

    .flower-picker-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      justify-content: center;
    }

    .flower-picker-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 64px;
      padding: 6px 4px 4px;
      border-radius: 12px;
      border: 2px solid rgba(156, 175, 136, 0.4);
      background: white;
      cursor: pointer;
      transition: all 0.2s ease;
      overflow: hidden;
    }

    .flower-picker-btn img {
      width: 44px;
      height: 44px;
      object-fit: cover;
      border-radius: 6px;
    }

    .flower-picker-btn .flower-name {
      font-size: 0.65rem;
      font-weight: 600;
      color: var(--capybara-brown);
      margin-top: 3px;
      text-align: center;
      line-height: 1.2;
    }

    .flower-picker-btn:hover {
      border-color: var(--nursing-blue);
      transform: scale(1.05);
      box-shadow: 0 4px 12px rgba(100, 181, 246, 0.25);
    }

    .love-letter-flowers {
      position: absolute;
      inset: 0;
      z-index: 2;
      overflow: visible;
      pointer-events: none;
    }

    .love-letter-flowers .flower-wrapper {
      pointer-events: auto;
      position: absolute;
      width: 48px;
      height: 48px;
      pointer-events: auto;
      cursor: grab;
      transform: translate(-50%, -50%);
      z-index: 1;
    }

    .love-letter-flowers .flower-wrapper:active {
      cursor: grabbing;
    }

    .love-letter-flowers .flower-wrapper img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      opacity: 0.9;
      pointer-events: none;
      user-select: none;
    }

    .love-letter-flowers .flower-remove {
      position: absolute;
      top: -6px;
      right: -6px;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      background: rgba(233, 30, 140, 0.9);
      color: white;
      border: none;
      cursor: pointer;
      font-size: 12px;
      line-height: 1;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.2s;
      pointer-events: auto;
    }

    .love-letter-flowers .flower-wrapper:hover .flower-remove {
      opacity: 1;
    }

    .love-letter-actions {
      margin-top: 1.5rem;
      display: flex;
      gap: 0.75rem;
      justify-content: center;
      flex-wrap: wrap;
    }

    .love-letter-actions .btn {
      box-shadow: 0 2px 8px rgba(233, 30, 140, 0.2);
    }

    .love-letter-actions .btn:hover:not(:disabled) {
      box-shadow: 0 4px 12px rgba(233, 30, 140, 0.3);
    }


    .gallery-item.selected {
      border-color: var(--pink-dark);
      box-shadow: 0 0 0 3px rgba(233, 30, 140, 0.3);
    }

    .gallery-item .delete-btn {
      position: absolute;
      top: 4px;
      right: 4px;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      background: rgba(233, 30, 140, 0.9);
      color: white;
      border: none;
      cursor: pointer;
      font-size: 0.9rem;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.2s, transform 0.2s;
      z-index: 2;
    }

    .gallery-item:hover .delete-btn {
      opacity: 1;
    }

    .gallery-item .delete-btn:hover {
      transform: scale(1.1);
      background: #c2185b;
    }

    .confetti-container {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 9999;
      overflow: hidden;
    }

    .confetti-piece {
      position: absolute;
      animation: confetti-fall 1.5s ease-out forwards;
    }

    @keyframes confetti-fall {
      0% {
        transform: translateY(0) rotate(0deg);
        opacity: 1;
      }
      100% {
        transform: translateY(100vh) rotate(720deg);
        opacity: 0;
      }
    }

    /* Mode selector - Photo Booth / Mini Games */
    .mode-selector {
      display: flex;
      justify-content: center;
      gap: 0.5rem;
      margin-bottom: 1.5rem;
      flex-wrap: wrap;
    }

    .mode-btn {
      padding: 0.6rem 1.5rem;
      border-radius: 16px;
      border: 2px solid var(--pink-mid);
      background: var(--pink-light);
      color: var(--pink-dark);
      font-family: 'Quicksand', sans-serif;
      font-size: 0.95rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.2s;
    }

    .mode-btn:hover {
      background: var(--pink-mid);
      color: white;
      transform: translateY(-1px);
    }

    .mode-btn.active {
      background: linear-gradient(135deg, var(--pink-accent), var(--nursing-teal));
      border-color: var(--capybara-brown);
      color: white;
      box-shadow: 0 4px 15px rgba(233, 30, 140, 0.3);
    }

    .mode-content {
      display: none;
      flex-direction: column;
      gap: 2rem;
    }

    .mode-content.visible {
      display: flex;
    }

    /* About button */
    .about-btn-wrap {
      text-align: center;
      margin-bottom: 1.5rem;
    }

    .about-btn {
      padding: 0.4rem 1rem;
      border-radius: 12px;
      border: 1px solid var(--capybara-sage);
      background: transparent;
      color: var(--capybara-brown);
      font-family: 'Nunito', sans-serif;
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }

    .about-btn:hover {
      background: rgba(156, 175, 136, 0.2);
      border-color: var(--capybara-brown);
    }

    /* Modal overlay */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      padding: 1rem;
    }

    .modal-overlay.hidden {
      display: none;
    }

    .modal-box {
      background: linear-gradient(145deg, var(--white), var(--nursing-soft));
      border-radius: 20px;
      padding: 1.75rem;
      max-width: 400px;
      width: 100%;
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.2);
      border: 2px solid var(--nursing-blue);
    }

    .modal-box h3 {
      font-family: 'Quicksand', sans-serif;
      color: var(--nursing-blue);
      margin-bottom: 1rem;
      font-size: 1.2rem;
    }

    .modal-box input[type="password"] {
      width: 100%;
      padding: 0.75rem 1rem;
      border: 2px solid var(--nursing-light);
      border-radius: 12px;
      font-size: 1rem;
      margin-bottom: 1rem;
    }

    .modal-box input:focus {
      outline: none;
      border-color: var(--nursing-blue);
    }

    .modal-box .modal-error {
      color: var(--nursing-red);
      font-size: 0.9rem;
      margin-bottom: 0.75rem;
    }

    .modal-box .modal-actions {
      display: flex;
      gap: 0.5rem;
      justify-content: flex-end;
    }

    .modal-box .about-content {
      font-size: 0.95rem;
      line-height: 1.6;
      color: var(--text);
    }

    .hidden { display: none !important; }

  </style>
</head>
<body>
  <div class="header-with-capybara">
    <img src="capybara/cute-capibara-character-different-poses.png" alt="" class="header-capybara left" aria-hidden="true">
    <h1>Bea's Academic Sanctuary</h1>
    <img src="capybara/cute-capibara-character-different-poses.png" alt="" class="header-capybara" aria-hidden="true">
  </div>
  <p class="tagline">Care <span>‚ô•</span> Chill <span>‚ô•</span> Capture</p>

  <div class="mode-selector">
    <button type="button" class="mode-btn active" data-mode="photobooth">üì∑ Photo Booth</button>
    <button type="button" class="mode-btn" data-mode="minigames">ü©∫ Mini Games</button>
    <button type="button" class="mode-btn" data-mode="minitest">üìù Mini Test</button>
    <button type="button" class="mode-btn" data-mode="budget">üí∞ Budget Tracker</button>
    
  </div>

  <div class="about-btn-wrap">
    <button type="button" class="about-btn" id="about-btn">‚ÑπÔ∏è About</button>
  </div>

  <!-- Password modal -->
  <div class="modal-overlay hidden" id="password-modal">
    <div class="modal-box">
      <h3>üîê Enter password to view</h3>
      <p class="modal-error hidden" id="password-error">Incorrect password. Please try again.</p>
      <input type="password" id="password-input" placeholder="Password" autocomplete="off">
      <div class="modal-actions">
        <button type="button" class="btn btn-outline" id="password-cancel">Cancel</button>
        <button type="button" class="btn btn-primary" id="password-submit">Unlock</button>
      </div>
    </div>
  </div>

  <!-- About content modal -->
  <div class="modal-overlay hidden" id="about-modal">
    <div class="modal-box">
      <h3>üíå To My Dearest Bea</h3>
      <div class="about-content">
        <p>I want you to know how much you mean to me. Every day with you adds something good to my life. Your presence gives me peace and strength. Your smile lifts my mood even on difficult days.</p>
        <p>I will keep choosing you. I will keep supporting you in your goals and standing beside you in hard moments. I value what we have and I will take care of it.</p>
        <p style="margin-top: 0.75rem;">You are important to me. Always and Forever. I Love You </p>
        <p style="margin-top: 0.75rem;">-Dean Andrei <3 </p>
      </div>
      <div class="modal-actions" style="margin-top: 1rem;">
        <button type="button" class="btn btn-primary" id="about-close">Close</button>
      </div>
    </div>
  </div>

  <div class="container">
    <!-- Photo Booth mode content -->
    <div id="photobooth-content" class="mode-content visible">
    <!-- 1. Message Card -->
    <section class="message-card">
      <h2>Message Card</h2>
      <textarea id="message" placeholder="Write a note, caption, or message here..."></textarea>
    </section>

    <!-- 2. Photo Booth -->
    <section class="photo-booth">
      <h2>Photo Booth</h2>
      <div class="camera-container">
        <video id="video" autoplay playsinline></video>
        <canvas id="canvas" style="display:none"></canvas>
        <img id="capture-preview" alt="Capture preview">
        <canvas id="filter-overlay" class="filter-overlay-canvas"></canvas>
        <div class="countdown-overlay" id="countdown-overlay">
          <span class="countdown-number" id="countdown-number"></span>
        </div>
        <div class="grid-overlay" id="grid-overlay" aria-hidden="true"></div>
        <div class="flash-overlay" id="flash-overlay" aria-hidden="true"></div>
        <div id="confetti-container" class="confetti-container" style="display:none"></div>
        <div class="camera-placeholder" id="placeholder">
          <img src="capybara/cute-capibara-character-different-poses.png" alt="" class="placeholder-capybara" aria-hidden="true">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"/>
            <circle cx="12" cy="13" r="4"/>
          </svg>
          <span>Click "Start Camera" to begin</span>
        </div>
      </div>
      <div class="controls">
        <button class="btn btn-primary" id="start-btn">Start Camera</button>
        <button class="btn btn-outline" id="flip-camera-btn" disabled title="Switch camera">üîÑ Flip</button>
        <button class="btn btn-secondary" id="capture-btn" disabled>Capture</button>
        <button class="btn btn-outline" id="retake-btn" disabled>Retake</button>
        <div class="filter-options">
          <span>Filters:</span>
          <button class="filter-btn active" data-filter="none" title="No filter">‚úï</button>
          <button class="filter-btn" data-filter="hearts" title="Hearts">‚ô•</button>
          <button class="filter-btn" data-filter="crown" title="Crown">‚ôî</button>
          <button class="filter-btn" data-filter="stars" title="Stars">‚ú¶</button>
          <button class="filter-btn" data-filter="flower" title="Flower">üå∏</button>
        </div>
        <div class="effect-options">
          <span>Style:</span>
          <button class="effect-btn active" data-effect="none" title="Normal">‚óØ</button>
          <button class="effect-btn" data-effect="sepia" title="Sepia">üü§</button>
          <button class="effect-btn" data-effect="vintage" title="Vintage">üì∑</button>
          <button class="effect-btn" data-effect="bw" title="Black &amp; White">‚¨õ</button>
        </div>
        <div class="timer-options">
          <span>Timer:</span>
          <button class="timer-btn active" data-timer="0">Off</button>
          <button class="timer-btn" data-timer="3">3 sec</button>
          <button class="timer-btn" data-timer="5">5 sec</button>
        </div>
        <label class="toggle-option" title="Composition grid">
          <input type="checkbox" id="grid-toggle"> Grid
        </label>
        <label class="toggle-option" title="Flash effect on capture">
          <input type="checkbox" id="flash-toggle" checked> Flash
        </label>
      </div>
    </section>

    <!-- 3. Gallery & 4. Download -->
    <section class="gallery">
      <h2>Your Photos</h2>
      <p style="font-size: 0.85rem; color: var(--capybara-brown); margin-bottom: 0.5rem;">Click photos to add or remove (max 3)</p>
      <div class="gallery-grid" id="gallery"></div>
      <div class="gallery-empty" id="gallery-empty">No photos yet. Capture some memories!</div>
    </section>

    <!-- 5. Love Letter Output -->
    <section class="love-letter-section">
      <h2>üíå Your Love Letter</h2>

      <div class="flower-picker">
        <span class="flower-picker-label">üå∏ Add flowers (click to add, drag to move)</span>
        <div class="flower-picker-grid" id="flower-picker-grid"></div>
      </div>

      <div class="love-letter-output" id="love-letter-card">
        <span class="corner-flourish tl" aria-hidden="true">‚úø</span>
        <span class="corner-flourish tr" aria-hidden="true">‚úø</span>
        <span class="corner-flourish bl" aria-hidden="true">‚úø</span>
        <span class="corner-flourish br" aria-hidden="true">‚úø</span>
        <div class="love-letter-flowers" id="love-letter-flowers"></div>
        <div class="love-letter-content">
          <p class="love-letter-title">With Love ‚úø Care ‚Ä¢ Chill</p>
          <div class="love-letter-photos-wrap">
            <div id="love-letter-photos" class="love-letter-photos"></div>
            <div id="love-letter-photo-placeholder" class="love-letter-photo-placeholder">Click photos to add them to your love letter (1‚Äì3 pics)</div>
          </div>
          <p id="love-letter-message" class="love-letter-message empty">Write your message above...</p>
          <p class="love-letter-date" id="love-letter-date"></p>
        </div>
      </div>
      <div class="love-letter-actions">
        <button class="btn btn-primary" id="download-love-letter-btn" disabled>Download Love Letter</button>
        <button class="btn btn-outline" id="share-love-letter-btn" disabled title="Share on mobile">Share</button>
      </div>
    </section>

    </div>
    <!-- End Photo Booth content -->

    <!-- Mini Games mode content -->
    <div id="minigame-content" class="mode-content">
    <section class="minigame-section">
      <h2>Mini Games</h2>
      <div class="game-selector">
        <button type="button" class="game-btn active" data-game="match">üÉè Care Match</button>
        <button type="button" class="game-btn" data-game="quiz">‚ùì Care Quiz</button>
        <button type="button" class="game-btn" data-game="scramble">üî§ Word Scramble</button>
      </div>

      <!-- Care Match -->
      <div id="game-match" class="minigame-panel visible">
        <p>Flip the cards to find matching nursing care items!</p>
        <div class="minigame-stats">
          <span>Moves: <strong id="minigame-moves">0</strong></span>
          <span>Matches: <strong id="minigame-matches">0</strong>/8</span>
        </div>
        <div class="minigame-board" id="minigame-board"></div>
        <div class="minigame-actions">
          <button class="btn btn-secondary" id="minigame-reset">New Game</button>
        </div>
        <div class="minigame-win" id="minigame-win">üéâ Great care! You matched them all!</div>
      </div>

      <!-- Care Quiz -->
      <div id="game-quiz" class="minigame-panel">
        <p>Test your nursing knowledge with quick care questions!</p>
        <div id="quiz-topic-selector" class="quiz-topic-selector">
          <p class="quiz-topic-prompt">Select topics to quiz (choose 1 or more):</p>
          <div class="quiz-topic-options">
            <label><input type="checkbox" name="quiz-topic" value="Fundamentals"> Fundamentals</label>
            <label><input type="checkbox" name="quiz-topic" value="Med-Surg"> Med-Surg</label>
            <label><input type="checkbox" name="quiz-topic" value="Psych"> Psych</label>
            <label><input type="checkbox" name="quiz-topic" value="Pharmacology"> Pharmacology</label>
          </div>
          <p id="quiz-topic-error" class="quiz-topic-error hidden">Please select at least 1 topic.</p>
          <button type="button" class="btn btn-primary" id="quiz-start">Start Quiz</button>
        </div>
        <div class="minigame-stats" id="quiz-stats" style="display:none;">
          <span>Score: <strong id="quiz-score">0</strong>/20</span>
          <span>Question: <strong id="quiz-current">1</strong>/20</span>
        </div>
        <div id="quiz-area"></div>
        <div class="minigame-actions" id="quiz-actions" style="display:none;">
          <button class="btn btn-secondary" id="quiz-reset">New Quiz</button>
          <button class="btn btn-primary" id="quiz-share" style="display:none;">üì§ Share Score</button>
        </div>
        <div class="minigame-win" id="quiz-win"></div>
        <div class="quiz-wrong-review" id="quiz-wrong-review"></div>
      </div>

      <!-- Word Scramble -->
      <div id="game-scramble" class="minigame-panel">
        <p>Unscramble the nursing & care word! Tap letters in order.</p>
        <div class="minigame-stats">
          <span>Words: <strong id="scramble-score">0</strong></span>
        </div>
        <p id="scramble-hint">Tap a letter to start</p>
        <div class="scramble-display" id="scramble-display">_</div>
        <div class="scramble-chosen" id="scramble-chosen"></div>
        <div class="scramble-buttons" id="scramble-buttons"></div>
        <div class="minigame-actions">
          <button type="button" class="btn btn-secondary" id="scramble-skip">Skip</button>
          <button type="button" class="btn btn-secondary" id="scramble-reset">New Word</button>
        </div>
        <div class="minigame-win" id="scramble-win">‚úì Correct!</div>
      </div>

    </section>
    </div>
    <!-- End Mini Games content -->

    <!-- Budget Tracker mode content -->
    <div id="budget-content" class="mode-content">
      <section class="budget-section">
        <h2>Budget Tracker</h2>
        <p style="font-size: 0.9rem; color: var(--capybara-brown); margin-bottom: 1rem;">Set your allowance and track expenses. Remaining = Allowance ‚àí Deductions.</p>

        <div class="budget-overview">
          <div class="budget-card total">
            <div class="budget-card-label">Allowance</div>
            <div class="budget-card-value" id="budget-total">‚Ç±0</div>
          </div>
          <div class="budget-card spent">
            <div class="budget-card-label">Deductions</div>
            <div class="budget-card-value" id="budget-spent">‚Ç±0</div>
          </div>
          <div class="budget-card remaining">
            <div class="budget-card-label">Remaining</div>
            <div class="budget-card-value" id="budget-remaining">‚Ç±0</div>
          </div>
        </div>

        <div class="budget-form">
          <div class="budget-form-group">
            <label for="budget-amount">Set Allowance (‚Ç±)</label>
            <input type="number" id="budget-amount" placeholder="e.g. 4500" min="0" step="100">
          </div>
          <button type="button" class="btn btn-primary" id="budget-set-btn">Set Allowance</button>
        </div>

        <div class="budget-form">
          <div class="budget-form-group">
            <label for="new-allowance">New Allowance (‚Ç±) + Remaining</label>
            <input type="number" id="new-allowance" placeholder="e.g. 4500 (base for next period)" min="0" step="100">
          </div>
          <button type="button" class="btn btn-secondary" id="carryover-btn" title="Add remaining to new allowance, clear deductions">Add Remaining to Next Allowance</button>
        </div>

        <h3 style="font-size: 1rem; margin-bottom: 0.5rem; color: var(--capybara-brown);">Add Deduction</h3>
        <div class="budget-form">
          <div class="budget-form-group">
            <label for="expense-desc">Description</label>
            <input type="text" id="expense-desc" placeholder="e.g. Groceries">
          </div>
          <div class="budget-form-group">
            <label for="expense-amount">Amount (‚Ç±)</label>
            <input type="number" id="expense-amount" placeholder="0" min="0" step="0.01">
          </div>
          <button type="button" class="btn btn-primary" id="expense-add-btn">Add Deduction</button>
        </div>

        <h3 style="font-size: 1rem; margin: 1rem 0 0.5rem; color: var(--capybara-brown);">Deduction History</h3>
        <div class="budget-expense-list" id="budget-expense-list">
          <div class="budget-empty" id="budget-empty">No deductions yet. Add your first deduction above!</div>
        </div>

        <div class="budget-receipt-actions" style="margin-top: 1.5rem;">
          <button type="button" class="btn btn-primary" id="receipt-btn">üßæ Generate Receipt</button>
        </div>
      </section>
    </div>
    <!-- End Budget Tracker content -->

    <!-- Mini Test mode content -->
    <div id="minitest-content" class="mode-content">
      <section class="minitest-section">
        <h2>üìù Mini Test (50-Item Exam)</h2>
        <p style="font-size: 0.9rem; color: var(--capybara-brown); margin-bottom: 1rem;">Create a custom 50-item nursing exam. Select topics and question types.</p>

        <div id="minitest-config" class="minitest-config">
          <h3>Topics (select 1 or more)</h3>
          <div class="minitest-topics">
            <label><input type="checkbox" name="minitest-topic" value="Fundamentals"> Fundamentals</label>
            <label><input type="checkbox" name="minitest-topic" value="Med-Surg"> Med-Surg</label>
            <label><input type="checkbox" name="minitest-topic" value="Psych"> Psych</label>
            <label><input type="checkbox" name="minitest-topic" value="Pharmacology"> Pharmacology</label>
          </div>

          <h3>Question Types (total must equal 50)</h3>
          <div class="minitest-types">
            <div class="minitest-type-row">
              <label>Multiple Choice</label>
              <input type="number" id="mt-mc" min="0" max="50" value="20" placeholder="0">
            </div>
            <div class="minitest-type-row">
              <label>Identification</label>
              <input type="number" id="mt-id" min="0" max="50" value="10" placeholder="0">
            </div>
            <div class="minitest-type-row">
              <label>True or False</label>
              <input type="number" id="mt-tf" min="0" max="50" value="10" placeholder="0">
            </div>
            <div class="minitest-type-row">
              <label>Fill in the Blanks</label>
              <input type="number" id="mt-fib" min="0" max="50" value="10" placeholder="0">
            </div>
            <div class="minitest-type-row">
              <label>SATA (Select All That Apply)</label>
              <input type="number" id="mt-sata" min="0" max="50" value="0" placeholder="0">
            </div>
          </div>
          <p class="minitest-total" id="minitest-total">Total: 50 items</p>
          <p class="minitest-error hidden" id="minitest-error">Total must equal 50. Please adjust the counts.</p>

          <button type="button" class="btn btn-primary" id="minitest-start">Start Exam</button>
        </div>

        <div id="minitest-exam-wrap" class="minitest-exam-wrap hidden">
          <div class="minitest-progress">
            <span>Question <strong id="mt-current">1</strong> of <strong id="mt-total">50</strong></span>
            <span>Score: <strong id="mt-score">0</strong>/<strong id="mt-answered">0</strong></span>
          </div>
          <div id="minitest-question-area"></div>
          <div class="minitest-nav">
            <button type="button" class="btn btn-outline" id="mt-prev">‚Üê Previous</button>
            <button type="button" class="btn btn-primary" id="mt-next">Next ‚Üí</button>
            <button type="button" class="btn btn-secondary" id="mt-submit" style="display:none;">Submit Exam</button>
          </div>
        </div>

        <div id="minitest-results" class="minitest-results hidden"></div>
      </section>
    </div>
    <!-- End Mini Test content -->
  </div>

  <!-- Receipt modal -->
  <div class="modal-overlay hidden" id="receipt-modal">
    <div class="modal-box receipt-modal-box">
      <div id="receipt-output" class="receipt-output"></div>
      <div class="receipt-actions">
        <button type="button" class="btn btn-outline" id="receipt-print">Print</button>
        <button type="button" class="btn btn-primary" id="receipt-download">Download Image</button>
        <button type="button" class="btn btn-outline" id="receipt-close">Close</button>
      </div>
    </div>
  </div>

  <div id="dev-presence-badge">üë• Online: --</div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="flower_embed.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.min.js"></script>

  <script>
    const video = document.getElementById('video');
    const canvas = document.getElementById('canvas');
    const capturePreview = document.getElementById('capture-preview');
    const placeholder = document.getElementById('placeholder');
    const startBtn = document.getElementById('start-btn');
    const captureBtn = document.getElementById('capture-btn');
    const retakeBtn = document.getElementById('retake-btn');
    const gallery = document.getElementById('gallery');
    const galleryEmpty = document.getElementById('gallery-empty');
    const messageInput = document.getElementById('message');
    const loveLetterPhotos = document.getElementById('love-letter-photos');
    const loveLetterPhotoPlaceholder = document.getElementById('love-letter-photo-placeholder');
    const loveLetterMessage = document.getElementById('love-letter-message');
    const downloadLoveLetterBtn = document.getElementById('download-love-letter-btn');
    const shareLoveLetterBtn = document.getElementById('share-love-letter-btn');
    const loveLetterCard = document.getElementById('love-letter-card');
    const confettiContainer = document.getElementById('confetti-container');

    const ABOUT_PASSWORD = 'Bea0921';
    const passwordModal = document.getElementById('password-modal');
    const aboutModal = document.getElementById('about-modal');
    const passwordInput = document.getElementById('password-input');
    const passwordError = document.getElementById('password-error');

    document.getElementById('about-btn').addEventListener('click', () => {
      passwordError.classList.add('hidden');
      passwordInput.value = '';
      passwordModal.classList.remove('hidden');
      passwordInput.focus();
    });

    document.getElementById('password-cancel').addEventListener('click', () => {
      passwordModal.classList.add('hidden');
    });

    document.getElementById('password-submit').addEventListener('click', () => {
      if (passwordInput.value === ABOUT_PASSWORD) {
        passwordModal.classList.add('hidden');
        aboutModal.classList.remove('hidden');
      } else {
        passwordError.classList.remove('hidden');
      }
    });

    passwordInput.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') document.getElementById('password-submit').click();
    });

    document.getElementById('about-close').addEventListener('click', () => {
      aboutModal.classList.add('hidden');
    });

    [passwordModal, aboutModal].forEach(modal => {
      modal.addEventListener('click', (e) => {
        if (e.target === modal) modal.classList.add('hidden');
      });
    });

    let stream = null;
    let capturedPhotos = [];
    let selectedPhotoIndices = [];
    let flowerDecorations = []; // { path, x, y } - x,y as 0-100 percentages

    const FLOWER_OPTIONS = [
      { path: 'flowers/anemone.webp', name: 'Anemone' },
      { path: 'flowers/carnation.webp', name: 'Carnation' },
      { path: 'flowers/lily.webp', name: 'Lily' },
      { path: 'flowers/orchid.webp', name: 'Orchid' },
      { path: 'flowers/rose.webp', name: 'Rose' }
    ];
    let timerSeconds = 0;
    let countdownInterval = null;
    let currentFilter = 'none';
    let currentEffect = 'none';
    let currentFacingMode = 'user';
    let filterAnimationId = null;
    let faceLandmarker = null;
    let lastFacePosition = null;
    let lastVideoTime = -1;
    const filterOverlay = document.getElementById('filter-overlay');
    const cameraContainer = document.querySelector('.camera-container');
    const flipCameraBtn = document.getElementById('flip-camera-btn');
    const gridOverlay = document.getElementById('grid-overlay');
    const gridToggle = document.getElementById('grid-toggle');
    const flashOverlay = document.getElementById('flash-overlay');
    const flashToggle = document.getElementById('flash-toggle');

    const STORAGE_KEY = 'bea-photobooth-draft';

    // Mode selector: Photo Booth / Mini Games / Budget Tracker (only one visible at a time)
    const photoboothContent = document.getElementById('photobooth-content');
    const minigameContent = document.getElementById('minigame-content');
    const budgetContent = document.getElementById('budget-content');
    const minitestContent = document.getElementById('minitest-content');
    document.querySelectorAll('.mode-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        const mode = btn.dataset.mode;
        photoboothContent.classList.toggle('visible', mode === 'photobooth');
        minigameContent.classList.toggle('visible', mode === 'minigames');
        budgetContent.classList.toggle('visible', mode === 'budget');
        if (minitestContent) minitestContent.classList.toggle('visible', mode === 'minitest');
      });
    });

    // Budget Tracker (simple: allowance ‚àí deductions = remaining)
    const BUDGET_STORAGE_KEY = 'bea-budget-tracker';
    let budgetData = {
      allowance: 4500, // default ‚Ç±300/day √ó 15 days
      expenses: [] // { id, desc, amount, category }
    };
    try {
      const saved = localStorage.getItem(BUDGET_STORAGE_KEY);
      if (saved) {
        const parsed = JSON.parse(saved);
        budgetData.allowance = parsed.allowance ?? parsed.monthlyBudget ?? 4500;
        budgetData.expenses = (parsed.expenses || []).filter(e => e && e.id);
      }
    } catch (e) {}

    function saveBudget() {
      try { localStorage.setItem(BUDGET_STORAGE_KEY, JSON.stringify(budgetData)); } catch (e) {}
      updateBudgetUI();
    }

    function updateBudgetUI() {
      const allowance = budgetData.allowance || 0;
      const spent = budgetData.expenses.reduce((s, e) => s + (parseFloat(e.amount) || 0), 0);
      const remaining = allowance - spent;

      const totalEl = document.getElementById('budget-total');
      const spentEl = document.getElementById('budget-spent');
      const remainingEl = document.getElementById('budget-remaining');
      const listEl = document.getElementById('budget-expense-list');
      const emptyEl = document.getElementById('budget-empty');
      if (!totalEl || !spentEl || !remainingEl) return;

      totalEl.textContent = '‚Ç±' + allowance.toLocaleString('en-PH', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
      spentEl.textContent = '‚Ç±' + spent.toLocaleString('en-PH', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
      remainingEl.textContent = '‚Ç±' + remaining.toLocaleString('en-PH', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
      remainingEl.style.color = remaining < 0 ? 'var(--nursing-red)' : '';

      const expenseItems = budgetData.expenses.slice().reverse();
      if (emptyEl) emptyEl.style.display = expenseItems.length ? 'none' : 'block';
      if (listEl) {
        listEl.querySelectorAll('.budget-expense-item').forEach(el => el.remove());
        expenseItems.forEach(exp => {
          const div = document.createElement('div');
          div.className = 'budget-expense-item';
          div.innerHTML = `
            <div class="expense-info">
              <div class="expense-desc">${(exp.desc || 'Expense').replace(/</g, '&lt;')}</div>
            </div>
            <span class="expense-amount">‚Ç±${(parseFloat(exp.amount) || 0).toLocaleString('en-PH', { minimumFractionDigits: 2 })}</span>
            <button type="button" class="budget-delete" data-id="${exp.id}" title="Delete">√ó</button>
          `;
          div.querySelector('.budget-delete').addEventListener('click', () => {
            budgetData.expenses = budgetData.expenses.filter(e => e.id !== exp.id);
            saveBudget();
          });
          listEl.appendChild(div);
        });
      }
    }

    document.getElementById('budget-set-btn')?.addEventListener('click', () => {
      const inp = document.getElementById('budget-amount');
      const val = parseFloat(inp?.value);
      if (!isNaN(val) && val >= 0) {
        budgetData.allowance = val;
        saveBudget();
        if (inp) inp.value = '';
      }
    });

    document.getElementById('carryover-btn')?.addEventListener('click', () => {
      const newInp = document.getElementById('new-allowance');
      const newVal = parseFloat(newInp?.value);
      if (isNaN(newVal) || newVal < 0) return;
      const spent = budgetData.expenses.reduce((s, e) => s + (parseFloat(e.amount) || 0), 0);
      const remaining = (budgetData.allowance || 0) - spent;
      budgetData.allowance = newVal + remaining;
      budgetData.expenses = [];
      if (newInp) newInp.value = '';
      saveBudget();
    });

    document.getElementById('new-allowance')?.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') { e.preventDefault(); document.getElementById('carryover-btn')?.click(); }
    });

    document.getElementById('budget-amount')?.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') { e.preventDefault(); document.getElementById('budget-set-btn')?.click(); }
    });

    const addExpense = () => {
      const descInp = document.getElementById('expense-desc');
      const amtInp = document.getElementById('expense-amount');
      const desc = (descInp?.value || '').trim();
      const amount = parseFloat(amtInp?.value);
      if (!desc) return;
      if (isNaN(amount) || amount < 0) return;

      budgetData.expenses.push({
        id: Date.now().toString(36) + Math.random().toString(36).slice(2),
        desc,
        amount
      });
      saveBudget();
      if (descInp) descInp.value = '';
      if (amtInp) amtInp.value = '';
    };

    document.getElementById('expense-add-btn')?.addEventListener('click', addExpense);
    ['expense-desc', 'expense-amount'].forEach(id => {
      document.getElementById(id)?.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') { e.preventDefault(); addExpense(); }
      });
    });

    // Receipt
    const receiptModal = document.getElementById('receipt-modal');
    const receiptOutput = document.getElementById('receipt-output');

    function generateReceiptHTML() {
      const allowance = budgetData.allowance || 0;
      const spent = budgetData.expenses.reduce((s, e) => s + (parseFloat(e.amount) || 0), 0);
      const remaining = allowance - spent;
      const dateStr = new Date().toLocaleString('en-PH', { dateStyle: 'medium', timeStyle: 'short' });

      let lines = `
        <div class="receipt-title">BUDGET RECEIPT</div>
        <div class="receipt-date">${dateStr}</div>
        <div class="receipt-divider"></div>
        <div class="receipt-line"><span>Allowance</span><span>‚Ç±${allowance.toLocaleString('en-PH', { minimumFractionDigits: 2 })}</span></div>
      `;

      budgetData.expenses.forEach((e, i) => {
        const amt = parseFloat(e.amount) || 0;
        const desc = (e.desc || 'Item').replace(/</g, '&lt;').slice(0, 30);
        lines += `<div class="receipt-line"><span>${desc}</span><span>‚Ç±${amt.toLocaleString('en-PH', { minimumFractionDigits: 2 })}</span></div>`;
      });

      lines += `
        <div class="receipt-divider"></div>
        <div class="receipt-line"><span>Total Deductions</span><span>‚Ç±${spent.toLocaleString('en-PH', { minimumFractionDigits: 2 })}</span></div>
        <div class="receipt-line receipt-total"><span>Remaining</span><span>‚Ç±${remaining.toLocaleString('en-PH', { minimumFractionDigits: 2 })}</span></div>
        <div class="receipt-divider"></div>
        <div class="receipt-date">Thank you!</div>
      `;

      return lines;
    }

    document.getElementById('receipt-btn')?.addEventListener('click', () => {
      receiptOutput.innerHTML = generateReceiptHTML();
      receiptModal.classList.remove('hidden');
    });

    document.getElementById('receipt-close')?.addEventListener('click', () => {
      receiptModal.classList.add('hidden');
    });

    document.getElementById('receipt-print')?.addEventListener('click', () => {
      window.print();
    });

    document.getElementById('receipt-download')?.addEventListener('click', () => {
      if (typeof html2canvas === 'undefined') return;
      html2canvas(receiptOutput, { backgroundColor: '#ffffff', scale: 2 }).then(canvas => {
        const link = document.createElement('a');
        link.download = 'budget-receipt-' + new Date().toISOString().slice(0,10) + '.png';
        link.href = canvas.toDataURL('image/png');
        link.click();
      });
    });

    receiptModal?.addEventListener('click', (e) => {
      if (e.target === receiptModal) receiptModal.classList.add('hidden');
    });

    updateBudgetUI();

    // ========== Mini Test (50-Item Exam) ==========
    const MT_ID = [ // Identification: { q, a, subj }
      { q: 'Acronym for Do Not Resuscitate', a: 'DNR', subj: 'Fundamentals' },
      { q: 'The five rights of medication administration include right patient, drug, dose, route, and ____', a: 'time', subj: 'Fundamentals' },
      { q: 'Normal adult resting heart rate range in beats per minute', a: '60-100', subj: 'Fundamentals' },
      { q: 'Position where patient lies on back with knees bent', a: 'dorsal recumbent', subj: 'Fundamentals' },
      { q: '_____ means nothing by mouth', a: 'NPO', subj: 'Fundamentals' },
      { q: 'Communication framework: Situation, Background, Assessment, _____', a: 'Recommendation', subj: 'Fundamentals' },
      { q: 'Fire response: Rescue, Alarm, Contain, _____', a: 'Extinguish', subj: 'Fundamentals' },
      { q: 'Low oxygen in tissues', a: 'hypoxia', subj: 'Fundamentals' },
      { q: 'Heart rate over 100 bpm', a: 'tachycardia', subj: 'Fundamentals' },
      { q: 'Difficulty breathing', a: 'dyspnea', subj: 'Fundamentals' },
      { q: 'Inflammation of the peritoneum', a: 'peritonitis', subj: 'Med-Surg' },
      { q: 'Blood clot in deep vein', a: 'DVT', subj: 'Med-Surg' },
      { q: 'Heparin is reversed with _____ sulfate', a: 'protamine', subj: 'Med-Surg' },
      { q: 'Warfarin is reversed with Vitamin _____', a: 'K', subj: 'Med-Surg' },
      { q: 'Defense mechanism of attributing own feelings to others', a: 'projection', subj: 'Psych' },
      { q: 'Involuntary movements from long-term antipsychotics', a: 'tardive dyskinesia', subj: 'Psych' },
      { q: 'ACE inhibitors may cause dry _____', a: 'cough', subj: 'Pharmacology' },
      { q: 'Opioid overdose is reversed with _____', a: 'naloxone', subj: 'Pharmacology' },
      { q: 'Activated partial thromboplastin time monitors _____', a: 'heparin', subj: 'Pharmacology' },
      { q: 'Beta-blockers should be avoided in _____', a: 'asthma', subj: 'Pharmacology' },
      { q: 'Patient seeing people as all good or all bad', a: 'splitting', subj: 'Psych' },
      { q: 'Acute confusion that fluctuates', a: 'delirium', subj: 'Psych' },
      { q: 'Signs of PE: sudden dyspnea, chest pain, _____', a: 'tachycardia', subj: 'Med-Surg' },
      { q: 'Cushing\'s triad indicates elevated _____', a: 'ICP', subj: 'Med-Surg' },
      { q: 'Acronym for as needed', a: 'PRN', subj: 'Fundamentals' },
      { q: 'Abbreviation for twice daily', a: 'BID', subj: 'Fundamentals' },
      { q: 'Abbreviation for four times daily', a: 'QID', subj: 'Fundamentals' },
      { q: 'Position where head is lower than feet', a: 'Trendelenburg', subj: 'Fundamentals' },
      { q: 'Skin breakdown from pressure', a: 'pressure ulcer', subj: 'Fundamentals' },
      { q: 'Transfer of pathogens by touching', a: 'contact transmission', subj: 'Fundamentals' },
      { q: 'Patient\'s right to make own decisions', a: 'autonomy', subj: 'Fundamentals' },
      { q: 'Doing no harm to the patient', a: 'nonmaleficence', subj: 'Fundamentals' },
      { q: 'Acting for the benefit of the patient', a: 'beneficence', subj: 'Fundamentals' },
      { q: 'Fair distribution of resources', a: 'justice', subj: 'Fundamentals' },
      { q: 'Low blood pressure upon standing', a: 'orthostatic hypotension', subj: 'Fundamentals' },
      { q: 'Yellowing of skin from bilirubin', a: 'jaundice', subj: 'Med-Surg' },
      { q: 'Blood in the urine', a: 'hematuria', subj: 'Med-Surg' },
      { q: 'Black tarry stools', a: 'melena', subj: 'Med-Surg' },
      { q: 'Difficulty swallowing', a: 'dysphagia', subj: 'Med-Surg' },
      { q: 'Vomiting blood', a: 'hematemesis', subj: 'Med-Surg' },
      { q: 'Excess fluid in lungs', a: 'pulmonary edema', subj: 'Med-Surg' },
      { q: 'Collapsed lung', a: 'pneumothorax', subj: 'Med-Surg' },
      { q: 'Inflammation of the pancreas', a: 'pancreatitis', subj: 'Med-Surg' },
      { q: 'Kidney failure requiring dialysis', a: 'ESRD', subj: 'Med-Surg' },
      { q: 'Chronic obstructive pulmonary disease acronym', a: 'COPD', subj: 'Med-Surg' },
      { q: 'High blood sugar emergency', a: 'DKA', subj: 'Med-Surg' },
      { q: 'Low blood sugar', a: 'hypoglycemia', subj: 'Med-Surg' },
      { q: 'Heart attack', a: 'MI', subj: 'Med-Surg' },
      { q: 'Stroke caused by clot', a: 'ischemic stroke', subj: 'Med-Surg' },
      { q: 'Monitor for warfarin therapy', a: 'INR', subj: 'Pharmacology' },
      { q: 'Class of drugs ending in -pril', a: 'ACE inhibitor', subj: 'Pharmacology' },
      { q: 'Class of drugs ending in -olol', a: 'beta-blocker', subj: 'Pharmacology' },
      { q: 'Antidote for magnesium sulfate toxicity', a: 'calcium gluconate', subj: 'Pharmacology' },
      { q: 'Red man syndrome is associated with _____', a: 'vancomycin', subj: 'Pharmacology' },
      { q: 'Antibiotic that causes photosensitivity', a: 'tetracycline', subj: 'Pharmacology' },
      { q: 'Ototoxic antibiotic class', a: 'aminoglycoside', subj: 'Pharmacology' },
      { q: 'Drug requiring INR monitoring', a: 'warfarin', subj: 'Pharmacology' },
      { q: 'SSRI stands for selective _____ reuptake inhibitor', a: 'serotonin', subj: 'Pharmacology' },
      { q: 'Benzodiazepine reversal agent', a: 'flumazenil', subj: 'Pharmacology' },
      { q: 'Defense mechanism of returning to earlier stage', a: 'regression', subj: 'Psych' },
      { q: 'Defense mechanism of channeling impulses into socially acceptable activity', a: 'sublimation', subj: 'Psych' },
      { q: 'Unconsciously blocking unacceptable thoughts', a: 'repression', subj: 'Psych' },
      { q: 'Refusing to accept reality', a: 'denial', subj: 'Psych' },
      { q: 'Justifying behavior with logical reasons', a: 'rationalization', subj: 'Psych' },
      { q: 'Mania with psychosis', a: 'bipolar I', subj: 'Psych' },
      { q: 'Fear of being in open spaces', a: 'agoraphobia', subj: 'Psych' },
      { q: 'Intrusive thoughts and repetitive behaviors', a: 'OCD', subj: 'Psych' },
      { q: 'Flashbacks after traumatic event', a: 'PTSD', subj: 'Psych' },
      { q: 'Inappropriate attachment to caregiver in BPD', a: 'splitting', subj: 'Psych' },
      { q: 'RACE stands for Rescue, Alarm, Contain, _____', a: 'Extinguish', subj: 'Fundamentals' },
      { q: 'Normal diastolic BP range in mmHg', a: '60-80', subj: 'Fundamentals' },
      { q: 'Fever-reducing medication class', a: 'antipyretic', subj: 'Pharmacology' },
      { q: 'NSAID stands for non-_____ anti-inflammatory drug', a: 'steroidal', subj: 'Pharmacology' },
      { q: 'Insulin given at mealtime', a: 'rapid-acting', subj: 'Pharmacology' },
      { q: 'Long-acting basal insulin', a: 'glargine', subj: 'Pharmacology' },
      { q: 'Sign of digoxin toxicity: seeing _____ halos', a: 'yellow', subj: 'Pharmacology' },
      { q: 'Anticholinergic side effect: _____ mouth', a: 'dry', subj: 'Pharmacology' },
      { q: 'Statins lower _____', a: 'cholesterol', subj: 'Pharmacology' },
      { q: 'PPI stands for proton _____ inhibitor', a: 'pump', subj: 'Pharmacology' },
      { q: 'Anti-seizure medication that requires blood level', a: 'phenytoin', subj: 'Pharmacology' },
      { q: 'Anticoagulant that is an Xa inhibitor', a: 'rivaroxaban', subj: 'Pharmacology' },
      { q: 'ACE inhibitor that may cause _____ retention', a: 'potassium', subj: 'Pharmacology' },
      { q: 'Calcium channel blocker suffix', a: '-dipine', subj: 'Pharmacology' },
      { q: 'Loop diuretic ending in -ide', a: 'furosemide', subj: 'Pharmacology' },
      { q: 'Thiazide diuretics cause _____ loss', a: 'potassium', subj: 'Pharmacology' },
      { q: 'Bone marrow suppression is a side effect of _____', a: 'chemotherapy', subj: 'Pharmacology' },
      { q: 'Acid-base imbalance in DKA', a: 'metabolic acidosis', subj: 'Med-Surg' },
      { q: 'Test for kidney function', a: 'creatinine', subj: 'Med-Surg' },
      { q: 'Liver enzyme often elevated in liver disease', a: 'ALT', subj: 'Med-Surg' },
      { q: 'WBC count above normal', a: 'leukocytosis', subj: 'Med-Surg' },
      { q: 'Low hemoglobin', a: 'anemia', subj: 'Med-Surg' },
      { q: 'Excess potassium in blood', a: 'hyperkalemia', subj: 'Med-Surg' },
      { q: 'Low sodium in blood', a: 'hyponatremia', subj: 'Med-Surg' },
      { q: 'Excess fluid in abdomen', a: 'ascites', subj: 'Med-Surg' },
      { q: 'Swelling from fluid retention', a: 'edema', subj: 'Med-Surg' },
      { q: 'Surgical connection between vessels', a: 'anastomosis', subj: 'Med-Surg' },
      { q: 'Surgical removal of appendix', a: 'appendectomy', subj: 'Med-Surg' },
      { q: 'Surgical removal of gallbladder', a: 'cholecystectomy', subj: 'Med-Surg' },
      { q: 'Tube inserted through nose to stomach', a: 'NG tube', subj: 'Med-Surg' },
      { q: 'Catheter in the bladder', a: 'Foley', subj: 'Med-Surg' },
      { q: 'Central line site care uses _____ solution', a: 'chlorhexidine', subj: 'Fundamentals' },
      { q: 'Pressure ulcer stage with full thickness loss', a: 'Stage 3', subj: 'Fundamentals' },
      { q: 'SBAR stands for Situation, Background, Assessment, _____', a: 'Recommendation', subj: 'Fundamentals' },
      { q: 'Maslow\'s highest level of need', a: 'self-actualization', subj: 'Fundamentals' },
      { q: 'Teaching method using return demonstration', a: 'psychomotor', subj: 'Fundamentals' },
      { q: 'Legal document for end-of-life wishes', a: 'advance directive', subj: 'Fundamentals' },
      { q: 'HIPAA protects patient _____', a: 'privacy', subj: 'Fundamentals' },
      { q: 'Incident report is _____ fact', a: 'factual', subj: 'Fundamentals' },
      { q: 'Delegation: RN cannot delegate _____', a: 'assessment', subj: 'Fundamentals' },
      { q: 'Position for shock to improve venous return', a: 'Trendelenburg', subj: 'Fundamentals' },
      { q: 'Side-lying position with legs bent', a: 'Sims', subj: 'Fundamentals' },
      { q: 'Erikson stage: trust vs _____', a: 'mistrust', subj: 'Psych' },
      { q: 'Kubler-Ross stage: bargaining comes after _____', a: 'anger', subj: 'Psych' },
      { q: 'Therapeutic technique of restating patient words', a: 'reflection', subj: 'Psych' },
      { q: 'Non-therapeutic: giving _____', a: 'advice', subj: 'Psych' },
      { q: 'ECT stands for _____ convulsive therapy', a: 'electro', subj: 'Psych' },
      { q: 'Tardive _____ from antipsychotics', a: 'dyskinesia', subj: 'Psych' },
      { q: 'Antipsychotic that requires blood glucose monitoring', a: 'clozapine', subj: 'Psych' },
      { q: 'Mood stabilizer with narrow therapeutic range', a: 'lithium', subj: 'Psych' },
      { q: 'Black box warning for SSRIs in young adults', a: 'suicide', subj: 'Psych' },
      { q: 'Benzodiazepine withdrawal can cause _____', a: 'seizures', subj: 'Psych' },
      { q: 'Position with head elevated 30-45 degrees', a: 'Semi-Fowler', subj: 'Fundamentals' },
      { q: 'Point of maximum impulse location', a: 'apex', subj: 'Fundamentals' },
      { q: 'Scale used to assess consciousness', a: 'GCS', subj: 'Fundamentals' },
      { q: 'Normal urine output per hour', a: '30', subj: 'Fundamentals' },
      { q: 'Chest compressions to breaths ratio in adult CPR', a: '30:2', subj: 'Fundamentals' },
      { q: 'MRSA stands for methicillin-resistant _____', a: 'Staphylococcus aureus', subj: 'Med-Surg' },
      { q: 'Heart failure where ventricle does not fill properly', a: 'diastolic', subj: 'Med-Surg' },
      { q: 'Arrhythmia with absent P waves', a: 'atrial fibrillation', subj: 'Med-Surg' },
      { q: 'Antidote for benzodiazepine overdose', a: 'flumazenil', subj: 'Pharmacology' },
      { q: 'Antidote for acetaminophen overdose', a: 'acetylcysteine', subj: 'Pharmacology' },
      { q: 'Class of drugs ending in -sartan', a: 'ARB', subj: 'Pharmacology' },
      { q: 'First-line treatment for anaphylaxis', a: 'epinephrine', subj: 'Pharmacology' },
      { q: 'Test for heparin level', a: 'aPTT', subj: 'Pharmacology' },
      { q: 'Drug that requires WBC monitoring', a: 'clozapine', subj: 'Psych' },
      { q: 'Defense mechanism of redirecting feelings to a safer target', a: 'displacement', subj: 'Psych' },
      { q: 'Lack of speech in schizophrenia', a: 'alogia', subj: 'Psych' },
      { q: 'Inability to experience pleasure', a: 'anhedonia', subj: 'Psych' },
      { q: 'Process of helping patient examine own thoughts', a: 'cognition', subj: 'Psych' },
      { q: 'Excessive fluid in pleural space', a: 'pleural effusion', subj: 'Med-Surg' },
      { q: 'Inflammation of the meninges', a: 'meningitis', subj: 'Med-Surg' },
      { q: 'Excess cerebrospinal fluid in brain', a: 'hydrocephalus', subj: 'Med-Surg' },
      { q: 'Damage to median nerve in wrist', a: 'carpal tunnel', subj: 'Med-Surg' },
      { q: 'Surgical creation of opening in trachea', a: 'tracheostomy', subj: 'Med-Surg' },
      { q: 'Lack of red blood cells', a: 'anemia', subj: 'Med-Surg' },
      { q: 'Cancer of white blood cells', a: 'leukemia', subj: 'Med-Surg' },
      { q: 'Narrowing of the spinal canal', a: 'spinal stenosis', subj: 'Med-Surg' },
      { q: 'ARB stands for angiotensin _____ blocker', a: 'receptor', subj: 'Pharmacology' },
      { q: 'Sulfonylurea drug that stimulates insulin release', a: 'glipizide', subj: 'Pharmacology' },
      { q: 'Drug class that inhibits platelet aggregation', a: 'antiplatelet', subj: 'Pharmacology' },
      { q: 'Inflammation of the bladder', a: 'cystitis', subj: 'Med-Surg' },
      { q: 'Inflammation of kidney and renal pelvis', a: 'pyelonephritis', subj: 'Med-Surg' },
      { q: 'Stone in the urinary tract', a: 'nephrolithiasis', subj: 'Med-Surg' },
      { q: 'Accumulation of fluid in pericardial sac', a: 'pericardial effusion', subj: 'Med-Surg' },
      { q: 'Inflammation of heart muscle', a: 'myocarditis', subj: 'Med-Surg' },
      { q: 'End-stage liver disease with scarring', a: 'cirrhosis', subj: 'Med-Surg' },
      { q: 'Inflammation of the liver', a: 'hepatitis', subj: 'Med-Surg' },
      { q: 'Swollen dilated veins in esophagus', a: 'varices', subj: 'Med-Surg' },
      { q: 'Life-threatening allergic reaction', a: 'anaphylaxis', subj: 'Med-Surg' },
      { q: 'Systemic infection leading to organ dysfunction', a: 'sepsis', subj: 'Med-Surg' },
      { q: 'Abbreviation for three times daily', a: 'TID', subj: 'Fundamentals' },
      { q: 'Abbreviation for once daily', a: 'QD', subj: 'Fundamentals' },
      { q: 'Abbreviation for at bedtime', a: 'HS', subj: 'Fundamentals' },
      { q: 'Legal responsibility for one\'s actions', a: 'accountability', subj: 'Fundamentals' },
      { q: 'Process of assigning tasks to others', a: 'delegation', subj: 'Fundamentals' },
      { q: 'Reduced or absent bowel sounds', a: 'hypoactive', subj: 'Med-Surg' },
      { q: 'Drug class that blocks H2 receptors', a: 'H2 blocker', subj: 'Pharmacology' },
      { q: '5-HT3 antagonist used for nausea', a: 'ondansetron', subj: 'Pharmacology' },
      { q: 'Medication that increases GI motility', a: 'metoclopramide', subj: 'Pharmacology' },
      { q: 'False belief that is firmly held', a: 'delusion', subj: 'Psych' },
      { q: 'Perception without external stimulus', a: 'hallucination', subj: 'Psych' },
      { q: 'Mania and depression in same disorder', a: 'bipolar', subj: 'Psych' },
      { q: 'Intense fear of gaining weight', a: 'anorexia', subj: 'Psych' },
      { q: 'Binge eating followed by purging', a: 'bulimia', subj: 'Psych' },
    ];
    const MT_TF = [ // True or False: { q, a: true|false, subj }
      { q: 'Handwashing is the single most effective way to prevent infection spread.', a: true, subj: 'Fundamentals' },
      { q: 'Standard precautions apply only to patients with known infections.', a: false, subj: 'Fundamentals' },
      { q: 'Informed consent requires the patient to understand risks, benefits, and alternatives.', a: true, subj: 'Fundamentals' },
      { q: 'You may share patient information with anyone on the care team.', a: false, subj: 'Fundamentals' },
      { q: 'Normal SpO2 is 95-100%.', a: true, subj: 'Fundamentals' },
      { q: 'Restraints do not require a physician order.', a: false, subj: 'Fundamentals' },
      { q: 'CPR should be started immediately when a patient codes.', a: true, subj: 'Fundamentals' },
      { q: 'DNR means Do Not Recover.', a: false, subj: 'Fundamentals' },
      { q: 'Wound care is cleaned from clean to dirty.', a: true, subj: 'Fundamentals' },
      { q: 'Trendelenburg position has the head higher than the feet.', a: false, subj: 'Fundamentals' },
      { q: 'Post-op ileus is characterized by absent bowel sounds.', a: true, subj: 'Med-Surg' },
      { q: 'COPD patients should receive high-flow oxygen (6L+).', a: false, subj: 'Med-Surg' },
      { q: 'Heparin is monitored with aPTT.', a: true, subj: 'Pharmacology' },
      { q: 'Beta-blockers are safe in uncontrolled asthma.', a: false, subj: 'Pharmacology' },
      { q: 'Therapeutic communication uses open-ended questions.', a: true, subj: 'Psych' },
      { q: 'Lithium requires therapeutic level monitoring.', a: true, subj: 'Psych' },
      { q: 'Metformin should be held before contrast procedures.', a: true, subj: 'Pharmacology' },
      { q: 'Vancomycin requires trough level monitoring.', a: true, subj: 'Pharmacology' },
      { q: 'Post-op atelectasis is prevented by incentive spirometry.', a: true, subj: 'Med-Surg' },
      { q: 'Heparin is reversed with Vitamin K.', a: false, subj: 'Med-Surg' },
      { q: 'NPO means nothing by mouth.', a: true, subj: 'Fundamentals' },
      { q: 'You can delegate nursing assessment to unlicensed personnel.', a: false, subj: 'Fundamentals' },
      { q: 'Hand hygiene should be performed before and after patient contact.', a: true, subj: 'Fundamentals' },
      { q: 'Restraints require a written order that must be renewed every 24 hours.', a: true, subj: 'Fundamentals' },
      { q: 'A nurse may share patient info with family without consent.', a: false, subj: 'Fundamentals' },
      { q: 'Wound healing occurs from the inside out.', a: true, subj: 'Fundamentals' },
      { q: 'Fowler\'s position has the head of bed at 90 degrees.', a: true, subj: 'Fundamentals' },
      { q: 'Blood pressure should be taken on the arm with an IV.', a: false, subj: 'Fundamentals' },
      { q: 'Telemetry monitors heart rhythm continuously.', a: true, subj: 'Fundamentals' },
      { q: 'A fall risk assessment is done only on admission.', a: false, subj: 'Fundamentals' },
      { q: 'Nurses can legally refuse assignments that exceed competency.', a: true, subj: 'Fundamentals' },
      { q: 'Documentation should include opinions and assumptions.', a: false, subj: 'Fundamentals' },
      { q: 'Pressure relief includes turning every 2 hours.', a: true, subj: 'Fundamentals' },
      { q: 'Signs on the door can replace handwashing.', a: false, subj: 'Fundamentals' },
      { q: 'Delegation follows the five rights: task, circumstance, person, direction, supervision.', a: true, subj: 'Fundamentals' },
      { q: 'A DNR order means do not treat the patient at all.', a: false, subj: 'Fundamentals' },
      { q: 'SBAR improves communication between providers.', a: true, subj: 'Fundamentals' },
      { q: 'HIPAA allows sharing PHI for treatment without consent.', a: true, subj: 'Fundamentals' },
      { q: 'Patients with COPD should receive low-flow oxygen.', a: true, subj: 'Med-Surg' },
      { q: 'DKA presents with low blood glucose.', a: false, subj: 'Med-Surg' },
      { q: 'CHF patients should limit fluid intake.', a: true, subj: 'Med-Surg' },
      { q: 'Heparin is given orally.', a: false, subj: 'Med-Surg' },
      { q: 'Bowel sounds are auscultated in all four quadrants.', a: true, subj: 'Med-Surg' },
      { q: 'A patient with appendicitis should receive a hot compress.', a: false, subj: 'Med-Surg' },
      { q: 'Post-op nausea can be treated with antiemetics.', a: true, subj: 'Med-Surg' },
      { q: 'Chest tubes should be clamped during transport.', a: false, subj: 'Med-Surg' },
      { q: 'Hypoglycemia is treated with fast-acting glucose.', a: true, subj: 'Med-Surg' },
      { q: 'Hyperkalemia causes peaked T waves on ECG.', a: true, subj: 'Med-Surg' },
      { q: 'A patient with an NG tube should always be NPO.', a: false, subj: 'Med-Surg' },
      { q: 'Deep vein thrombosis can lead to pulmonary embolism.', a: true, subj: 'Med-Surg' },
      { q: 'Flail chest moves inward on inspiration.', a: true, subj: 'Med-Surg' },
      { q: 'Peritonitis presents with board-like abdomen.', a: true, subj: 'Med-Surg' },
      { q: 'Hemorrhagic stroke is treated with tPA.', a: false, subj: 'Med-Surg' },
      { q: 'Asthma is reversible airway obstruction.', a: true, subj: 'Med-Surg' },
      { q: 'Type 1 diabetes is always managed with insulin.', a: true, subj: 'Med-Surg' },
      { q: 'Acute kidney injury is always permanent.', a: false, subj: 'Med-Surg' },
      { q: 'Cushing\'s triad indicates brain herniation.', a: true, subj: 'Med-Surg' },
      { q: 'Borborygmi are abnormal bowel sounds.', a: false, subj: 'Med-Surg' },
      { q: 'Therapeutic communication avoids giving advice.', a: true, subj: 'Psych' },
      { q: 'Transference is when the patient projects feelings onto the nurse.', a: true, subj: 'Psych' },
      { q: 'A suicidal patient should never be left alone.', a: true, subj: 'Psych' },
      { q: 'Lithium has no drug interactions.', a: false, subj: 'Psych' },
      { q: 'SSRIs work immediately.', a: false, subj: 'Psych' },
      { q: 'ECT can cause short-term memory loss.', a: true, subj: 'Psych' },
      { q: 'Benzodiazepines are first-line for long-term anxiety.', a: false, subj: 'Psych' },
      { q: 'Schizophrenia involves hallucinations and delusions.', a: true, subj: 'Psych' },
      { q: 'MAOIs require tyramine restriction.', a: true, subj: 'Psych' },
      { q: 'Antipsychotics can cause weight gain.', a: true, subj: 'Psych' },
      { q: 'Mild depression always requires medication.', a: false, subj: 'Psych' },
      { q: 'Milieu therapy uses the environment for healing.', a: true, subj: 'Psych' },
      { q: 'Setting limits is therapeutic for BPD.', a: true, subj: 'Psych' },
      { q: 'Delirium and dementia are the same condition.', a: false, subj: 'Psych' },
      { q: 'Avolition is lack of motivation in schizophrenia.', a: true, subj: 'Psych' },
      { q: 'Beta-blockers are contraindicated in asthma.', a: true, subj: 'Pharmacology' },
      { q: 'Aspirin is safe in children with viral illness.', a: false, subj: 'Pharmacology' },
      { q: 'Warfarin interacts with many foods and drugs.', a: true, subj: 'Pharmacology' },
      { q: 'Vancomycin infusions should be given slowly.', a: true, subj: 'Pharmacology' },
      { q: 'Metformin causes hypoglycemia when used alone.', a: false, subj: 'Pharmacology' },
      { q: 'ACE inhibitors can cause angioedema.', a: true, subj: 'Pharmacology' },
      { q: 'Digoxin increases heart contractility.', a: true, subj: 'Pharmacology' },
      { q: 'NSAIDs are safe in gastric ulcer patients.', a: false, subj: 'Pharmacology' },
      { q: 'Insulin can be given orally.', a: false, subj: 'Pharmacology' },
      { q: 'Opioids cause constipation.', a: true, subj: 'Pharmacology' },
      { q: 'Fluid bolus is first for anaphylaxis.', a: false, subj: 'Pharmacology' },
      { q: 'Epinephrine is first-line for anaphylaxis.', a: true, subj: 'Pharmacology' },
      { q: 'Aminoglycosides are nephrotoxic.', a: true, subj: 'Pharmacology' },
      { q: 'Calcium channel blockers lower blood pressure.', a: true, subj: 'Pharmacology' },
      { q: 'Statins can cause myopathy.', a: true, subj: 'Pharmacology' },
      { q: 'Furosemide is a potassium-sparing diuretic.', a: false, subj: 'Pharmacology' },
      { q: 'PPIs should be taken with food.', a: false, subj: 'Pharmacology' },
      { q: 'Phenytoin has a narrow therapeutic index.', a: true, subj: 'Pharmacology' },
      { q: 'Antacids can decrease absorption of other drugs.', a: true, subj: 'Pharmacology' },
      { q: 'Glucagon raises blood glucose.', a: true, subj: 'Pharmacology' },
      { q: 'Chest pain radiating to jaw suggests cardiac origin.', a: true, subj: 'Med-Surg' },
      { q: 'Urinary retention is a sign of adequate hydration.', a: false, subj: 'Med-Surg' },
      { q: 'Semi-Fowler position aids breathing.', a: true, subj: 'Fundamentals' },
      { q: 'Advance directives are only for elderly patients.', a: false, subj: 'Fundamentals' },
      { q: 'Flumazenil reverses benzodiazepine overdose.', a: true, subj: 'Pharmacology' },
      { q: 'Psychosis always requires antipsychotics.', a: false, subj: 'Psych' },
      { q: 'Nitroglycerin should be kept in light-resistant container.', a: true, subj: 'Pharmacology' },
      { q: 'Subcutaneous insulin is absorbed fastest from the abdomen.', a: true, subj: 'Pharmacology' },
      { q: 'Digoxin should be held for heart rate under 60 bpm.', a: true, subj: 'Pharmacology' },
      { q: 'MRSA requires contact precautions.', a: true, subj: 'Fundamentals' },
      { q: 'Patient teaching is only done at discharge.', a: false, subj: 'Fundamentals' },
      { q: 'tPA can be given for hemorrhagic stroke.', a: false, subj: 'Med-Surg' },
      { q: 'Diabetic ketoacidosis presents with high blood glucose.', a: true, subj: 'Med-Surg' },
      { q: 'Hyperkalemia is treated with calcium gluconate first for cardiac protection.', a: true, subj: 'Med-Surg' },
      { q: 'Clopidogrel should be held 5-7 days before surgery.', a: true, subj: 'Pharmacology' },
      { q: 'Metformin does not cause hypoglycemia when used alone.', a: true, subj: 'Pharmacology' },
      { q: 'Lithium and sodium have similar chemistry; dehydration increases lithium levels.', a: true, subj: 'Psych' },
      { q: 'All antipsychotics cause the same side effects.', a: false, subj: 'Psych' },
      { q: 'Refeeding syndrome can occur when starting nutrition in severely malnourished patients.', a: true, subj: 'Med-Surg' },
      { q: 'Ascites is a sign of liver failure.', a: true, subj: 'Med-Surg' },
      { q: 'Vitamin K reverses heparin.', a: false, subj: 'Pharmacology' },
      { q: 'Therapeutic communication uses closed-ended questions primarily.', a: false, subj: 'Psych' },
      { q: 'Nurses can accept verbal orders in emergencies.', a: true, subj: 'Fundamentals' },
      { q: 'Aphasia means difficulty swallowing.', a: false, subj: 'Med-Surg' },
      { q: 'Statin therapy can cause rhabdomyolysis.', a: true, subj: 'Pharmacology' },
      { q: 'Sepsis always presents with fever.', a: false, subj: 'Med-Surg' },
      { q: 'Ondansetron is an antiemetic.', a: true, subj: 'Pharmacology' },
      { q: 'Levothyroxine can be taken with calcium supplements at the same time.', a: false, subj: 'Pharmacology' },
      { q: 'Bisphosphonates should be taken with a full glass of water.', a: true, subj: 'Pharmacology' },
      { q: 'Auscultate bowel sounds before palpating the abdomen.', a: true, subj: 'Fundamentals' },
      { q: 'NG tubes can be used for long-term nutrition.', a: false, subj: 'Med-Surg' },
      { q: 'PEG tube is placed through the abdominal wall into stomach.', a: true, subj: 'Med-Surg' },
      { q: 'Hypertensive crisis can occur with MAOI and tyramine.', a: true, subj: 'Pharmacology' },
      { q: 'Surgical asepsis is used for all patient care.', a: false, subj: 'Fundamentals' },
      { q: 'Toxic megacolon is a complication of IBD.', a: true, subj: 'Med-Surg' },
      { q: 'Hemodialysis removes waste through the peritoneum.', a: false, subj: 'Med-Surg' },
      { q: 'Peritoneal dialysis uses the abdomen as a filter.', a: true, subj: 'Med-Surg' },
      { q: 'Albuterol is a long-acting bronchodilator.', a: false, subj: 'Pharmacology' },
      { q: 'Tiotropium is a long-acting anticholinergic for COPD.', a: true, subj: 'Pharmacology' },
      { q: 'Negative pressure rooms are used for airborne isolation.', a: true, subj: 'Fundamentals' },
      { q: 'Chain of custody is important for forensic evidence.', a: true, subj: 'Fundamentals' },
      { q: 'Transference occurs when patient projects feelings onto nurse.', a: true, subj: 'Psych' },
      { q: 'Countertransference is when nurse projects onto patient.', a: true, subj: 'Psych' },
      { q: 'Hemoglobin A1C reflects 3-month glucose control.', a: true, subj: 'Med-Surg' },
    ];
    const MT_FIB = [ // Fill in the blank: { q (with ___ for blank), a, subj }
      { q: 'Normal systolic BP is ______ mmHg.', a: '90-120', subj: 'Fundamentals' },
      { q: 'Reposition bedbound patients every ______ hours.', a: '2', subj: 'Fundamentals' },
      { q: 'Normal respiratory rate for adult is ______ breaths per minute.', a: '12-20', subj: 'Fundamentals' },
      { q: 'Normal fasting blood glucose is ______ mg/dL.', a: '70-100', subj: 'Fundamentals' },
      { q: 'Normal body temperature in Celsius is ______ ¬∞C.', a: '36.5-37.5', subj: 'Fundamentals' },
      { q: 'Bradycardia is heart rate under ______ bpm.', a: '60', subj: 'Fundamentals' },
      { q: 'PASS for fire extinguisher: Pull, Aim, ______, Sweep.', a: 'Squeeze', subj: 'Fundamentals' },
      { q: 'Lithium requires ______ level monitoring.', a: 'therapeutic', subj: 'Psych' },
      { q: 'Digoxin toxicity may cause ______ changes.', a: 'vision', subj: 'Pharmacology' },
      { q: 'DKA presents with metabolic ______.', a: 'acidosis', subj: 'Med-Surg' },
      { q: 'Heparin is monitored with ______.', a: 'aPTT', subj: 'Pharmacology' },
      { q: 'Naloxone reverses ______ overdose.', a: 'opioid', subj: 'Pharmacology' },
      { q: 'MAOIs require ______-free diet.', a: 'tyramine', subj: 'Psych' },
      { q: 'Contracting for safety relates to ______ risk.', a: 'suicide', subj: 'Psych' },
      { q: 'Normal diastolic BP is ______ mmHg.', a: '60-80', subj: 'Fundamentals' },
      { q: 'RACE: Rescue, Alarm, Contain, ______.', a: 'Extinguish', subj: 'Fundamentals' },
      { q: 'Pressure ulcers are prevented by turning every ______ hours.', a: '2', subj: 'Fundamentals' },
      { q: 'HIPAA protects patient ______.', a: 'privacy', subj: 'Fundamentals' },
      { q: 'SBAR: Situation, Background, Assessment, ______.', a: 'Recommendation', subj: 'Fundamentals' },
      { q: 'Informed ______ requires patient understanding.', a: 'consent', subj: 'Fundamentals' },
      { q: 'Restraint orders must be renewed every ______ hours.', a: '24', subj: 'Fundamentals' },
      { q: 'Delegation cannot include nursing ______.', a: 'assessment', subj: 'Fundamentals' },
      { q: 'Tachycardia is heart rate over ______ bpm.', a: '100', subj: 'Fundamentals' },
      { q: 'Normal SpO2 is ______%.', a: '95-100', subj: 'Fundamentals' },
      { q: 'Wound care: clean from ______ to dirty.', a: 'clean', subj: 'Fundamentals' },
      { q: 'Fowler\'s position has head of bed elevated ______ degrees.', a: '45-90', subj: 'Fundamentals' },
      { q: 'Maslow\'s base need is ______.', a: 'physiological', subj: 'Fundamentals' },
      { q: 'DKA blood glucose is typically over ______ mg/dL.', a: '250', subj: 'Med-Surg' },
      { q: 'Hypoglycemia is blood glucose under ______ mg/dL.', a: '70', subj: 'Med-Surg' },
      { q: 'Hyperkalemia is potassium over ______ mEq/L.', a: '5.0', subj: 'Med-Surg' },
      { q: 'INR therapeutic range for warfarin is ______.', a: '2-3', subj: 'Med-Surg' },
      { q: 'aPTT monitors ______ therapy.', a: 'heparin', subj: 'Med-Surg' },
      { q: 'COPD patients receive ______-flow oxygen.', a: 'low', subj: 'Med-Surg' },
      { q: 'CHF patients should limit ______ intake.', a: 'sodium', subj: 'Med-Surg' },
      { q: 'Post-op incentive spirometry prevents ______.', a: 'atelectasis', subj: 'Med-Surg' },
      { q: 'DVT prevention includes early ______.', a: 'ambulation', subj: 'Med-Surg' },
      { q: 'Peritonitis presents with ______-like abdomen.', a: 'board', subj: 'Med-Surg' },
      { q: 'Pulmonary embolism presents with sudden ______.', a: 'dyspnea', subj: 'Med-Surg' },
      { q: 'Cushing\'s triad indicates elevated ______.', a: 'ICP', subj: 'Med-Surg' },
      { q: 'Creatinine reflects ______ function.', a: 'kidney', subj: 'Med-Surg' },
      { q: 'Hemoglobin carries ______.', a: 'oxygen', subj: 'Med-Surg' },
      { q: 'Ascites is fluid in the ______.', a: 'abdomen', subj: 'Med-Surg' },
      { q: 'Lithium therapeutic level is ______ mEq/L.', a: '0.8-1.2', subj: 'Psych' },
      { q: 'SSRIs take ______ weeks for full effect.', a: '2-4', subj: 'Psych' },
      { q: 'EPS from antipsychotics: dystonia, akathisia, ______.', a: 'parkinsonism', subj: 'Psych' },
      { q: 'Therapeutic communication uses ______-ended questions.', a: 'open', subj: 'Psych' },
      { q: 'Contracting for ______ reduces suicide risk.', a: 'safety', subj: 'Psych' },
      { q: 'MAOIs require ______-restricted diet.', a: 'tyramine', subj: 'Psych' },
      { q: 'ECT can cause ______-term memory loss.', a: 'short', subj: 'Psych' },
      { q: 'Benzodiazepines cause ______ withdrawal.', a: 'rebound', subj: 'Psych' },
      { q: 'Delirium ______ throughout the day.', a: 'fluctuates', subj: 'Psych' },
      { q: 'Defense mechanism: attributing feelings to others is ______.', a: 'projection', subj: 'Psych' },
      { q: 'Heparin is reversed with ______ sulfate.', a: 'protamine', subj: 'Pharmacology' },
      { q: 'Warfarin is reversed with Vitamin ______.', a: 'K', subj: 'Pharmacology' },
      { q: 'Opioid overdose is reversed with ______.', a: 'naloxone', subj: 'Pharmacology' },
      { q: 'Digoxin toxicity causes ______ vision changes.', a: 'yellow', subj: 'Pharmacology' },
      { q: 'ACE inhibitors may cause dry ______.', a: 'cough', subj: 'Pharmacology' },
      { q: 'Beta-blockers end in ______.', a: '-olol', subj: 'Pharmacology' },
      { q: 'ACE inhibitors end in ______.', a: '-pril', subj: 'Pharmacology' },
      { q: 'Calcium channel blockers end in ______.', a: '-dipine', subj: 'Pharmacology' },
      { q: 'PPI stands for proton ______ inhibitor.', a: 'pump', subj: 'Pharmacology' },
      { q: 'Vancomycin requires ______ level monitoring.', a: 'trough', subj: 'Pharmacology' },
      { q: 'Metformin should be held before ______ procedures.', a: 'contrast', subj: 'Pharmacology' },
      { q: 'Red man syndrome is from rapid ______ infusion.', a: 'vancomycin', subj: 'Pharmacology' },
      { q: 'Statins lower ______.', a: 'cholesterol', subj: 'Pharmacology' },
      { q: 'Loop diuretic: ______.', a: 'furosemide', subj: 'Pharmacology' },
      { q: 'Magnesium sulfate toxicity is reversed with ______ gluconate.', a: 'calcium', subj: 'Pharmacology' },
      { q: 'Phenytoin requires ______ level monitoring.', a: 'therapeutic', subj: 'Pharmacology' },
      { q: 'Insulin is given ______ (route).', a: 'subcutaneously', subj: 'Pharmacology' },
      { q: 'Aminoglycosides can cause ______ toxicity.', a: 'ototoxicity', subj: 'Pharmacology' },
      { q: 'NSAIDs can cause ______ ulcer.', a: 'gastric', subj: 'Pharmacology' },
      { q: 'Anticholinergics cause ______ mouth.', a: 'dry', subj: 'Pharmacology' },
      { q: 'Tetracycline causes ______ sensitivity.', a: 'photosensitivity', subj: 'Pharmacology' },
      { q: 'Fluid replacement in DKA uses ______ saline.', a: 'normal', subj: 'Med-Surg' },
      { q: 'Kussmaul respirations indicate ______ acidosis.', a: 'metabolic', subj: 'Med-Surg' },
      { q: 'Trousseau sign indicates ______.', a: 'hypocalcemia', subj: 'Med-Surg' },
      { q: 'Chvostek sign indicates ______.', a: 'hypocalcemia', subj: 'Med-Surg' },
      { q: 'Orthostatic hypotension is a drop in BP when ______.', a: 'standing', subj: 'Fundamentals' },
      { q: 'PASS: Pull, Aim, Squeeze, ______.', a: 'Sweep', subj: 'Fundamentals' },
      { q: 'The five rights: patient, drug, dose, route, and ______.', a: 'time', subj: 'Fundamentals' },
      { q: 'Malpractice is professional ______.', a: 'negligence', subj: 'Fundamentals' },
      { q: 'Incident reports are not part of the ______ record.', a: 'medical', subj: 'Fundamentals' },
      { q: 'Erikson: infant stage is trust vs ______.', a: 'mistrust', subj: 'Psych' },
      { q: 'Kubler-Ross stages: denial, anger, bargaining, ______, acceptance.', a: 'depression', subj: 'Psych' },
      { q: 'Tardive ______ from long-term antipsychotics.', a: 'dyskinesia', subj: 'Psych' },
      { q: 'Clozapine requires ______ monitoring.', a: 'WBC', subj: 'Psych' },
      { q: 'Black box: SSRIs may increase ______ in young adults.', a: 'suicide', subj: 'Psych' },
      { q: 'Xa inhibitors include ______.', a: 'rivaroxaban', subj: 'Pharmacology' },
      { q: 'First-line for anaphylaxis: ______.', a: 'epinephrine', subj: 'Pharmacology' },
      { q: 'Benzodiazepine reversal: ______.', a: 'flumazenil', subj: 'Pharmacology' },
      { q: 'Antidote for acetaminophen: ______.', a: 'acetylcysteine', subj: 'Pharmacology' },
      { q: 'Glucagon treats severe ______.', a: 'hypoglycemia', subj: 'Pharmacology' },
      { q: 'Nitroglycerin is stored in ______-resistant container.', a: 'light', subj: 'Pharmacology' },
      { q: 'Hyperglycemia in DKA is over ______ mg/dL.', a: '250', subj: 'Med-Surg' },
      { q: 'tPA is given within ______ hours of stroke onset.', a: '4.5', subj: 'Med-Surg' },
      { q: 'CPR compression depth is ______ inches.', a: '2', subj: 'Fundamentals' },
      { q: 'CPR compression rate is ______ per minute.', a: '100-120', subj: 'Fundamentals' },
      { q: 'AED stands for automated external ______.', a: 'defibrillator', subj: 'Fundamentals' },
      { q: 'Oliguria is urine output less than ______ mL/day.', a: '400', subj: 'Med-Surg' },
      { q: 'Braden scale assesses ______ ulcer risk.', a: 'pressure', subj: 'Fundamentals' },
      { q: 'Glasgow Coma Scale assesses ______, verbal, motor.', a: 'eye', subj: 'Fundamentals' },
      { q: 'Adult CPR compression depth is ______ inches.', a: '2', subj: 'Fundamentals' },
      { q: 'MRSA requires ______ precautions.', a: 'contact', subj: 'Fundamentals' },
      { q: 'TB requires ______ precautions.', a: 'airborne', subj: 'Fundamentals' },
      { q: 'Normal adult urine output is at least ______ mL/hr.', a: '30', subj: 'Fundamentals' },
      { q: 'Hyponatremia is sodium under ______ mEq/L.', a: '135', subj: 'Med-Surg' },
      { q: 'Hypokalemia is potassium under ______ mEq/L.', a: '3.5', subj: 'Med-Surg' },
      { q: 'tPA must be given within ______ hours of stroke onset.', a: '4.5', subj: 'Med-Surg' },
      { q: 'DVT commonly presents with ______ leg swelling.', a: 'unilateral', subj: 'Med-Surg' },
      { q: 'Homan\'s sign assesses for ______.', a: 'DVT', subj: 'Med-Surg' },
      { q: 'Heparin-induced thrombocytopenia causes ______ platelet count.', a: 'low', subj: 'Pharmacology' },
      { q: 'Digoxin therapeutic level is ______ ng/mL.', a: '0.5-2', subj: 'Pharmacology' },
      { q: 'Phenytoin therapeutic level is ______ mcg/mL.', a: '10-20', subj: 'Pharmacology' },
      { q: 'Valproic acid requires ______ function monitoring.', a: 'liver', subj: 'Pharmacology' },
      { q: 'Clozapine requires ______ monitoring weekly initially.', a: 'WBC', subj: 'Psych' },
      { q: 'CIWA scale assesses ______ withdrawal.', a: 'alcohol', subj: 'Psych' },
      { q: 'Extrapyramidal symptoms are ______ effects of antipsychotics.', a: 'adverse', subj: 'Psych' },
      { q: 'Naloxone has a shorter half-life than most ______.', a: 'opioids', subj: 'Pharmacology' },
      { q: 'PPIs are most effective taken ______ breakfast.', a: 'before', subj: 'Pharmacology' },
      { q: 'Normal hemoglobin for adult female is ______ g/dL.', a: '12-16', subj: 'Med-Surg' },
      { q: 'Normal hemoglobin for adult male is ______ g/dL.', a: '14-18', subj: 'Med-Surg' },
      { q: 'Anuria is urine output less than ______ mL/day.', a: '100', subj: 'Med-Surg' },
      { q: 'Sodium normal range is ______ mEq/L.', a: '135-145', subj: 'Med-Surg' },
      { q: 'Potassium normal range is ______ mEq/L.', a: '3.5-5.0', subj: 'Med-Surg' },
      { q: 'Warfarin affects vitamin ______-dependent clotting factors.', a: 'K', subj: 'Pharmacology' },
      { q: 'Sulfonylureas stimulate ______ release from pancreas.', a: 'insulin', subj: 'Pharmacology' },
      { q: 'Metformin decreases ______ production by liver.', a: 'glucose', subj: 'Pharmacology' },
      { q: 'Phenothiazines are a class of ______.', a: 'antipsychotics', subj: 'Pharmacology' },
      { q: 'Lamotrigine is a mood ______.', a: 'stabilizer', subj: 'Pharmacology' },
      { q: 'Fluid deficit is measured by ______ deficit.', a: 'fluid', subj: 'Med-Surg' },
      { q: 'AST and ALT reflect ______ function.', a: 'liver', subj: 'Med-Surg' },
      { q: 'BNP indicates _____ failure.', a: 'heart', subj: 'Med-Surg' },
      { q: 'Mobility aids include cane, walker, and ______.', a: 'crutches', subj: 'Fundamentals' },
      { q: 'Two-person ______ is used for dependent transfers.', a: 'transfer', subj: 'Fundamentals' },
      { q: 'Skin ______ indicates dehydration.', a: 'turgor', subj: 'Fundamentals' },
      { q: 'Pitting _____ indicates fluid overload.', a: 'edema', subj: 'Med-Surg' },
      { q: 'Psychotic features include delusions and ______.', a: 'hallucinations', subj: 'Psych' },
      { q: 'Behavioral _____ is first-line for mild dementia.', a: 'interventions', subj: 'Psych' },
    ];
    const MT_SATA = [ // SATA: { q, opts: [{text, correct}], subj }
      { q: 'Which are part of standard precautions? (Select all that apply)', opts: [{t:'Hand hygiene',c:true},{t:'Gloves',c:true},{t:'Mask when splashes likely',c:true},{t:'Gown when soiling likely',c:true},{t:'N95 respirator always',c:false}], subj: 'Fundamentals' },
      { q: 'The five rights of medication include: (Select all that apply)', opts: [{t:'Right patient',c:true},{t:'Right drug',c:true},{t:'Right dose',c:true},{t:'Right route',c:true},{t:'Right room',c:false}], subj: 'Fundamentals' },
      { q: 'Signs of hypoglycemia include: (Select all that apply)', opts: [{t:'Sweating',c:true},{t:'Tremor',c:true},{t:'Confusion',c:true},{t:'Kussmaul respirations',c:false},{t:'Fruity breath',c:false}], subj: 'Med-Surg' },
      { q: 'DVT prevention includes: (Select all that apply)', opts: [{t:'Early ambulation',c:true},{t:'SCDs',c:true},{t:'Anticoagulants',c:true},{t:'Prolonged bed rest',c:false},{t:'Tight leg wraps',c:false}], subj: 'Med-Surg' },
      { q: 'Therapeutic communication techniques: (Select all that apply)', opts: [{t:'Open-ended questions',c:true},{t:'Reflection',c:true},{t:'Silence',c:true},{t:'Giving advice',c:false},{t:'Minimizing feelings',c:false}], subj: 'Psych' },
      { q: 'EPS from antipsychotics include: (Select all that apply)', opts: [{t:'Dystonia',c:true},{t:'Akathisia',c:true},{t:'Parkinsonism',c:true},{t:'Weight gain only',c:false}], subj: 'Psych' },
      { q: 'ACE inhibitor side effects: (Select all that apply)', opts: [{t:'Dry cough',c:true},{t:'Angioedema',c:true},{t:'Hyperkalemia',c:true},{t:'Hypokalemia',c:false}], subj: 'Pharmacology' },
      { q: 'Opioid monitoring includes: (Select all that apply)', opts: [{t:'Respiratory rate',c:true},{t:'Constipation',c:true},{t:'Dependence risk',c:true},{t:'Hypertension',c:false}], subj: 'Pharmacology' },
      { q: 'Documentation should be: (Select all that apply)', opts: [{t:'Accurate',c:true},{t:'Timely',c:true},{t:'Factual',c:true},{t:'Vague',c:false},{t:'Oral only',c:false}], subj: 'Fundamentals' },
      { q: 'Fall prevention includes: (Select all that apply)', opts: [{t:'Call bell',c:true},{t:'Non-slip footwear',c:true},{t:'Clutter-free environment',c:true},{t:'Restraints only',c:false}], subj: 'Fundamentals' },
      { q: 'CHF patient teaching: (Select all that apply)', opts: [{t:'Weigh daily',c:true},{t:'Limit sodium',c:true},{t:'Report edema',c:true},{t:'Drink unlimited fluids',c:false}], subj: 'Med-Surg' },
      { q: 'Signs of respiratory distress: (Select all that apply)', opts: [{t:'Nasal flaring',c:true},{t:'Retractions',c:true},{t:'Cyanosis',c:true},{t:'Bradycardia',c:false}], subj: 'Med-Surg' },
      { q: 'DKA manifestations: (Select all that apply)', opts: [{t:'Kussmaul respirations',c:true},{t:'Fruity breath',c:true},{t:'Dehydration',c:true},{t:'Hypoglycemia',c:false}], subj: 'Med-Surg' },
      { q: 'Post-op atelectasis prevention: (Select all that apply)', opts: [{t:'Incentive spirometry',c:true},{t:'Early ambulation',c:true},{t:'Coughing',c:true},{t:'Bed rest only',c:false}], subj: 'Med-Surg' },
      { q: 'Stroke warning signs: (Select all that apply)', opts: [{t:'Facial drooping',c:true},{t:'Arm weakness',c:true},{t:'Speech difficulty',c:true},{t:'Clear vision',c:false}], subj: 'Med-Surg' },
      { q: 'MI symptoms: (Select all that apply)', opts: [{t:'Chest pain',c:true},{t:'Dyspnea',c:true},{t:'Diaphoresis',c:true},{t:'Hypertension only',c:false}], subj: 'Med-Surg' },
      { q: 'Pulmonary embolism signs: (Select all that apply)', opts: [{t:'Sudden dyspnea',c:true},{t:'Pleuritic chest pain',c:true},{t:'Tachycardia',c:true},{t:'Bradycardia',c:false}], subj: 'Med-Surg' },
      { q: 'Renal failure manifestations: (Select all that apply)', opts: [{t:'Fluid overload',c:true},{t:'Elevated BUN',c:true},{t:'Electrolyte imbalance',c:true},{t:'Polyuria',c:false}], subj: 'Med-Surg' },
      { q: 'Liver failure signs: (Select all that apply)', opts: [{t:'Jaundice',c:true},{t:'Ascites',c:true},{t:'Encephalopathy',c:true},{t:'Hypotension only',c:false}], subj: 'Med-Surg' },
      { q: 'Sepsis criteria: (Select all that apply)', opts: [{t:'Fever',c:true},{t:'Tachycardia',c:true},{t:'Altered mental status',c:true},{t:'Bradycardia',c:false}], subj: 'Med-Surg' },
      { q: 'Pressure ulcer risk factors: (Select all that apply)', opts: [{t:'Immobility',c:true},{t:'Incontinence',c:true},{t:'Poor nutrition',c:true},{t:'Young age',c:false}], subj: 'Fundamentals' },
      { q: 'Infection control measures: (Select all that apply)', opts: [{t:'Hand hygiene',c:true},{t:'PPE',c:true},{t:'Isolation when needed',c:true},{t:'Reuse gloves',c:false}], subj: 'Fundamentals' },
      { q: 'Safe medication administration: (Select all that apply)', opts: [{t:'Verify patient ID',c:true},{t:'Check allergies',c:true},{t:'Double-check dose',c:true},{t:'Rush administration',c:false}], subj: 'Fundamentals' },
      { q: 'Delegation principles: (Select all that apply)', opts: [{t:'Right task',c:true},{t:'Right person',c:true},{t:'Right supervision',c:true},{t:'Delegate assessment',c:false}], subj: 'Fundamentals' },
      { q: 'Priorities in emergency: (Select all that apply)', opts: [{t:'Airway',c:true},{t:'Breathing',c:true},{t:'Circulation',c:true},{t:'Documentation first',c:false}], subj: 'Fundamentals' },
      { q: 'Patient rights include: (Select all that apply)', opts: [{t:'Informed consent',c:true},{t:'Privacy',c:true},{t:'Refuse treatment',c:true},{t:'Demand specific meds',c:false}], subj: 'Fundamentals' },
      { q: 'Fall prevention strategies: (Select all that apply)', opts: [{t:'Call light within reach',c:true},{t:'Non-slip footwear',c:true},{t:'Low bed',c:true},{t:'Restraints first',c:false}], subj: 'Fundamentals' },
      { q: 'Discharge teaching includes: (Select all that apply)', opts: [{t:'Medications',c:true},{t:'Warning signs',c:true},{t:'Follow-up care',c:true},{t:'Hospital gossip',c:false}], subj: 'Fundamentals' },
      { q: 'SBAR components: (Select all that apply)', opts: [{t:'Situation',c:true},{t:'Background',c:true},{t:'Assessment',c:true},{t:'Opinion',c:false}], subj: 'Fundamentals' },
      { q: 'Schizophrenia positive symptoms: (Select all that apply)', opts: [{t:'Hallucinations',c:true},{t:'Delusions',c:true},{t:'Disorganized speech',c:true},{t:'Flat affect',c:false}], subj: 'Psych' },
      { q: 'Mania manifestations: (Select all that apply)', opts: [{t:'Grandiosity',c:true},{t:'Decreased sleep',c:true},{t:'Racing thoughts',c:true},{t:'Lethargy',c:false}], subj: 'Psych' },
      { q: 'Depression symptoms: (Select all that apply)', opts: [{t:'Anhedonia',c:true},{t:'Sleep changes',c:true},{t:'Fatigue',c:true},{t:'Hypermotivation',c:false}], subj: 'Psych' },
      { q: 'Anxiety interventions: (Select all that apply)', opts: [{t:'Calm presence',c:true},{t:'Deep breathing',c:true},{t:'Grounding',c:true},{t:'Avoid patient',c:false}], subj: 'Psych' },
      { q: 'Suicide risk factors: (Select all that apply)', opts: [{t:'Previous attempt',c:true},{t:'Hopelessness',c:true},{t:'Plan',c:true},{t:'Good support only',c:false}], subj: 'Psych' },
      { q: 'Benzodiazepine concerns: (Select all that apply)', opts: [{t:'Dependence',c:true},{t:'Withdrawal',c:true},{t:'Sedation',c:true},{t:'Hypertension',c:false}], subj: 'Psych' },
      { q: 'Lithium teaching: (Select all that apply)', opts: [{t:'Maintain fluid intake',c:true},{t:'Avoid dehydration',c:true},{t:'Therapeutic levels',c:true},{t:'No monitoring needed',c:false}], subj: 'Psych' },
      { q: 'SSRI discontinuation: (Select all that apply)', opts: [{t:'Taper gradually',c:true},{t:'Don\'t stop abruptly',c:true},{t:'Monitor for relapse',c:true},{t:'Stop cold turkey',c:false}], subj: 'Psych' },
      { q: 'Antipsychotic side effects: (Select all that apply)', opts: [{t:'Weight gain',c:true},{t:'EPS',c:true},{t:'Metabolic syndrome',c:true},{t:'Hypertension only',c:false}], subj: 'Psych' },
      { q: 'ACE inhibitor monitoring: (Select all that apply)', opts: [{t:'Potassium',c:true},{t:'Creatinine',c:true},{t:'Blood pressure',c:true},{t:'Glucose only',c:false}], subj: 'Pharmacology' },
      { q: 'Warfarin interactions: (Select all that apply)', opts: [{t:'Vitamin K foods',c:true},{t:'NSAIDs',c:true},{t:'Many antibiotics',c:true},{t:'No interactions',c:false}], subj: 'Pharmacology' },
      { q: 'Insulin administration: (Select all that apply)', opts: [{t:'Rotate injection sites',c:true},{t:'Check expiration',c:true},{t:'Store properly',c:true},{t:'Give IV push',c:false}], subj: 'Pharmacology' },
      { q: 'Opioid nursing care: (Select all that apply)', opts: [{t:'Monitor respirations',c:true},{t:'Assess pain',c:true},{t:'Prevent constipation',c:true},{t:'Give with alcohol',c:false}], subj: 'Pharmacology' },
      { q: 'Digoxin teaching: (Select all that apply)', opts: [{t:'Take pulse',c:true},{t:'Report vision changes',c:true},{t:'Don\'t skip doses',c:true},{t:'Double if missed',c:false}], subj: 'Pharmacology' },
      { q: 'Metformin precautions: (Select all that apply)', opts: [{t:'Hold for contrast',c:true},{t:'Risk of lactic acidosis',c:true},{t:'Take with food',c:true},{t:'No precautions',c:false}], subj: 'Pharmacology' },
      { q: 'Vancomycin monitoring: (Select all that apply)', opts: [{t:'Trough levels',c:true},{t:'Infusion rate',c:true},{t:'Renal function',c:true},{t:'Peak only',c:false}], subj: 'Pharmacology' },
      { q: 'Beta-blocker precautions: (Select all that apply)', opts: [{t:'Avoid in asthma',c:true},{t:'Taper when stopping',c:true},{t:'Monitor heart rate',c:true},{t:'Give in bronchospasm',c:false}], subj: 'Pharmacology' },
      { q: 'Diuretic teaching: (Select all that apply)', opts: [{t:'Take in morning',c:true},{t:'Report weakness',c:true},{t:'Potassium-rich foods',c:true},{t:'Limit fluids always',c:false}], subj: 'Pharmacology' },
      { q: 'Corticosteroid teaching: (Select all that apply)', opts: [{t:'Don\'t stop abruptly',c:true},{t:'Take with food',c:true},{t:'Infection risk',c:true},{t:'Increase dose if sick',c:false}], subj: 'Pharmacology' },
      { q: 'Antibiotic stewardship: (Select all that apply)', opts: [{t:'Complete full course',c:true},{t:'Use narrow spectrum when possible',c:true},{t:'Culture before treat',c:true},{t:'Use for viruses',c:false}], subj: 'Pharmacology' },
      { q: 'Heparin monitoring: (Select all that apply)', opts: [{t:'aPTT',c:true},{t:'Platelets',c:true},{t:'Signs of bleeding',c:true},{t:'INR',c:false}], subj: 'Pharmacology' },
      { q: 'Hypoglycemia treatment: (Select all that apply)', opts: [{t:'15-20g glucose',c:true},{t:'Recheck in 15 min',c:true},{t:'Complex carb after',c:true},{t:'Give insulin',c:false}], subj: 'Med-Surg' },
      { q: 'Hyperkalemia treatment: (Select all that apply)', opts: [{t:'Kayexalate',c:true},{t:'Calcium gluconate',c:true},{t:'Insulin and dextrose',c:true},{t:'Potassium supplement',c:false}], subj: 'Med-Surg' },
      { q: 'CHF exacerbation signs: (Select all that apply)', opts: [{t:'Weight gain',c:true},{t:'Edema',c:true},{t:'Dyspnea',c:true},{t:'Polyuria',c:false}], subj: 'Med-Surg' },
      { q: 'Chest tube care: (Select all that apply)', opts: [{t:'Keep below chest',c:true},{t:'Check for bubbling',c:true},{t:'Strap connections',c:true},{t:'Clamp for transport',c:false}], subj: 'Med-Surg' },
      { q: 'NG tube care: (Select all that apply)', opts: [{t:'Verify placement',c:true},{t:'Elevate head',c:true},{t:'Oral care',c:true},{t:'Flush with air',c:false}], subj: 'Med-Surg' },
      { q: 'Pre-op teaching: (Select all that apply)', opts: [{t:'NPO instructions',c:true},{t:'Deep breathing',c:true},{t:'Early ambulation',c:true},{t:'Eat before surgery',c:false}], subj: 'Med-Surg' },
      { q: 'Delirium interventions: (Select all that apply)', opts: [{t:'Orient frequently',c:true},{t:'Familiar objects',c:true},{t:'Adequate lighting',c:true},{t:'Restraints first',c:false}], subj: 'Psych' },
      { q: 'BPD interventions: (Select all that apply)', opts: [{t:'Set limits',c:true},{t:'Validate feelings',c:true},{t:'Consistent staff',c:true},{t:'Confront splitting',c:false}], subj: 'Psych' },
      { q: 'PTSD symptoms: (Select all that apply)', opts: [{t:'Flashbacks',c:true},{t:'Avoidance',c:true},{t:'Hyperarousal',c:true},{t:'No memory of event',c:false}], subj: 'Psych' },
      { q: 'Non-therapeutic techniques: (Select all that apply)', opts: [{t:'Giving advice',c:true},{t:'False reassurance',c:true},{t:'Changing subject',c:true},{t:'Active listening',c:false}], subj: 'Psych' },
      { q: 'Restraint alternatives: (Select all that apply)', opts: [{t:'Diversional activities',c:true},{t:'Frequent rounding',c:true},{t:'Family presence',c:true},{t:'Medicate without consent',c:false}], subj: 'Fundamentals' },
      { q: 'Documentation principles: (Select all that apply)', opts: [{t:'Factual',c:true},{t:'Timely',c:true},{t:'Legible',c:true},{t:'Include opinions',c:false}], subj: 'Fundamentals' },
      { q: 'Blood transfusion reaction signs: (Select all that apply)', opts: [{t:'Fever',c:true},{t:'Chills',c:true},{t:'Back pain',c:true},{t:'Improved energy',c:false}], subj: 'Med-Surg' },
      { q: 'Contrast reaction prevention: (Select all that apply)', opts: [{t:'Assess allergies',c:true},{t:'Hydration',c:true},{t:'Hold metformin',c:true},{t:'No precautions',c:false}], subj: 'Pharmacology' },
      { q: 'Anaphylaxis treatment: (Select all that apply)', opts: [{t:'Epinephrine',c:true},{t:'Maintain airway',c:true},{t:'IV fluids',c:true},{t:'Antibiotic first',c:false}], subj: 'Pharmacology' },
      { q: 'Isolation precaution types: (Select all that apply)', opts: [{t:'Contact',c:true},{t:'Droplet',c:true},{t:'Airborne',c:true},{t:'Social',c:false}], subj: 'Fundamentals' },
      { q: 'Vital sign components: (Select all that apply)', opts: [{t:'Temperature',c:true},{t:'Pulse',c:true},{t:'Blood pressure',c:true},{t:'Weight',c:false}], subj: 'Fundamentals' },
      { q: 'IV site assessment: (Select all that apply)', opts: [{t:'Redness',c:true},{t:'Swelling',c:true},{t:'Pain',c:true},{t:'Patient preference',c:false}], subj: 'Fundamentals' },
      { q: 'Pain assessment: (Select all that apply)', opts: [{t:'Location',c:true},{t:'Intensity',c:true},{t:'Quality',c:true},{t:'Doctor\'s opinion',c:false}], subj: 'Fundamentals' },
      { q: 'Code blue response: (Select all that apply)', opts: [{t:'Start CPR',c:true},{t:'Call for help',c:true},{t:'Get defibrillator',c:true},{t:'Wait for doctor',c:false}], subj: 'Fundamentals' },
      { q: 'Pressure ulcer stages: (Select all that apply)', opts: [{t:'Stage 1',c:true},{t:'Stage 2',c:true},{t:'Stage 3',c:true},{t:'Stage 10',c:false}], subj: 'Fundamentals' },
      { q: 'Tube feeding complications: (Select all that apply)', opts: [{t:'Aspiration',c:true},{t:'Diarrhea',c:true},{t:'Tube dislodgement',c:true},{t:'Improved taste',c:false}], subj: 'Med-Surg' },
      { q: 'Ostomy care: (Select all that apply)', opts: [{t:'Skin protection',c:true},{t:'Monitor output',c:true},{t:'Pouch emptying',c:true},{t:'Ignore output',c:false}], subj: 'Med-Surg' },
      { q: 'Dialysis patient care: (Select all that apply)', opts: [{t:'Fluid restrictions',c:true},{t:'Diet modifications',c:true},{t:'Access site care',c:true},{t:'Unlimited potassium',c:false}], subj: 'Med-Surg' },
      { q: 'Asthma triggers: (Select all that apply)', opts: [{t:'Pollen',c:true},{t:'Exercise',c:true},{t:'Cold air',c:true},{t:'Rest',c:false}], subj: 'Med-Surg' },
      { q: 'GI bleed signs: (Select all that apply)', opts: [{t:'Hematemesis',c:true},{t:'Melena',c:true},{t:'Hypotension',c:true},{t:'Polyuria',c:false}], subj: 'Med-Surg' },
      { q: 'Pancreatitis management: (Select all that apply)', opts: [{t:'NPO',c:true},{t:'IV fluids',c:true},{t:'Pain control',c:true},{t:'High fat diet',c:false}], subj: 'Med-Surg' },
      { q: 'Shock manifestations: (Select all that apply)', opts: [{t:'Tachycardia',c:true},{t:'Hypotension',c:true},{t:'Cool clammy skin',c:true},{t:'Bounding pulse',c:false}], subj: 'Med-Surg' },
      { q: 'Alcohol withdrawal symptoms: (Select all that apply)', opts: [{t:'Tremors',c:true},{t:'Hallucinations',c:true},{t:'Seizures',c:true},{t:'Hypertension only',c:false}], subj: 'Psych' },
      { q: 'Eating disorder signs: (Select all that apply)', opts: [{t:'Weight changes',c:true},{t:'Binge-purge',c:true},{t:'Body image distortion',c:true},{t:'Normal eating only',c:false}], subj: 'Psych' },
      { q: 'Crisis intervention: (Select all that apply)', opts: [{t:'Assess safety',c:true},{t:'Listen',c:true},{t:'Identify support',c:true},{t:'Minimize feelings',c:false}], subj: 'Psych' },
      { q: 'Milieu therapy elements: (Select all that apply)', opts: [{t:'Safe environment',c:true},{t:'Structure',c:true},{t:'Therapeutic activities',c:true},{t:'Isolation',c:false}], subj: 'Psych' },
      { q: 'Antidepressant types: (Select all that apply)', opts: [{t:'SSRI',c:true},{t:'SNRI',c:true},{t:'MAOI',c:true},{t:'Opioid',c:false}], subj: 'Pharmacology' },
      { q: 'Drug absorption factors: (Select all that apply)', opts: [{t:'Route',c:true},{t:'Food',c:true},{t:'Blood flow',c:true},{t:'Patient mood',c:false}], subj: 'Pharmacology' },
      { q: 'Renal drug considerations: (Select all that apply)', opts: [{t:'Dose adjustment',c:true},{t:'Nephrotoxic drugs',c:true},{t:'Creatinine clearance',c:true},{t:'Ignore kidney function',c:false}], subj: 'Pharmacology' },
      { q: 'Antihypertensive classes: (Select all that apply)', opts: [{t:'ACE inhibitors',c:true},{t:'Beta-blockers',c:true},{t:'Calcium channel blockers',c:true},{t:'Opioids',c:false}], subj: 'Pharmacology' },
      { q: 'Chemotherapy precautions: (Select all that apply)', opts: [{t:'Personal protective equipment',c:true},{t:'Safe handling',c:true},{t:'Spill protocol',c:true},{t:'No precautions',c:false}], subj: 'Pharmacology' },
      { q: 'Anticoagulant patient teaching: (Select all that apply)', opts: [{t:'Signs of bleeding',c:true},{t:'Avoid trauma',c:true},{t:'Medication compliance',c:true},{t:'Double dose if missed',c:false}], subj: 'Pharmacology' },
      { q: 'Elderly drug considerations: (Select all that apply)', opts: [{t:'Reduced metabolism',c:true},{t:'Polypharmacy risk',c:true},{t:'Start low go slow',c:true},{t:'Higher doses always',c:false}], subj: 'Pharmacology' },
      { q: 'Pediatric drug considerations: (Select all that apply)', opts: [{t:'Weight-based dosing',c:true},{t:'Liquid formulations',c:true},{t:'Taste preference',c:true},{t:'Adult doses',c:false}], subj: 'Pharmacology' },
      { q: 'Contrast dye reactions: (Select all that apply)', opts: [{t:'Hives',c:true},{t:'Anaphylaxis',c:true},{t:'Nephrotoxicity',c:true},{t:'Improved vision',c:false}], subj: 'Pharmacology' },
      { q: 'CPR steps: (Select all that apply)', opts: [{t:'Compressions',c:true},{t:'Airway',c:true},{t:'Breathing',c:true},{t:'Documentation first',c:false}], subj: 'Fundamentals' },
      { q: 'Foley catheter care: (Select all that apply)', opts: [{t:'Keep bag below bladder',c:true},{t:'Perineal care',c:true},{t:'Monitor output',c:true},{t:'Tug to ensure placement',c:false}], subj: 'Med-Surg' },
      { q: 'Seizure precautions: (Select all that apply)', opts: [{t:'Padded side rails',c:true},{t:'Suction at bedside',c:true},{t:'Oxygen available',c:true},{t:'Restrain during seizure',c:false}], subj: 'Med-Surg' },
      { q: 'Bipolar disorder treatment: (Select all that apply)', opts: [{t:'Mood stabilizers',c:true},{t:'Lithium',c:true},{t:'Therapy',c:true},{t:'Stimulants only',c:false}], subj: 'Psych' },
      { q: 'Insulin injection sites: (Select all that apply)', opts: [{t:'Abdomen',c:true},{t:'Thigh',c:true},{t:'Upper arm',c:true},{t:'Same spot always',c:false}], subj: 'Pharmacology' },
      { q: 'Medication reconciliation includes: (Select all that apply)', opts: [{t:'Current medications',c:true},{t:'Allergies',c:true},{t:'Dose and frequency',c:true},{t:'Cost only',c:false}], subj: 'Fundamentals' },
      { q: 'Oxygen safety: (Select all that apply)', opts: [{t:'No smoking',c:true},{t:'Keep away from flames',c:true},{t:'Secure tubing',c:true},{t:'Use petroleum-based products',c:false}], subj: 'Fundamentals' },
      { q: 'Post-op complications: (Select all that apply)', opts: [{t:'Infection',c:true},{t:'Bleeding',c:true},{t:'DVT',c:true},{t:'Improved appetite only',c:false}], subj: 'Med-Surg' },
      { q: 'Naloxone administration: (Select all that apply)', opts: [{t:'Repeat if needed',c:true},{t:'Monitor respirations',c:true},{t:'IV or IM',c:true},{t:'Give slowly over 10 min',c:false}], subj: 'Pharmacology' },
      { q: 'Transmission-based precautions: (Select all that apply)', opts: [{t:'Contact',c:true},{t:'Droplet',c:true},{t:'Airborne',c:true},{t:'Social',c:false}], subj: 'Fundamentals' },
      { q: 'Hand hygiene indications: (Select all that apply)', opts: [{t:'Before patient contact',c:true},{t:'After body fluid exposure',c:true},{t:'After removing gloves',c:true},{t:'Only at shift start',c:false}], subj: 'Fundamentals' },
      { q: 'Restraint documentation: (Select all that apply)', opts: [{t:'Behavior justifying use',c:true},{t:'Alternatives tried',c:true},{t:'Skin checks',c:true},{t:'Family approval only',c:false}], subj: 'Fundamentals' },
      { q: 'Ethical principles in nursing: (Select all that apply)', opts: [{t:'Autonomy',c:true},{t:'Beneficence',c:true},{t:'Nonmaleficence',c:true},{t:'Convenience',c:false}], subj: 'Fundamentals' },
      { q: 'Informed consent requirements: (Select all that apply)', opts: [{t:'Capacity to understand',c:true},{t:'Explanation of procedure',c:true},{t:'Risks and benefits',c:true},{t:'Family signature only',c:false}], subj: 'Fundamentals' },
      { q: 'Nursing process steps: (Select all that apply)', opts: [{t:'Assessment',c:true},{t:'Diagnosis',c:true},{t:'Planning',c:true},{t:'Guessing',c:false}], subj: 'Fundamentals' },
      { q: 'Patient teaching domains: (Select all that apply)', opts: [{t:'Cognitive',c:true},{t:'Affective',c:true},{t:'Psychomotor',c:true},{t:'Financial only',c:false}], subj: 'Fundamentals' },
      { q: 'Shift report elements: (Select all that apply)', opts: [{t:'Current status',c:true},{t:'Changes overnight',c:true},{t:'Pending tasks',c:true},{t:'Gossip',c:false}], subj: 'Fundamentals' },
      { q: 'Surgical site infection prevention: (Select all that apply)', opts: [{t:'Pre-op bathing',c:true},{t:'Prophylactic antibiotics',c:true},{t:'Aseptic technique',c:true},{t:'Skip handwashing',c:false}], subj: 'Fundamentals' },
      { q: 'Central line bundle elements: (Select all that apply)', opts: [{t:'Hand hygiene',c:true},{t:'Maximal barrier',c:true},{t:'Chlorhexidine prep',c:true},{t:'Minimal gloves',c:false}], subj: 'Fundamentals' },
      { q: 'Fall risk assessment tools: (Select all that apply)', opts: [{t:'Morse Scale',c:true},{t:'Hendrich II',c:true},{t:'STRATIFY',c:true},{t:'No tool needed',c:false}], subj: 'Fundamentals' },
      { q: 'Pain assessment components: (Select all that apply)', opts: [{t:'Location',c:true},{t:'Quality',c:true},{t:'Onset and duration',c:true},{t:'Family guess',c:false}], subj: 'Fundamentals' },
      { q: 'IV infiltration signs: (Select all that apply)', opts: [{t:'Swelling',c:true},{t:'Coolness',c:true},{t:'Pain',c:true},{t:'Improved flow',c:false}], subj: 'Fundamentals' },
      { q: 'Blood transfusion checks: (Select all that apply)', opts: [{t:'Two identifiers',c:true},{t:'Blood type match',c:true},{t:'Expiration',c:true},{t:'Nurse preference',c:false}], subj: 'Fundamentals' },
      { q: 'Pre-op checklist: (Select all that apply)', opts: [{t:'Consent signed',c:true},{t:'NPO status',c:true},{t:'Allergies noted',c:true},{t:'Lunch order',c:false}], subj: 'Fundamentals' },
      { q: 'Post-op nursing priorities: (Select all that apply)', opts: [{t:'Airway',c:true},{t:'Vital signs',c:true},{t:'Pain management',c:true},{t:'Discharge papers',c:false}], subj: 'Med-Surg' },
      { q: 'Heart failure classifications: (Select all that apply)', opts: [{t:'NYHA Class I-IV',c:true},{t:'Systolic vs diastolic',c:true},{t:'Left vs right sided',c:true},{t:'Color coded',c:false}], subj: 'Med-Surg' },
      { q: 'Acute coronary syndrome symptoms: (Select all that apply)', opts: [{t:'Chest pressure',c:true},{t:'Shortness of breath',c:true},{t:'Nausea',c:true},{t:'Rash',c:false}], subj: 'Med-Surg' },
      { q: 'Hypertension complications: (Select all that apply)', opts: [{t:'Stroke',c:true},{t:'CHF',c:true},{t:'Renal failure',c:true},{t:'Improved vision',c:false}], subj: 'Med-Surg' },
      { q: 'Diabetes long-term complications: (Select all that apply)', opts: [{t:'Retinopathy',c:true},{t:'Nephropathy',c:true},{t:'Neuropathy',c:true},{t:'Improved immunity',c:false}], subj: 'Med-Surg' },
      { q: 'Chronic kidney disease stages: (Select all that apply)', opts: [{t:'Based on GFR',c:true},{t:'Stage 1-5',c:true},{t:'Progressive',c:true},{t:'Always reversible',c:false}], subj: 'Med-Surg' },
      { q: 'COPD management: (Select all that apply)', opts: [{t:'Smoking cessation',c:true},{t:'Pulmonary rehab',c:true},{t:'Bronchodilators',c:true},{t:'High-flow oxygen',c:false}], subj: 'Med-Surg' },
      { q: 'Asthma action plan includes: (Select all that apply)', opts: [{t:'Green zone',c:true},{t:'Yellow zone',c:true},{t:'Red zone',c:true},{t:'Purple zone',c:false}], subj: 'Med-Surg' },
      { q: 'Pneumonia risk factors: (Select all that apply)', opts: [{t:'Smoking',c:true},{t:'Age',c:true},{t:'Immunocompromised',c:true},{t:'Exercise',c:false}], subj: 'Med-Surg' },
      { q: 'Peptic ulcer causes: (Select all that apply)', opts: [{t:'H. pylori',c:true},{t:'NSAIDs',c:true},{t:'Stress',c:true},{t:'Vitamin C',c:false}], subj: 'Med-Surg' },
      { q: 'Inflammatory bowel disease types: (Select all that apply)', opts: [{t:'Crohn\'s',c:true},{t:'Ulcerative colitis',c:true},{t:'Diverticulitis',c:true},{t:'GERD',c:false}], subj: 'Med-Surg' },
      { q: 'Hepatitis transmission: (Select all that apply)', opts: [{t:'Blood',c:true},{t:'Body fluids',c:true},{t:'Contaminated food',c:true},{t:'Airborne',c:false}], subj: 'Med-Surg' },
      { q: 'Cirrhosis complications: (Select all that apply)', opts: [{t:'Ascites',c:true},{t:'Esophageal varices',c:true},{t:'Hepatic encephalopathy',c:true},{t:'Polyuria',c:false}], subj: 'Med-Surg' },
      { q: 'Acute pancreatitis causes: (Select all that apply)', opts: [{t:'Gallstones',c:true},{t:'Alcohol',c:true},{t:'Hypertriglyceridemia',c:true},{t:'Exercise',c:false}], subj: 'Med-Surg' },
      { q: 'Bowel obstruction signs: (Select all that apply)', opts: [{t:'Abdominal distension',c:true},{t:'Hyperactive then absent bowel sounds',c:true},{t:'Nausea',c:true},{t:'Diarrhea only',c:false}], subj: 'Med-Surg' },
      { q: 'Appendicitis signs: (Select all that apply)', opts: [{t:'RLQ pain',c:true},{t:'McBurney\'s point tenderness',c:true},{t:'Rebound tenderness',c:true},{t:'LLQ pain',c:false}], subj: 'Med-Surg' },
      { q: 'Cholecystitis manifestations: (Select all that apply)', opts: [{t:'RUQ pain',c:true},{t:'Murphy\'s sign',c:true},{t:'Fat intolerance',c:true},{t:'Polyuria',c:false}], subj: 'Med-Surg' },
      { q: 'Peripheral vascular disease signs: (Select all that apply)', opts: [{t:'Claudication',c:true},{t:'Cool extremities',c:true},{t:'Decreased pulses',c:true},{t:'Bounding pulses',c:false}], subj: 'Med-Surg' },
      { q: 'Deep vein thrombosis symptoms: (Select all that apply)', opts: [{t:'Calf pain',c:true},{t:'Swelling',c:true},{t:'Warmth',c:true},{t:'Bilateral equally',c:false}], subj: 'Med-Surg' },
      { q: 'Rhabdomyolysis causes: (Select all that apply)', opts: [{t:'Crush injury',c:true},{t:'Statin use',c:true},{t:'Exertion',c:true},{t:'Rest',c:false}], subj: 'Med-Surg' },
      { q: 'Acute respiratory failure causes: (Select all that apply)', opts: [{t:'Pneumonia',c:true},{t:'COPD exacerbation',c:true},{t:'ARDS',c:true},{t:'Dehydration only',c:false}], subj: 'Med-Surg' },
      { q: 'ARDS characteristics: (Select all that apply)', opts: [{t:'Refractory hypoxemia',c:true},{t:'Bilateral infiltrates',c:true},{t:'Noncardiogenic edema',c:true},{t:'Easy to treat',c:false}], subj: 'Med-Surg' },
      { q: 'Anemia causes: (Select all that apply)', opts: [{t:'Iron deficiency',c:true},{t:'B12 deficiency',c:true},{t:'Chronic disease',c:true},{t:'Hypervolemia',c:false}], subj: 'Med-Surg' },
      { q: 'Schizophrenia negative symptoms: (Select all that apply)', opts: [{t:'Flat affect',c:true},{t:'Avolition',c:true},{t:'Alogia',c:true},{t:'Hallucinations',c:false}], subj: 'Psych' },
      { q: 'Major depressive disorder criteria: (Select all that apply)', opts: [{t:'Depressed mood',c:true},{t:'Anhedonia',c:true},{t:'Duration 2+ weeks',c:true},{t:'One day only',c:false}], subj: 'Psych' },
      { q: 'Generalized anxiety disorder features: (Select all that apply)', opts: [{t:'Excessive worry',c:true},{t:'Restlessness',c:true},{t:'Duration 6+ months',c:true},{t:'Single episode',c:false}], subj: 'Psych' },
      { q: 'Panic disorder features: (Select all that apply)', opts: [{t:'Recurrent panic attacks',c:true},{t:'Worry about future attacks',c:true},{t:'Avoidance behavior',c:true},{t:'No physical symptoms',c:false}], subj: 'Psych' },
      { q: 'OCD components: (Select all that apply)', opts: [{t:'Obsessions',c:true},{t:'Compulsions',c:true},{t:'Time-consuming',c:true},{t:'Pleasurable',c:false}], subj: 'Psych' },
      { q: 'PTSD criteria: (Select all that apply)', opts: [{t:'Exposure to trauma',c:true},{t:'Intrusive symptoms',c:true},{t:'Avoidance',c:true},{t:'Duration 1 day',c:false}], subj: 'Psych' },
      { q: 'Personality disorder clusters: (Select all that apply)', opts: [{t:'Cluster A',c:true},{t:'Cluster B',c:true},{t:'Cluster C',c:true},{t:'Cluster D',c:false}], subj: 'Psych' },
      { q: 'Substance withdrawal nursing care: (Select all that apply)', opts: [{t:'CIWA protocol for alcohol',c:true},{t:'Seizure precautions',c:true},{t:'Vital signs',c:true},{t:'Encourage use',c:false}], subj: 'Psych' },
      { q: 'Antipsychotic monitoring: (Select all that apply)', opts: [{t:'Weight',c:true},{t:'Blood glucose',c:true},{t:'EPS',c:true},{t:'Hair growth',c:false}], subj: 'Psych' },
      { q: 'Lithium toxicity signs: (Select all that apply)', opts: [{t:'Coarse tremor',c:true},{t:'Confusion',c:true},{t:'Ataxia',c:true},{t:'Hypertension',c:false}], subj: 'Psych' },
      { q: 'SSRI discontinuation syndrome: (Select all that apply)', opts: [{t:'Dizziness',c:true},{t:'Electric shock sensations',c:true},{t:'Flu-like symptoms',c:true},{t:'Improved mood',c:false}], subj: 'Psych' },
      { q: 'Serotonin syndrome signs: (Select all that apply)', opts: [{t:'Agitation',c:true},{t:'Hyperthermia',c:true},{t:'Muscle rigidity',c:true},{t:'Hypothermia',c:false}], subj: 'Psych' },
      { q: 'Neuroleptic malignant syndrome: (Select all that apply)', opts: [{t:'Muscle rigidity',c:true},{t:'Fever',c:true},{t:'Altered consciousness',c:true},{t:'Hypotension',c:false}], subj: 'Psych' },
      { q: 'De-escalation techniques: (Select all that apply)', opts: [{t:'Calm tone',c:true},{t:'Personal space',c:true},{t:'Listen',c:true},{t:'Confront aggressively',c:false}], subj: 'Psych' },
      { q: 'Self-harm assessment: (Select all that apply)', opts: [{t:'Intent',c:true},{t:'Plan',c:true},{t:'Means',c:true},{t:'Ignore it',c:false}], subj: 'Psych' },
      { q: 'Antibiotic classes: (Select all that apply)', opts: [{t:'Penicillins',c:true},{t:'Cephalosporins',c:true},{t:'Fluoroquinolones',c:true},{t:'Antivirals for bacteria',c:false}], subj: 'Pharmacology' },
      { q: 'Penicillin allergy cross-reactivity: (Select all that apply)', opts: [{t:'Cephalosporins',c:true},{t:'Carbapenems',c:true},{t:'Assess severity',c:true},{t:'Always safe',c:false}], subj: 'Pharmacology' },
      { q: 'Aminoglycoside monitoring: (Select all that apply)', opts: [{t:'Peak and trough',c:true},{t:'Renal function',c:true},{t:'Hearing',c:true},{t:'Vision only',c:false}], subj: 'Pharmacology' },
      { q: 'Fluoroquinolone precautions: (Select all that apply)', opts: [{t:'Tendon rupture risk',c:true},{t:'QT prolongation',c:true},{t:'Photosensitivity',c:true},{t:'No precautions',c:false}], subj: 'Pharmacology' },
      { q: 'Metronidazole interactions: (Select all that apply)', opts: [{t:'Avoid alcohol',c:true},{t:'Disulfiram reaction',c:true},{t:'Warfarin',c:true},{t:'No interactions',c:false}], subj: 'Pharmacology' },
      { q: 'Antifungal monitoring: (Select all that apply)', opts: [{t:'Liver function',c:true},{t:'Drug interactions',c:true},{t:'QT prolongation',c:true},{t:'No monitoring',c:false}], subj: 'Pharmacology' },
      { q: 'Antiviral considerations: (Select all that apply)', opts: [{t:'Renal dosing',c:true},{t:'Drug interactions',c:true},{t:'Timing of doses',c:true},{t:'Cure all viruses',c:false}], subj: 'Pharmacology' },
      { q: 'Corticosteroid tapering: (Select all that apply)', opts: [{t:'Gradual reduction',c:true},{t:'Prevent adrenal insufficiency',c:true},{t:'Monitor for relapse',c:true},{t:'Stop abruptly',c:false}], subj: 'Pharmacology' },
      { q: 'Antiplatelet agents: (Select all that apply)', opts: [{t:'Aspirin',c:true},{t:'Clopidogrel',c:true},{t:'Ticagrelor',c:true},{t:'Warfarin',c:false}], subj: 'Pharmacology' },
      { q: 'Direct oral anticoagulants: (Select all that apply)', opts: [{t:'Rivaroxaban',c:true},{t:'Apixaban',c:true},{t:'Dabigatran',c:true},{t:'Heparin',c:false}], subj: 'Pharmacology' },
      { q: 'Heparin-induced thrombocytopenia: (Select all that apply)', opts: [{t:'Monitor platelet count',c:true},{t:'Stop heparin',c:true},{t:'Alternative anticoagulant',c:true},{t:'Continue heparin',c:false}], subj: 'Pharmacology' },
      { q: 'Nitroglycerin teaching: (Select all that apply)', opts: [{t:'Sit when taking',c:true},{t:'Store properly',c:true},{t:'Replace regularly',c:true},{t:'Take with Viagra',c:false}], subj: 'Pharmacology' },
      { q: 'Calcium channel blocker types: (Select all that apply)', opts: [{t:'Dihydropyridines',c:true},{t:'Non-dihydropyridines',c:true},{t:'Different effects',c:true},{t:'All identical',c:false}], subj: 'Pharmacology' },
      { q: 'Potassium-sparing diuretics: (Select all that apply)', opts: [{t:'Spironolactone',c:true},{t:'Amiloride',c:true},{t:'Risk of hyperkalemia',c:true},{t:'Cause hypokalemia',c:false}], subj: 'Pharmacology' },
      { q: 'Thiazide diuretic considerations: (Select all that apply)', opts: [{t:'Hypokalemia risk',c:true},{t:'Hyperglycemia',c:true},{t:'Photosensitivity',c:true},{t:'Hyperkalemia',c:false}], subj: 'Pharmacology' },
      { q: 'Proton pump inhibitor timing: (Select all that apply)', opts: [{t:'Before breakfast',c:true},{t:'On empty stomach',c:true},{t:'30 min before meal',c:true},{t:'With all meals',c:false}], subj: 'Pharmacology' },
      { q: 'H2 blocker uses: (Select all that apply)', opts: [{t:'GERD',c:true},{t:'Ulcers',c:true},{t:'Stress ulcer prophylaxis',c:true},{t:'Hypertension',c:false}], subj: 'Pharmacology' },
      { q: 'Antiemetic classes: (Select all that apply)', opts: [{t:'5-HT3 antagonists',c:true},{t:'Dopamine antagonists',c:true},{t:'Anticholinergics',c:true},{t:'Opioids',c:false}], subj: 'Pharmacology' },
      { q: 'Laxative types: (Select all that apply)', opts: [{t:'Bulk-forming',c:true},{t:'Stimulant',c:true},{t:'Osmotic',c:true},{t:'Antidiarrheal',c:false}], subj: 'Pharmacology' },
      { q: 'Insulin types by onset: (Select all that apply)', opts: [{t:'Rapid-acting',c:true},{t:'Short-acting',c:true},{t:'Long-acting',c:true},{t:'Medium only',c:false}], subj: 'Pharmacology' },
      { q: 'Sulfonylurea risks: (Select all that apply)', opts: [{t:'Hypoglycemia',c:true},{t:'Weight gain',c:true},{t:'Cardiac caution',c:true},{t:'Hyperglycemia only',c:false}], subj: 'Pharmacology' },
      { q: 'GLP-1 agonist benefits: (Select all that apply)', opts: [{t:'Weight loss',c:true},{t:'Cardiovascular protection',c:true},{t:'Once weekly options',c:true},{t:'Weight gain',c:false}], subj: 'Pharmacology' },
      { q: 'SGLT2 inhibitor effects: (Select all that apply)', opts: [{t:'Glucosuria',c:true},{t:'Cardiorenal benefits',c:true},{t:'UTI risk',c:true},{t:'Retention',c:false}], subj: 'Pharmacology' },
      { q: 'Bisphosphonate administration: (Select all that apply)', opts: [{t:'Upright 30 min',c:true},{t:'With water',c:true},{t:'Empty stomach',c:true},{t:'With food',c:false}], subj: 'Pharmacology' },
      { q: 'Levothyroxine administration: (Select all that apply)', opts: [{t:'Empty stomach',c:true},{t:'Same time daily',c:true},{t:'Avoid calcium',c:true},{t:'With meals',c:false}], subj: 'Pharmacology' },
      { q: 'Immunosuppressant monitoring: (Select all that apply)', opts: [{t:'Drug levels',c:true},{t:'Infection signs',c:true},{t:'Renal function',c:true},{t:'No monitoring',c:false}], subj: 'Pharmacology' },
      { q: 'Chemotherapy extravasation: (Select all that apply)', opts: [{t:'Stop infusion',c:true},{t:'Aspirate',c:true},{t:'Notify provider',c:true},{t:'Continue infusion',c:false}], subj: 'Pharmacology' },
      { q: 'Biologic drug considerations: (Select all that apply)', opts: [{t:'Infusion reactions',c:true},{t:'Infection risk',c:true},{t:'Immunosuppression',c:true},{t:'No side effects',c:false}], subj: 'Pharmacology' },
      { q: 'Drug-food interactions: (Select all that apply)', opts: [{t:'Grapefruit',c:true},{t:'Tyramine',c:true},{t:'Vitamin K',c:true},{t:'All foods safe',c:false}], subj: 'Pharmacology' },
      { q: 'Polypharmacy risks: (Select all that apply)', opts: [{t:'Drug interactions',c:true},{t:'Adherence issues',c:true},{t:'Adverse effects',c:true},{t:'Better outcomes',c:false}], subj: 'Pharmacology' },
      { q: 'Medication adherence barriers: (Select all that apply)', opts: [{t:'Cost',c:true},{t:'Complex regimen',c:true},{t:'Side effects',c:true},{t:'Too easy',c:false}], subj: 'Pharmacology' },
      { q: 'Safe medication storage: (Select all that apply)', opts: [{t:'Light protection',c:true},{t:'Temperature',c:true},{t:'Out of reach',c:true},{t:'Anywhere',c:false}], subj: 'Fundamentals' },
      { q: 'High-alert medications: (Select all that apply)', opts: [{t:'Insulin',c:true},{t:'Heparin',c:true},{t:'Opioids',c:true},{t:'Antacids',c:false}], subj: 'Pharmacology' },
      { q: 'Look-alike sound-alike drugs: (Select all that apply)', opts: [{t:'Confirm before giving',c:true},{t:'Tall man lettering',c:true},{t:'Double-check',c:true},{t:'Assume correct',c:false}], subj: 'Fundamentals' },
      { q: 'Drugs requiring therapeutic level monitoring: (Select all that apply)', opts: [{t:'Digoxin',c:true},{t:'Lithium',c:true},{t:'Phenytoin',c:true},{t:'Aspirin',c:false}], subj: 'Pharmacology' },
      { q: 'Anticoagulant reversal agents: (Select all that apply)', opts: [{t:'Vitamin K for warfarin',c:true},{t:'Protamine for heparin',c:true},{t:'Idarucizumab for dabigatran',c:true},{t:'Naloxone for heparin',c:false}], subj: 'Pharmacology' },
      { q: 'Black box warnings to monitor: (Select all that apply)', opts: [{t:'SSRI suicide risk in young adults',c:true},{t:'Clozapine agranulocytosis',c:true},{t:'Metformin lactic acidosis',c:true},{t:'Acetaminophen overdose',c:false}], subj: 'Pharmacology' },
      { q: 'Drugs that require baseline liver function: (Select all that apply)', opts: [{t:'Statins',c:true},{t:'Acetaminophen',c:true},{t:'Isoniazid',c:true},{t:'Sugar tablets',c:false}], subj: 'Pharmacology' },
      { q: 'QT prolongation risk drugs: (Select all that apply)', opts: [{t:'Fluoroquinolones',c:true},{t:'Macrolides',c:true},{t:'Antipsychotics',c:true},{t:'PPIs',c:false}], subj: 'Pharmacology' },
      { q: 'Nephrotoxic drugs: (Select all that apply)', opts: [{t:'Aminoglycosides',c:true},{t:'NSAIDs',c:true},{t:'Contrast dye',c:true},{t:'Vitamin C',c:false}], subj: 'Pharmacology' },
      { q: 'Ototoxic medications: (Select all that apply)', opts: [{t:'Aminoglycosides',c:true},{t:'Loop diuretics',c:true},{t:'Aspirin high dose',c:true},{t:'Metformin',c:false}], subj: 'Pharmacology' },
      { q: 'Antihypertensive drug classes: (Select all that apply)', opts: [{t:'ACE inhibitors',c:true},{t:'ARBs',c:true},{t:'Calcium channel blockers',c:true},{t:'Antibiotics',c:false}], subj: 'Pharmacology' },
      { q: 'Antiplatelet therapy uses: (Select all that apply)', opts: [{t:'Post-MI',c:true},{t:'Post-stent',c:true},{t:'Stroke prevention',c:true},{t:'Hypertension only',c:false}], subj: 'Pharmacology' },
      { q: 'Warfarin drug interactions: (Select all that apply)', opts: [{t:'NSAIDs',c:true},{t:'Antibiotics',c:true},{t:'Vitamin K-rich foods',c:true},{t:'No interactions',c:false}], subj: 'Pharmacology' },
      { q: 'Insulin administration considerations: (Select all that apply)', opts: [{t:'Rotate sites',c:true},{t:'Check expiration',c:true},{t:'Meal timing',c:true},{t:'Give IM',c:false}], subj: 'Pharmacology' },
      { q: 'Opioid equianalgesic dosing: (Select all that apply)', opts: [{t:'Convert when switching',c:true},{t:'Consider incomplete cross-tolerance',c:true},{t:'Reduce dose for elderly',c:true},{t:'Double dose when switching',c:false}], subj: 'Pharmacology' },
      { q: 'Benzodiazepine use concerns: (Select all that apply)', opts: [{t:'Dependence risk',c:true},{t:'Fall risk in elderly',c:true},{t:'Respiratory depression with opioids',c:true},{t:'No concerns',c:false}], subj: 'Pharmacology' },
      { q: 'SSRI drug interactions: (Select all that apply)', opts: [{t:'MAOIs contraindicated',c:true},{t:'Serotonin syndrome risk',c:true},{t:'Bleeding with anticoagulants',c:true},{t:'Safe with all drugs',c:false}], subj: 'Pharmacology' },
      { q: 'Proton pump inhibitor interactions: (Select all that apply)', opts: [{t:'Decrease clopidogrel effect',c:true},{t:'Reduce absorption of some drugs',c:true},{t:'Take before meals',c:true},{t:'No interactions',c:false}], subj: 'Pharmacology' },
      { q: 'Corticosteroid tapering reasons: (Select all that apply)', opts: [{t:'Prevent adrenal insufficiency',c:true},{t:'Avoid rebound inflammation',c:true},{t:'Minimize withdrawal',c:true},{t:'No need to taper',c:false}], subj: 'Pharmacology' },
      { q: 'Chemotherapy extravasation management: (Select all that apply)', opts: [{t:'Stop infusion',c:true},{t:'Aspirate if possible',c:true},{t:'Notify provider',c:true},{t:'Continue infusion',c:false}], subj: 'Pharmacology' },
      { q: 'Drugs that affect potassium: (Select all that apply)', opts: [{t:'ACE inhibitors increase K',c:true},{t:'Loop diuretics decrease K',c:true},{t:'Spironolactone increases K',c:true},{t:'Metformin affects K',c:false}], subj: 'Pharmacology' },
      { q: 'Reye syndrome risk drugs: (Select all that apply)', opts: [{t:'Aspirin in children with viral illness',c:true},{t:'Avoid in varicella',c:true},{t:'Avoid in flu',c:true},{t:'Acetaminophen',c:false}], subj: 'Pharmacology' },
      { q: 'Phenytoin considerations: (Select all that apply)', opts: [{t:'Narrow therapeutic range',c:true},{t:'Gingival hyperplasia',c:true},{t:'Monitor free level',c:true},{t:'No monitoring needed',c:false}], subj: 'Pharmacology' },
      { q: 'Digoxin drug interactions: (Select all that apply)', opts: [{t:'Amiodarone increases levels',c:true},{t:'Diuretics cause hypokalemia',c:true},{t:'Quinidine increases levels',c:true},{t:'No interactions',c:false}], subj: 'Pharmacology' },
      { q: 'Metformin contraindications: (Select all that apply)', opts: [{t:'Severe renal impairment',c:true},{t:'Contrast procedures',c:true},{t:'Metabolic acidosis',c:true},{t:'Mild hyperglycemia',c:false}], subj: 'Pharmacology' },
      { q: 'Lipid-lowering agents: (Select all that apply)', opts: [{t:'Statins',c:true},{t:'Ezetimibe',c:true},{t:'PCSK9 inhibitors',c:true},{t:'Insulin',c:false}], subj: 'Pharmacology' },
      { q: 'Drugs requiring empty stomach: (Select all that apply)', opts: [{t:'Levothyroxine',c:true},{t:'Bisphosphonates',c:true},{t:'Tetracycline',c:true},{t:'Metformin XR',c:false}], subj: 'Pharmacology' },
      { q: 'Medications causing photosensitivity: (Select all that apply)', opts: [{t:'Tetracycline',c:true},{t:'Sulfonamides',c:true},{t:'NSAIDs',c:true},{t:'Metformin',c:false}], subj: 'Pharmacology' },
      { q: 'Signs of infection at IV site: (Select all that apply)', opts: [{t:'Redness',c:true},{t:'Warmth',c:true},{t:'Swelling',c:true},{t:'Coolness',c:false}], subj: 'Fundamentals' },
      { q: 'Components of Glasgow Coma Scale: (Select all that apply)', opts: [{t:'Eye opening',c:true},{t:'Verbal response',c:true},{t:'Motor response',c:true},{t:'Pupil size',c:false}], subj: 'Fundamentals' },
      { q: 'Risk factors for DVT: (Select all that apply)', opts: [{t:'Immobility',c:true},{t:'Surgery',c:true},{t:'Oral contraceptives',c:true},{t:'Exercise',c:false}], subj: 'Med-Surg' },
      { q: 'Signs of digoxin toxicity: (Select all that apply)', opts: [{t:'Nausea',c:true},{t:'Visual disturbances',c:true},{t:'Bradycardia',c:true},{t:'Hypertension',c:false}], subj: 'Pharmacology' },
      { q: 'Anticholinergic side effects: (Select all that apply)', opts: [{t:'Dry mouth',c:true},{t:'Blurred vision',c:true},{t:'Urinary retention',c:true},{t:'Diarrhea',c:false}], subj: 'Pharmacology' },
      { q: 'Mood stabilizers include: (Select all that apply)', opts: [{t:'Lithium',c:true},{t:'Valproic acid',c:true},{t:'Lamotrigine',c:true},{t:'Lorazepam only',c:false}], subj: 'Psych' },
      { q: 'Signs of opioid overdose: (Select all that apply)', opts: [{t:'Respiratory depression',c:true},{t:'Pinpoint pupils',c:true},{t:'Unresponsiveness',c:true},{t:'Hypertension',c:false}], subj: 'Pharmacology' },
      { q: 'Nursing interventions for fever: (Select all that apply)', opts: [{t:'Antipyretics',c:true},{t:'Cool compress',c:true},{t:'Hydration',c:true},{t:'Heavy blankets',c:false}], subj: 'Fundamentals' },
      { q: 'MI cardiac markers: (Select all that apply)', opts: [{t:'Troponin',c:true},{t:'CK-MB',c:true},{t:'Myoglobin',c:true},{t:'Hemoglobin',c:false}], subj: 'Med-Surg' },
      { q: 'Pre-op NPO guidelines typically include: (Select all that apply)', opts: [{t:'No solid food 6-8 hours',c:true},{t:'Clear liquids 2 hours',c:true},{t:'Hold certain meds',c:true},{t:'Eat normally',c:false}], subj: 'Fundamentals' },
      { q: 'Chronic kidney disease diet restrictions: (Select all that apply)', opts: [{t:'Potassium',c:true},{t:'Phosphorus',c:true},{t:'Fluid',c:true},{t:'Unlimited sodium',c:false}], subj: 'Med-Surg' },
      { q: 'Factors affecting drug absorption: (Select all that apply)', opts: [{t:'Route',c:true},{t:'Food',c:true},{t:'GI motility',c:true},{t:'Patient name',c:false}], subj: 'Pharmacology' },
      { q: 'Benzodiazepine side effects: (Select all that apply)', opts: [{t:'Sedation',c:true},{t:'Dependence',c:true},{t:'Respiratory depression',c:true},{t:'Hypertension',c:false}], subj: 'Pharmacology' },
      { q: 'Symptoms requiring immediate intervention: (Select all that apply)', opts: [{t:'Chest pain',c:true},{t:'Difficulty breathing',c:true},{t:'Altered mental status',c:true},{t:'Mild headache',c:false}], subj: 'Fundamentals' },
      { q: 'Blood transfusion reaction signs: (Select all that apply)', opts: [{t:'Fever',c:true},{t:'Chills',c:true},{t:'Back pain',c:true},{t:'Improved energy',c:false}], subj: 'Med-Surg' },
      { q: 'Wound healing phases: (Select all that apply)', opts: [{t:'Inflammatory',c:true},{t:'Proliferative',c:true},{t:'Remodeling',c:true},{t:'Regression',c:false}], subj: 'Fundamentals' },
      { q: 'Parkinson\'s medications: (Select all that apply)', opts: [{t:'Levodopa',c:true},{t:'Carbidopa',c:true},{t:'Dopamine agonists',c:true},{t:'Insulin',c:false}], subj: 'Pharmacology' },
      { q: 'Geriatric considerations for medications: (Select all that apply)', opts: [{t:'Reduced metabolism',c:true},{t:'Polypharmacy risk',c:true},{t:'Start low go slow',c:true},{t:'Higher doses always',c:false}], subj: 'Pharmacology' },
      { q: 'Elements of therapeutic communication: (Select all that apply)', opts: [{t:'Active listening',c:true},{t:'Empathy',c:true},{t:'Silence',c:true},{t:'Giving advice',c:false}], subj: 'Psych' },
      { q: 'UTI manifestations: (Select all that apply)', opts: [{t:'Dysuria',c:true},{t:'Frequency',c:true},{t:'Suprapubic pain',c:true},{t:'Chest pain',c:false}], subj: 'Med-Surg' },
      { q: 'Acute kidney injury causes: (Select all that apply)', opts: [{t:'Hypovolemia',c:true},{t:'Nephrotoxic drugs',c:true},{t:'Sepsis',c:true},{t:'Exercise',c:false}], subj: 'Med-Surg' },
      { q: 'Heart failure signs: (Select all that apply)', opts: [{t:'JVD',c:true},{t:'Crackles',c:true},{t:'Edema',c:true},{t:'Dry skin',c:false}], subj: 'Med-Surg' },
      { q: 'Liver failure manifestations: (Select all that apply)', opts: [{t:'Jaundice',c:true},{t:'Ascites',c:true},{t:'Coagulopathy',c:true},{t:'Polyuria',c:false}], subj: 'Med-Surg' },
      { q: 'Nursing interventions for nausea: (Select all that apply)', opts: [{t:'Small frequent meals',c:true},{t:'Avoid strong odors',c:true},{t:'Antiemetics',c:true},{t:'Large meals',c:false}], subj: 'Fundamentals' },
      { q: 'Signs of wound infection: (Select all that apply)', opts: [{t:'Purulent drainage',c:true},{t:'Erythema',c:true},{t:'Fever',c:true},{t:'Healing',c:false}], subj: 'Fundamentals' },
      { q: 'Defense mechanisms: (Select all that apply)', opts: [{t:'Denial',c:true},{t:'Projection',c:true},{t:'Rationalization',c:true},{t:'Honesty',c:false}], subj: 'Psych' },
      { q: 'Eating disorder interventions: (Select all that apply)', opts: [{t:'Monitor meals',c:true},{t:'Weigh regularly',c:true},{t:'Therapy',c:true},{t:'Ignore behaviors',c:false}], subj: 'Psych' },
      { q: 'Bronchodilator teaching: (Select all that apply)', opts: [{t:'Rinse mouth after inhaler',c:true},{t:'Prime before first use',c:true},{t:'Report palpitations',c:true},{t:'Use expired inhaler',c:false}], subj: 'Pharmacology' },
      { q: 'Warfarin patient teaching: (Select all that apply)', opts: [{t:'Consistent vitamin K intake',c:true},{t:'Report bleeding',c:true},{t:'Avoid NSAIDs',c:true},{t:'Double dose if missed',c:false}], subj: 'Pharmacology' },
      { q: 'Insulin storage: (Select all that apply)', opts: [{t:'Refrigerate unopened',c:true},{t:'Room temp for open vial',c:true},{t:'Avoid freezing',c:true},{t:'Keep in sun',c:false}], subj: 'Pharmacology' },
      { q: 'Vital signs include: (Select all that apply)', opts: [{t:'Temperature',c:true},{t:'Pulse',c:true},{t:'Blood pressure',c:true},{t:'Weight',c:false}], subj: 'Fundamentals' },
      { q: 'Safe patient handling principles: (Select all that apply)', opts: [{t:'Use assistive devices',c:true},{t:'Get help when needed',c:true},{t:'Use proper body mechanics',c:true},{t:'Lift alone',c:false}], subj: 'Fundamentals' },
      { q: 'Discharge planning components: (Select all that apply)', opts: [{t:'Medication reconciliation',c:true},{t:'Follow-up appointments',c:true},{t:'Patient teaching',c:true},{t:'Skip teaching',c:false}], subj: 'Fundamentals' },
      { q: 'Barriers to effective communication: (Select all that apply)', opts: [{t:'Language',c:true},{t:'Hearing impairment',c:true},{t:'Cognitive deficits',c:true},{t:'Clear speech',c:false}], subj: 'Fundamentals' },
      { q: 'Components of a nursing care plan: (Select all that apply)', opts: [{t:'Nursing diagnosis',c:true},{t:'Goals',c:true},{t:'Interventions',c:true},{t:'Physician orders only',c:false}], subj: 'Fundamentals' },
      { q: 'Factors that affect blood pressure: (Select all that apply)', opts: [{t:'Stress',c:true},{t:'Pain',c:true},{t:'Caffeine',c:true},{t:'Time of day only',c:false}], subj: 'Fundamentals' },
      { q: 'Principles of aseptic technique: (Select all that apply)', opts: [{t:'Sterile field remains sterile',c:true},{t:'1 inch border unsterile',c:true},{t:'Keep sterile above waist',c:true},{t:'Reuse contaminated items',c:false}], subj: 'Fundamentals' },
      { q: 'Skin assessment findings: (Select all that apply)', opts: [{t:'Color',c:true},{t:'Temperature',c:true},{t:'Moisture',c:true},{t:'Patient mood',c:false}], subj: 'Fundamentals' },
      { q: 'Post-operative assessment priorities: (Select all that apply)', opts: [{t:'Airway',c:true},{t:'Vital signs',c:true},{t:'Surgical site',c:true},{t:'Discharge papers',c:false}], subj: 'Med-Surg' },
      { q: 'Asthma management includes: (Select all that apply)', opts: [{t:'Avoid triggers',c:true},{t:'Controller medications',c:true},{t:'Rescue inhaler',c:true},{t:'High-flow oxygen',c:false}], subj: 'Med-Surg' },
      { q: 'Diabetes foot care teaching: (Select all that apply)', opts: [{t:'Daily inspection',c:true},{t:'Proper footwear',c:true},{t:'Avoid going barefoot',c:true},{t:'Soak feet daily',c:false}], subj: 'Med-Surg' },
      { q: 'Signs of dehydration: (Select all that apply)', opts: [{t:'Poor skin turgor',c:true},{t:'Dry mucous membranes',c:true},{t:'Decreased urine output',c:true},{t:'Edema',c:false}], subj: 'Med-Surg' },
      { q: 'Risk factors for stroke: (Select all that apply)', opts: [{t:'Hypertension',c:true},{t:'Atrial fibrillation',c:true},{t:'Smoking',c:true},{t:'Exercise',c:false}], subj: 'Med-Surg' },
      { q: 'Pneumonia manifestations: (Select all that apply)', opts: [{t:'Fever',c:true},{t:'Cough',c:true},{t:'Crackles',c:true},{t:'Bradycardia',c:false}], subj: 'Med-Surg' },
      { q: 'Prevention of surgical site infection: (Select all that apply)', opts: [{t:'Pre-op shower',c:true},{t:'Prophylactic antibiotics',c:true},{t:'Aseptic technique',c:true},{t:'Skip handwashing',c:false}], subj: 'Med-Surg' },
      { q: 'Manifestations of hypothyroidism: (Select all that apply)', opts: [{t:'Fatigue',c:true},{t:'Weight gain',c:true},{t:'Cold intolerance',c:true},{t:'Weight loss',c:false}], subj: 'Med-Surg' },
      { q: 'Hyperthyroidism signs: (Select all that apply)', opts: [{t:'Weight loss',c:true},{t:'Tachycardia',c:true},{t:'Heat intolerance',c:true},{t:'Hypothermia',c:false}], subj: 'Med-Surg' },
      { q: 'Schizophrenia positive symptoms: (Select all that apply)', opts: [{t:'Hallucinations',c:true},{t:'Delusions',c:true},{t:'Disorganized speech',c:true},{t:'Flat affect',c:false}], subj: 'Psych' },
      { q: 'Non-therapeutic communication: (Select all that apply)', opts: [{t:'Giving advice',c:true},{t:'False reassurance',c:true},{t:'Changing subject',c:true},{t:'Active listening',c:false}], subj: 'Psych' },
      { q: 'Bipolar disorder phases: (Select all that apply)', opts: [{t:'Mania',c:true},{t:'Depression',c:true},{t:'Hypomania',c:true},{t:'Schizophrenia',c:false}], subj: 'Psych' },
      { q: 'Anxiety disorder types: (Select all that apply)', opts: [{t:'GAD',c:true},{t:'Panic disorder',c:true},{t:'PTSD',c:true},{t:'Schizophrenia',c:false}], subj: 'Psych' },
      { q: 'Milieu therapy components: (Select all that apply)', opts: [{t:'Safe environment',c:true},{t:'Structure',c:true},{t:'Therapeutic activities',c:true},{t:'Punishment',c:false}], subj: 'Psych' },
      { q: 'Crisis intervention steps: (Select all that apply)', opts: [{t:'Assess safety',c:true},{t:'Listen',c:true},{t:'Identify coping',c:true},{t:'Minimize feelings',c:false}], subj: 'Psych' },
      { q: 'Antidepressant classes: (Select all that apply)', opts: [{t:'SSRI',c:true},{t:'SNRI',c:true},{t:'MAOI',c:true},{t:'Opioids',c:false}], subj: 'Pharmacology' },
      { q: 'Drugs requiring peak and trough: (Select all that apply)', opts: [{t:'Vancomycin',c:true},{t:'Aminoglycosides',c:true},{t:'Gentamicin',c:true},{t:'Metformin',c:false}], subj: 'Pharmacology' },
      { q: 'ACE inhibitor drug names end in: (Select all that apply)', opts: [{t:'-pril',c:true},{t:'Lisinopril',c:true},{t:'Enalapril',c:true},{t:'-olol',c:false}], subj: 'Pharmacology' },
      { q: 'Anticoagulant monitoring: (Select all that apply)', opts: [{t:'INR for warfarin',c:true},{t:'aPTT for heparin',c:true},{t:'Platelets for HIT',c:true},{t:'Glucose',c:false}], subj: 'Pharmacology' },
      { q: 'Digoxin teaching: (Select all that apply)', opts: [{t:'Take pulse daily',c:true},{t:'Report vision changes',c:true},{t:'Know signs of toxicity',c:true},{t:'Double if missed',c:false}], subj: 'Pharmacology' },
      { q: 'Corticosteroid side effects: (Select all that apply)', opts: [{t:'Hyperglycemia',c:true},{t:'Immunosuppression',c:true},{t:'Fluid retention',c:true},{t:'Hypotension',c:false}], subj: 'Pharmacology' },
      { q: 'Antibiotic resistance prevention: (Select all that apply)', opts: [{t:'Complete full course',c:true},{t:'Narrow spectrum when possible',c:true},{t:'Culture before treat',c:true},{t:'Use for viruses',c:false}], subj: 'Pharmacology' },
      { q: 'Beta-blocker drug names: (Select all that apply)', opts: [{t:'Metoprolol',c:true},{t:'Atenolol',c:true},{t:'Propranolol',c:true},{t:'Lisinopril',c:false}], subj: 'Pharmacology' },
      { q: 'Calcium channel blockers include: (Select all that apply)', opts: [{t:'Amlodipine',c:true},{t:'Nifedipine',c:true},{t:'Diltiazem',c:true},{t:'Metformin',c:false}], subj: 'Pharmacology' },
      { q: 'Statins can cause: (Select all that apply)', opts: [{t:'Myopathy',c:true},{t:'Elevated liver enzymes',c:true},{t:'Rhabdomyolysis',c:true},{t:'Hyperglycemia only',c:false}], subj: 'Pharmacology' },
      { q: 'Metformin contraindications: (Select all that apply)', opts: [{t:'Severe renal impairment',c:true},{t:'Contrast dye procedures',c:true},{t:'Metabolic acidosis',c:true},{t:'Mild obesity',c:false}], subj: 'Pharmacology' },
      { q: 'Opioid adverse effects: (Select all that apply)', opts: [{t:'Constipation',c:true},{t:'Respiratory depression',c:true},{t:'Sedation',c:true},{t:'Hypertension',c:false}], subj: 'Pharmacology' },
      { q: 'Penicillin allergy considerations: (Select all that apply)', opts: [{t:'Assess severity',c:true},{t:'Cephalosporin cross-reactivity',c:true},{t:'Document reaction',c:true},{t:'Always safe to give',c:false}], subj: 'Pharmacology' },
      { q: 'Vancomycin administration: (Select all that apply)', opts: [{t:'Infuse slowly',c:true},{t:'Monitor for red man syndrome',c:true},{t:'Draw trough before dose',c:true},{t:'Give rapid IV push',c:false}], subj: 'Pharmacology' },
      { q: 'Lithium toxicity factors: (Select all that apply)', opts: [{t:'Dehydration',c:true},{t:'NSAIDs',c:true},{t:'Diuretics',c:true},{t:'Fluid intake',c:false}], subj: 'Pharmacology' },
      { q: 'Phenytoin considerations: (Select all that apply)', opts: [{t:'Narrow therapeutic range',c:true},{t:'Gingival hyperplasia',c:true},{t:'Monitor free level',c:true},{t:'No interactions',c:false}], subj: 'Pharmacology' },
      { q: 'Proton pump inhibitors include: (Select all that apply)', opts: [{t:'Omeprazole',c:true},{t:'Pantoprazole',c:true},{t:'Esomeprazole',c:true},{t:'Ranitidine',c:false}], subj: 'Pharmacology' },
      { q: 'Drugs that prolong QT interval: (Select all that apply)', opts: [{t:'Fluoroquinolones',c:true},{t:'Macrolides',c:true},{t:'Some antipsychotics',c:true},{t:'PPIs',c:false}], subj: 'Pharmacology' },
      { q: 'Direct oral anticoagulant names: (Select all that apply)', opts: [{t:'Rivaroxaban',c:true},{t:'Apixaban',c:true},{t:'Edoxaban',c:true},{t:'Warfarin',c:false}], subj: 'Pharmacology' },
      { q: 'Nephrotoxic medications: (Select all that apply)', opts: [{t:'Aminoglycosides',c:true},{t:'NSAIDs',c:true},{t:'Contrast dye',c:true},{t:'Vitamin C',c:false}], subj: 'Pharmacology' },
      { q: 'Hepatotoxic drugs: (Select all that apply)', opts: [{t:'Acetaminophen',c:true},{t:'Isoniazid',c:true},{t:'Statins',c:true},{t:'Glucose',c:false}], subj: 'Pharmacology' },
      { q: 'Anticholinergic side effects: (Select all that apply)', opts: [{t:'Dry mouth',c:true},{t:'Blurred vision',c:true},{t:'Urinary retention',c:true},{t:'Salivation',c:false}], subj: 'Pharmacology' },
      { q: 'Insulin types by duration: (Select all that apply)', opts: [{t:'Rapid-acting',c:true},{t:'Long-acting',c:true},{t:'Intermediate-acting',c:true},{t:'Antibiotic',c:false}], subj: 'Pharmacology' },
      { q: 'SSRI common side effects: (Select all that apply)', opts: [{t:'Nausea',c:true},{t:'Sexual dysfunction',c:true},{t:'Insomnia',c:true},{t:'Hypertension',c:false}], subj: 'Pharmacology' },
      { q: 'Antiemetic drug classes: (Select all that apply)', opts: [{t:'5-HT3 antagonists',c:true},{t:'Dopamine antagonists',c:true},{t:'Antihistamines',c:true},{t:'Opioids',c:false}], subj: 'Pharmacology' },
      { q: 'Bisphosphonate administration requirements: (Select all that apply)', opts: [{t:'Upright 30 min',c:true},{t:'Full glass of water',c:true},{t:'Empty stomach',c:true},{t:'With meals',c:false}], subj: 'Pharmacology' },
      { q: 'Drugs requiring therapeutic drug monitoring: (Select all that apply)', opts: [{t:'Digoxin',c:true},{t:'Phenytoin',c:true},{t:'Gentamicin',c:true},{t:'Aspirin',c:false}], subj: 'Pharmacology' },
    ];

    function shuffleArr(arr) { const a = [...arr]; for (let i = a.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [a[i], a[j]] = [a[j], a[i]]; } return a; }
    function normalizeAnswer(s) { return (s||'').toLowerCase().trim().replace(/\s+/g,' ').replace(/[-‚Äì]/g,'-'); }
    function matchAnswer(given, correct) {
      const g = normalizeAnswer(given); const c = normalizeAnswer(correct);
      if (g === c) return true;
      const cParts = c.split('/').map(x=>x.trim()); return cParts.some(p => normalizeAnswer(p) === g);
    }

    const mtConfig = document.getElementById('minitest-config');
    const mtExamWrap = document.getElementById('minitest-exam-wrap');
    const mtResults = document.getElementById('minitest-results');
    const mtQuestionArea = document.getElementById('minitest-question-area');
    const mtTotalSpan = document.getElementById('minitest-total');
    const mtError = document.getElementById('minitest-error');
    let mtState = null;

    function updateMTTotal() {
      const total = [document.getElementById('mt-mc'),document.getElementById('mt-id'),document.getElementById('mt-tf'),document.getElementById('mt-fib'),document.getElementById('mt-sata')]
        .reduce((s,el)=> s + (parseInt(el?.value)||0), 0);
      if (mtTotalSpan) mtTotalSpan.textContent = 'Total: ' + total + ' items';
      if (mtError) mtError.classList.toggle('hidden', total === 50);
    }
    ['mt-mc','mt-id','mt-tf','mt-fib','mt-sata'].forEach(id => document.getElementById(id)?.addEventListener('input', updateMTTotal));

    document.getElementById('minitest-start')?.addEventListener('click', () => {
      const topics = [...document.querySelectorAll('input[name="minitest-topic"]:checked')].map(c=>c.value);
      if (topics.length === 0) { mtError.textContent = 'Please select at least 1 topic.'; mtError.classList.remove('hidden'); return; }
      const mc = parseInt(document.getElementById('mt-mc')?.value) || 0;
      const id = parseInt(document.getElementById('mt-id')?.value) || 0;
      const tf = parseInt(document.getElementById('mt-tf')?.value) || 0;
      const fib = parseInt(document.getElementById('mt-fib')?.value) || 0;
      const sata = parseInt(document.getElementById('mt-sata')?.value) || 0;
      const total = mc + id + tf + fib + sata;
      if (total !== 50) { mtError.textContent = 'Total must equal 50. Please adjust the counts.'; mtError.classList.remove('hidden'); return; }
      mtError.classList.add('hidden');

      const mcPool = QUIZ_QUESTIONS.filter(q=> topics.includes(q.subj||'Fundamentals')).map(q=>({type:'mc',q:q.q,opts:q.opts,a:q.a,subj:q.subj}));
      const idPool = MT_ID.filter(q=>topics.includes(q.subj));
      const tfPool = MT_TF.filter(q=>topics.includes(q.subj));
      const fibPool = MT_FIB.filter(q=>topics.includes(q.subj));
      const sataPool = MT_SATA.filter(q=>topics.includes(q.subj));

      const pick = (pool, n) => shuffleArr([...pool]).slice(0, Math.min(n, pool.length));
      const mcQs = pick(mcPool, mc);
      const idQs = pick(idPool, id).map(q=>({...q,type:'id'}));
      const tfQs = pick(tfPool, tf).map(q=>({...q,type:'tf'}));
      const fibQs = pick(fibPool, fib).map(q=>({...q,type:'fib'}));
      const sataQs = pick(sataPool, sata).map(q=>({...q,type:'sata'}));

      let all = shuffleArr([...mcQs, ...idQs, ...tfQs, ...fibQs, ...sataQs]);
      if (all.length < 50) { mtError.textContent = 'Not enough questions in selected topics. Try more topics or reduce counts.'; mtError.classList.remove('hidden'); return; }
      all = all.slice(0, 50);

      mtState = { questions: all, index: 0, answers: [], score: 0, graded: false };
      mtConfig.classList.add('hidden');
      mtExamWrap.classList.remove('hidden');
      mtResults.classList.add('hidden');
      renderMTQuestion();
      document.getElementById('mt-total').textContent = '50';
      document.getElementById('mt-prev').style.display = '';
      document.getElementById('mt-next').style.display = '';
      document.getElementById('mt-submit').style.display = 'none';
    });

    function renderMTQuestion() {
      if (!mtState) return;
      const q = mtState.questions[mtState.index];
      const n = mtState.index + 1;
      const total = mtState.questions.length;
      document.getElementById('mt-current').textContent = n;
      document.getElementById('mt-total').textContent = total;
      document.getElementById('mt-prev').disabled = n <= 1;
      document.getElementById('mt-next').disabled = false;
      document.getElementById('mt-next').textContent = n >= total ? 'Submit Exam' : 'Next ‚Üí';

      if (q.type === 'mc') {
        const shuf = shuffleArr(q.opts.map((o,i)=>({t:o,c:i===q.a}))); 
        mtQuestionArea.innerHTML = `
          <div class="minitest-question"><span class="q-type">Multiple Choice</span><div class="q-text">${n}. ${q.q}</div>
          ${shuf.map(o=>`<div class="minitest-sata-opt"><input type="radio" name="mt-ans" value="${o.c}" data-correct="${o.c}"><span>${o.t}</span></div>`).join('')}
          </div>`;
      } else if (q.type === 'id') {
        mtQuestionArea.innerHTML = `
          <div class="minitest-question"><span class="q-type">Identification</span><div class="q-text">${n}. ${q.q}</div>
          <input type="text" class="minitest-id-input" id="mt-id-ans" placeholder="Your answer"></div>`;
      } else if (q.type === 'tf') {
        mtQuestionArea.innerHTML = `
          <div class="minitest-question"><span class="q-type">True or False</span><div class="q-text">${n}. ${q.q}</div>
          <div class="minitest-sata-opt"><input type="radio" name="mt-ans" value="true"><span>True</span></div>
          <div class="minitest-sata-opt"><input type="radio" name="mt-ans" value="false"><span>False</span></div>
          </div>`;
      } else if (q.type === 'fib') {
        mtQuestionArea.innerHTML = `
          <div class="minitest-question"><span class="q-type">Fill in the Blanks</span><div class="q-text">${n}. ${q.q}</div>
          <input type="text" class="minitest-fib-input" id="mt-fib-ans" placeholder="Your answer"></div>`;
      } else if (q.type === 'sata') {
        const shuf = shuffleArr(q.opts.map(o=>({...o})));
        mtQuestionArea.innerHTML = `
          <div class="minitest-question"><span class="q-type">SATA - Select All That Apply</span><div class="q-text">${n}. ${q.q}</div>
          ${shuf.map((o,i)=>`<div class="minitest-sata-opt"><input type="checkbox" class="mt-sata-cb" data-correct="${o.c}" data-idx="${i}"><span>${o.t}</span></div>`).join('')}
          </div>`;
      }
    }

    function getMTAnswer() {
      const q = mtState.questions[mtState.index];
      if (q.type === 'mc') {
        const r = document.querySelector('input[name="mt-ans"]:checked');
        return r ? r.dataset.correct === 'true' : null;
      }
      if (q.type === 'id') return document.getElementById('mt-id-ans')?.value;
      if (q.type === 'tf') {
        const r = document.querySelector('input[name="mt-ans"]:checked');
        return r ? r.value === 'true' : null;
      }
      if (q.type === 'fib') return document.getElementById('mt-fib-ans')?.value;
      if (q.type === 'sata') {
        const cbs = document.querySelectorAll('.mt-sata-cb');
        return [...cbs].map(cb=>{
          const span = cb.closest('.minitest-sata-opt')?.querySelector('span');
          return { text: span?.textContent?.trim() || '', checked: cb.checked, correct: cb.dataset.correct==='true' };
        });
      }
      return null;
    }

    function saveMTAnswer() {
      if (mtState.answers[mtState.index] !== undefined) return;
      mtState.answers[mtState.index] = getMTAnswer();
    }

    document.getElementById('mt-prev')?.addEventListener('click', () => {
      saveMTAnswer();
      mtState.index--;
      renderMTQuestion();
      const prevAns = mtState.answers[mtState.index];
      if (prevAns !== undefined && mtState.questions[mtState.index]) {
        const q = mtState.questions[mtState.index];
        if (q.type === 'mc' && typeof prevAns === 'boolean') document.querySelector(`input[data-correct="${prevAns}"]`)?.click();
        if (q.type === 'tf' && typeof prevAns === 'boolean') document.querySelector(`input[name="mt-ans"][value="${prevAns}"]`)?.click();
        if (q.type === 'id' && prevAns) { const inp = document.getElementById('mt-id-ans'); if (inp) inp.value = prevAns; }
        if (q.type === 'fib' && prevAns) { const inp = document.getElementById('mt-fib-ans'); if (inp) inp.value = prevAns; }
        if (q.type === 'sata' && Array.isArray(prevAns)) document.querySelectorAll('.mt-sata-cb').forEach((cb,i)=>{ if (prevAns[i]) cb.checked = prevAns[i].checked; });
      }
    });

    document.getElementById('mt-next')?.addEventListener('click', () => {
      saveMTAnswer();
      if (mtState.index >= mtState.questions.length - 1) submitMTExam();
      else { mtState.index++; renderMTQuestion(); }
    });

    function submitMTExam() {
      saveMTAnswer();
      let score = 0;
      const totalQ = mtState.questions.length;
      mtState.questions.forEach((q, i) => {
        const ans = mtState.answers[i];
        if (q.type === 'mc') score += ans === true ? 1 : 0;
        else if (q.type === 'id') score += matchAnswer(ans, q.a) ? 1 : 0;
        else if (q.type === 'tf') score += ans === q.a ? 1 : 0;
        else if (q.type === 'fib') score += matchAnswer(ans, q.a) ? 1 : 0;
        else if (q.type === 'sata' && Array.isArray(ans)) {
          let correct = true;
          ans.forEach(a => { if (a.checked !== a.correct) correct = false; });
          score += correct ? 1 : 0;
        }
      });
      mtState.score = score;
      mtState.graded = true;
      mtConfig.classList.remove('hidden');
      mtExamWrap.classList.add('hidden');
      mtResults.classList.remove('hidden');
      const pct = Math.round((score/totalQ)*100);

      function formatReviewItem(q, i, ans) {
        let right = false, yourStr = '', correctStr = '';
        if (ans === undefined) ans = null;
        if (q.type === 'mc') {
          right = ans === true;
          const correctOpt = q.opts[q.a];
          yourStr = ans === true ? correctOpt : (ans === false ? 'Incorrect' : '(not answered)');
          correctStr = correctOpt;
        } else if (q.type === 'id') {
          right = matchAnswer(ans, q.a);
          yourStr = ans || '(not answered)';
          correctStr = q.a;
        } else if (q.type === 'tf') {
          right = ans === q.a;
          yourStr = ans === true ? 'True' : (ans === false ? 'False' : '(not answered)');
          correctStr = q.a ? 'True' : 'False';
        } else if (q.type === 'fib') {
          right = matchAnswer(ans, q.a);
          yourStr = ans || '(not answered)';
          correctStr = q.a;
        } else if (q.type === 'sata' && Array.isArray(ans)) {
          let correct = true;
          ans.forEach(a => { if (a.checked !== a.correct) correct = false; });
          right = correct;
          const selected = ans.filter(a=>a.checked).map(a=>a.text).join(', ');
          const correctOpts = q.opts.filter(o=>o.c).map(o=>o.t).join(', ');
          yourStr = selected || '(none selected)';
          correctStr = correctOpts;
        }
        const cls = right ? 'correct' : 'wrong';
        const icon = right ? '‚úì' : '‚úó';
        return `<div class="minitest-review-item ${cls}">
          <div class="review-q">${i+1}. ${q.q} <span>${icon}</span></div>
          <div class="review-ans"><span class="review-yours">Your answer: ${escapeHtml(yourStr)}</span></div>
          <div class="review-ans"><span class="review-correct">Correct: ${escapeHtml(correctStr)}</span></div>
        </div>`;
      }
      function escapeHtml(s) { return (s+'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }

      const reviewHtml = mtState.questions.map((q,i)=>formatReviewItem(q,i,mtState.answers[i])).join('');
      mtResults.innerHTML = `
        <h3>Exam Complete!</h3>
        <p><strong>Score: ${score}/${totalQ}</strong> (${pct}%)</p>
        <p>${pct >= 75 ? 'üéâ Passing!' : 'Keep studying!'}</p>
        <h4 style="margin-top:1rem;">Answer Review</h4>
        <div class="minitest-review">${reviewHtml}</div>
        <button type="button" class="btn btn-primary" id="mt-retry" style="margin-top:1rem;">Take Another Exam</button>
      `;
      document.getElementById('mt-retry')?.addEventListener('click', () => {
        mtResults.classList.add('hidden');
        mtError.classList.add('hidden');
      });
    }

    // Flower picker - click to add flower (same flower can be added multiple times)
    const flowerPickerGrid = document.getElementById('flower-picker-grid');
    const loveLetterFlowers = document.getElementById('love-letter-flowers');
    FLOWER_OPTIONS.forEach((flower) => {
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.className = 'flower-picker-btn';
      btn.dataset.path = flower.path;
      btn.title = flower.name + ' (click to add)';
      const img = document.createElement('img');
      img.src = flower.path;
      img.alt = flower.name;
      const label = document.createElement('span');
      label.className = 'flower-name';
      label.textContent = flower.name;
      btn.appendChild(img);
      btn.appendChild(label);
      btn.addEventListener('click', () => {
        const x = 15 + Math.random() * 70;
        const y = 15 + Math.random() * 70;
        flowerDecorations.push({ path: flower.path, x, y });
        updateLoveLetterFlowers();
        saveDraft();
      });
      flowerPickerGrid.appendChild(btn);
    });

    function updateLoveLetterFlowers() {
      loveLetterFlowers.innerHTML = '';
      flowerDecorations.forEach((fd, i) => {
        const wrap = document.createElement('div');
        wrap.className = 'flower-wrapper';
        wrap.style.left = fd.x + '%';
        wrap.style.top = fd.y + '%';
        wrap.dataset.index = String(i);
        const img = document.createElement('img');
        img.src = fd.path;
        img.alt = 'Flower';
        img.draggable = false;
        const removeBtn = document.createElement('button');
        removeBtn.className = 'flower-remove';
        removeBtn.innerHTML = '√ó';
        removeBtn.title = 'Remove flower';
        removeBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          flowerDecorations.splice(i, 1);
          updateLoveLetterFlowers();
          saveDraft();
        });
        wrap.appendChild(img);
        wrap.appendChild(removeBtn);

        const startDrag = (clientX, clientY) => {
          const onMove = (e) => {
            const cx = e.touches ? e.touches[0].clientX : e.clientX;
            const cy = e.touches ? e.touches[0].clientY : e.clientY;
            const rect = loveLetterCard.getBoundingClientRect();
            const pctX = ((cx - rect.left) / rect.width) * 100;
            const pctY = ((cy - rect.top) / rect.height) * 100;
            flowerDecorations[i].x = Math.max(0, Math.min(100, pctX));
            flowerDecorations[i].y = Math.max(0, Math.min(100, pctY));
            wrap.style.left = flowerDecorations[i].x + '%';
            wrap.style.top = flowerDecorations[i].y + '%';
          };
          const onUp = () => {
            document.removeEventListener('mousemove', onMove);
            document.removeEventListener('mouseup', onUp);
            document.removeEventListener('touchmove', onMove, { passive: false });
            document.removeEventListener('touchend', onUp);
            saveDraft();
          };
          document.addEventListener('mousemove', onMove);
          document.addEventListener('mouseup', onUp);
          document.addEventListener('touchmove', onMove, { passive: false });
          document.addEventListener('touchend', onUp);
        };

        wrap.addEventListener('mousedown', (e) => {
          if (e.target.classList.contains('flower-remove')) return;
          e.preventDefault();
          startDrag(e.clientX, e.clientY);
        });
        wrap.addEventListener('touchstart', (e) => {
          if (e.target.classList.contains('flower-remove')) return;
          e.preventDefault();
          startDrag(e.touches[0].clientX, e.touches[0].clientY);
        }, { passive: false });
        loveLetterFlowers.appendChild(wrap);
      });
    }

    function playShutterSound() {
      try {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.connect(gain);
        gain.connect(ctx.destination);
        osc.frequency.setValueAtTime(1200, ctx.currentTime);
        osc.frequency.exponentialRampToValueAtTime(200, ctx.currentTime + 0.1);
        gain.gain.setValueAtTime(0.15, ctx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.1);
        osc.start(ctx.currentTime);
        osc.stop(ctx.currentTime + 0.1);
      } catch (_) {}
    }

    function showConfettiBurst() {
      confettiContainer.style.display = 'block';
      confettiContainer.innerHTML = '';
      const symbols = ['‚ô•', '‚úø', '‚ú¶', '‚ô°', '‚ù§Ô∏è', '‚ûï', 'üåø', '‚Ä¢'];
      const colors = ['#e91e8c', '#ff85b3', '#9CAF88', '#64B5F6', '#ffd700', '#4DB6AC', '#7CB342', '#ff6b9d'];
      for (let i = 0; i < 35; i++) {
        const el = document.createElement('span');
        el.className = 'confetti-piece';
        el.textContent = symbols[Math.floor(Math.random() * symbols.length)];
        el.style.left = Math.random() * 100 + 'vw';
        el.style.fontSize = (14 + Math.random() * 20) + 'px';
        el.style.color = colors[Math.floor(Math.random() * colors.length)];
        el.style.animationDelay = Math.random() * 0.3 + 's';
        el.style.animationDuration = (1.2 + Math.random() * 0.6) + 's';
        confettiContainer.appendChild(el);
      }
      setTimeout(() => {
        confettiContainer.style.display = 'none';
        confettiContainer.innerHTML = '';
      }, 2000);
    }

    function loadDraft() {
      try {
        const saved = localStorage.getItem(STORAGE_KEY);
        if (saved) {
          const data = JSON.parse(saved);
          if (data.message) messageInput.value = data.message;
          if (Array.isArray(data.flowers)) {
            flowerDecorations = data.flowers.filter(f => FLOWER_OPTIONS.some(o => o.path === f.path)).map(f => ({
              path: f.path,
              x: typeof f.x === 'number' ? Math.max(0, Math.min(100, f.x)) : 50,
              y: typeof f.y === 'number' ? Math.max(0, Math.min(100, f.y)) : 50
            }));
            updateLoveLetterFlowers();
          }
        }
      } catch (_) {}
    }

    function saveDraft() {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify({
          message: messageInput.value,
          flowers: flowerDecorations,
          savedAt: Date.now()
        }));
      } catch (_) {}
    }

    async function initFaceLandmarker() {
      if (faceLandmarker) return true;
      try {
        const vision = await import('https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.14/vision_bundle.mjs');
        const { FaceLandmarker, FilesetResolver } = vision;
        const filesetResolver = await FilesetResolver.forVisionTasks(
          'https://cdn.jsdelivr.net/npm/@mediapipe/tasks-vision@0.10.14/wasm'
        );
        try {
          faceLandmarker = await FaceLandmarker.createFromOptions(filesetResolver, {
            baseOptions: {
              modelAssetPath: 'https://storage.googleapis.com/mediapipe-models/face_landmarker/face_landmarker/float16/1/face_landmarker.task',
              delegate: 'GPU'
            },
            runningMode: 'VIDEO',
            numFaces: 1
          });
        } catch (gpuErr) {
          faceLandmarker = await FaceLandmarker.createFromOptions(filesetResolver, {
            baseOptions: {
              modelAssetPath: 'https://storage.googleapis.com/mediapipe-models/face_landmarker/face_landmarker/float16/1/face_landmarker.task',
              delegate: 'CPU'
            },
            runningMode: 'VIDEO',
            numFaces: 1
          });
        }
        return true;
      } catch (e) {
        console.warn('Face tracking unavailable:', e);
        return false;
      }
    }

    function detectFace() {
      if (!faceLandmarker || !video.videoWidth || video.readyState < 2) return null;
      try {
        const now = performance.now();
        if (lastVideoTime === video.currentTime) return lastFacePosition;
        lastVideoTime = video.currentTime;
        const results = faceLandmarker.detectForVideo(video, now);
        if (!results.faceLandmarks || results.faceLandmarks.length === 0) return lastFacePosition;
        const landmarks = results.faceLandmarks[0];
        let minY = 1, cx = 0.5;
        for (let i = 0; i < Math.min(landmarks.length, 100); i++) {
          const l = landmarks[i];
          if (l.y < minY) {
            minY = l.y;
            cx = l.x;
          }
        }
        lastFacePosition = { x: cx, y: Math.max(0, minY - 0.08) };
        return lastFacePosition;
      } catch (e) {
        return lastFacePosition;
      }
    }

    // Filter selection
    document.querySelectorAll('.filter-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentFilter = btn.dataset.filter;
        if (currentFilter === 'none' && filterAnimationId) {
          cancelAnimationFrame(filterAnimationId);
          filterAnimationId = null;
        } else if (stream) {
          startFilterLoop();
        }
      });
    });

    function drawFilter(ctx, w, h, faceCenter) {
      const cx = faceCenter ? faceCenter.x * w : w / 2;
      const cy = faceCenter ? faceCenter.y * h : h * 0.35;
      const t = Date.now() / 1000;

      if (currentFilter === 'hearts') {
        const positions = [[0, -1.2], [-0.6, -0.8], [0.6, -0.8], [-0.3, -1.5], [0.3, -1.5]];
        const scale = Math.min(w, h) * 0.12;
        positions.forEach(([ox, oy], i) => {
          const x = cx + ox * scale;
          const y = cy + oy * scale + Math.sin(t * 2 + i) * 4;
          const s = scale * (0.8 + Math.sin(t + i * 0.5) * 0.2);
          ctx.font = `${s}px Arial`;
          ctx.fillStyle = `rgba(233, 30, 140, ${0.7 + Math.sin(t * 3) * 0.2})`;
          ctx.fillText('‚ô•', x - s / 2, y + s / 2);
        });
      } else if (currentFilter === 'crown') {
        const scale = Math.min(w, h) * 0.08;
        const pts = [[-1.5, 0.5], [-0.8, -0.3], [0, 0.2], [0.8, -0.3], [1.5, 0.5]];
        ctx.strokeStyle = '#ffd700';
        ctx.fillStyle = 'rgba(255, 215, 0, 0.8)';
        ctx.lineWidth = 2;
        ctx.beginPath();
        pts.forEach(([px, py], i) => {
          const x = cx + px * scale;
          const y = cy + py * scale;
          ctx[i === 0 ? 'moveTo' : 'lineTo'](x, y);
        });
        ctx.closePath();
        ctx.fill();
        ctx.stroke();
      } else if (currentFilter === 'stars') {
        const positions = [[0, -1], [-0.5, -0.5], [0.5, -0.5], [-0.8, -1.2], [0.8, -1.2]];
        const scale = Math.min(w, h) * 0.1;
        positions.forEach(([ox, oy], i) => {
          const x = cx + ox * scale + Math.cos(t + i) * 3;
          const y = cy + oy * scale;
          const s = scale * (0.6 + Math.sin(t * 2 + i) * 0.3);
          ctx.font = `${s}px Arial`;
          ctx.fillStyle = `rgba(255, 215, 0, ${0.8 + Math.sin(t * 4) * 0.2})`;
          ctx.fillText('‚ú¶', x - s / 2, y + s / 2);
        });
      } else if (currentFilter === 'flower') {
        const positions = [[0, -1.2], [-0.5, -0.7], [0.5, -0.7], [-0.3, -1.4], [0.3, -1.4]];
        const scale = Math.min(w, h) * 0.14;
        positions.forEach(([ox, oy], i) => {
          const x = cx + ox * scale + Math.sin(t * 1.5 + i * 0.8) * 4;
          const y = cy + oy * scale;
          const s = scale * (0.7 + Math.sin(t * 2 + i) * 0.15);
          ctx.font = `${s}px Arial`;
          ctx.fillStyle = `rgba(255, 182, 193, ${0.85 + Math.sin(t * 3) * 0.1})`;
          ctx.fillText('üå∏', x - s / 2, y + s / 2);
        });
      }
    }

    // Map video-normalized (0-1) coords to overlay pixels, accounting for object-fit: cover
    function videoNormToOverlay(xNorm, yNorm, overlayW, overlayH, videoW, videoH) {
      if (!videoW || !videoH) return { x: overlayW / 2, y: overlayH * 0.35 };
      const scale = Math.max(overlayW / videoW, overlayH / videoH);
      const scaledW = videoW * scale;
      const scaledH = videoH * scale;
      const offsetX = (scaledW - overlayW) / 2;
      const offsetY = (scaledH - overlayH) / 2;
      const visibleNormX = (xNorm * scaledW - offsetX) / overlayW;
      const visibleNormY = (yNorm * scaledH - offsetY) / overlayH;
      return {
        x: visibleNormX * overlayW,
        y: visibleNormY * overlayH
      };
    }

    function runFilterLoop() {
      if (!stream || currentFilter === 'none' || !filterOverlay) return;
      const rect = cameraContainer.getBoundingClientRect();
      if (filterOverlay.width !== rect.width || filterOverlay.height !== rect.height) {
        filterOverlay.width = rect.width;
        filterOverlay.height = rect.height;
      }
      const ctx = filterOverlay.getContext('2d');
      ctx.clearRect(0, 0, filterOverlay.width, filterOverlay.height);
      let facePos = null;
      if (faceLandmarker) {
        const raw = detectFace();
        if (raw) {
          const mapped = videoNormToOverlay(raw.x, raw.y, filterOverlay.width, filterOverlay.height, video.videoWidth, video.videoHeight);
          facePos = { x: mapped.x / filterOverlay.width, y: mapped.y / filterOverlay.height };
        }
      }
      drawFilter(ctx, filterOverlay.width, filterOverlay.height, facePos);
      filterAnimationId = requestAnimationFrame(runFilterLoop);
    }

    async function startFilterLoop() {
      if (filterAnimationId) cancelAnimationFrame(filterAnimationId);
      if (currentFilter !== 'none' && stream) {
        await initFaceLandmarker();
        filterOverlay.style.display = 'block';
        lastFacePosition = null;
        lastVideoTime = -1;
        runFilterLoop();
      } else {
        filterOverlay.style.display = 'none';
      }
    }

    function stopFilterLoop() {
      if (filterAnimationId) {
        cancelAnimationFrame(filterAnimationId);
        filterAnimationId = null;
      }
      filterOverlay.style.display = 'none';
    }

    // Timer options
    document.querySelectorAll('.timer-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.timer-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        timerSeconds = parseInt(btn.dataset.timer, 10);
      });
    });

    // Effect options (sepia, vintage, B&W)
    document.querySelectorAll('.effect-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.effect-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        currentEffect = btn.dataset.effect;
      });
    });

    // Grid toggle
    gridToggle.addEventListener('change', () => {
      gridOverlay.classList.toggle('visible', gridToggle.checked);
    });

    async function startCamera(facing = 'user') {
      if (stream) {
        stream.getTracks().forEach(t => t.stop());
        stream = null;
      }
      try {
        stream = await navigator.mediaDevices.getUserMedia({
          video: {
            facingMode: facing,
            width: { ideal: 1920 },
            height: { ideal: 1080 }
          }
        });
      } catch (resErr) {
        stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: facing } });
      }
      currentFacingMode = facing;
      video.srcObject = stream;
      video.style.transform = facing === 'user' ? 'scaleX(-1)' : 'scaleX(1)';
      filterOverlay.style.transform = facing === 'user' ? 'scaleX(-1)' : 'scaleX(1)';
      captureBtn.disabled = false;
      flipCameraBtn.disabled = false;
      if (currentFilter !== 'none') startFilterLoop();
    }

    // Flip camera (front/back on mobile)
    flipCameraBtn.addEventListener('click', async () => {
      if (!stream) return;
      const next = currentFacingMode === 'user' ? 'environment' : 'user';
      try {
        await startCamera(next);
      } catch (err) {
        alert('Could not switch camera. Your device may not have multiple cameras.');
      }
    });

    // Start camera
    startBtn.addEventListener('click', async () => {
      try {
        await startCamera('user');
        placeholder.classList.add('hidden');
        startBtn.textContent = 'Camera On';
        startBtn.disabled = true;
      } catch (err) {
        alert('Could not access camera. Please allow camera permissions.');
        console.error(err);
      }
    });

    function applyColorEffect(ctx, w, h) {
      if (currentEffect === 'none') return;
      const temp = document.createElement('canvas');
      temp.width = w;
      temp.height = h;
      const tctx = temp.getContext('2d');
      if (currentEffect === 'sepia') {
        tctx.filter = 'sepia(0.8)';
      } else if (currentEffect === 'vintage') {
        tctx.filter = 'sepia(0.5) contrast(1.1) saturate(0.9)';
      } else if (currentEffect === 'bw') {
        tctx.filter = 'grayscale(1)';
      }
      tctx.drawImage(canvas, 0, 0);
      ctx.clearRect(0, 0, w, h);
      ctx.drawImage(temp, 0, 0);
    }

    function doCapture() {
      stopFilterLoop();
      const ctx = canvas.getContext('2d');
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      ctx.imageSmoothingEnabled = true;
      ctx.imageSmoothingQuality = 'high';
      const mirror = currentFacingMode === 'user';
      ctx.save();
      if (mirror) {
        ctx.translate(canvas.width, 0);
        ctx.scale(-1, 1);
      }
      ctx.drawImage(video, 0, 0);
      ctx.restore();
      if (currentFilter !== 'none') {
        const facePos = lastFacePosition ? { x: lastFacePosition.x, y: lastFacePosition.y } : null;
        ctx.save();
        if (mirror) {
          ctx.translate(canvas.width, 0);
          ctx.scale(-1, 1);
        }
        drawFilter(ctx, video.videoWidth, video.videoHeight, facePos);
        ctx.restore();
      }
      applyColorEffect(ctx, canvas.width, canvas.height);
      const dataUrl = canvas.toDataURL('image/png');
      capturedPhotos.push(dataUrl);
      if (selectedPhotoIndices.length < 3) {
        selectedPhotoIndices.push(capturedPhotos.length - 1);
        selectedPhotoIndices.sort((a, b) => a - b);
      }

      if (flashToggle && flashToggle.checked && flashOverlay) {
        flashOverlay.classList.add('flash');
        setTimeout(() => flashOverlay.classList.remove('flash'), 300);
      }
      playShutterSound();
      showConfettiBurst();

      capturePreview.src = dataUrl;
      capturePreview.classList.add('visible');
      video.classList.add('hidden');
      captureBtn.disabled = true;
      retakeBtn.disabled = false;
      
      renderGallery();
      updateLoveLetter();
    }

    // Capture photo (with optional timer)
    captureBtn.addEventListener('click', () => {
      if (timerSeconds === 0) {
        doCapture();
        return;
      }

      captureBtn.disabled = true;
      const countdownOverlay = document.getElementById('countdown-overlay');
      const countdownNumber = document.getElementById('countdown-number');
      let count = timerSeconds;

      countdownOverlay.classList.add('visible');
      countdownNumber.textContent = count;

      countdownInterval = setInterval(() => {
        count--;
        countdownNumber.textContent = count;
        if (count <= 0) {
          clearInterval(countdownInterval);
          countdownOverlay.classList.remove('visible');
          doCapture();
          captureBtn.disabled = false;
        }
      }, 1000);
    });

    // Retake
    retakeBtn.addEventListener('click', () => {
      capturePreview.classList.remove('visible');
      capturePreview.src = '';
      video.classList.remove('hidden');
      captureBtn.disabled = false;
      retakeBtn.disabled = true;
      if (currentFilter !== 'none') startFilterLoop();
    });

    // Render gallery with download buttons
    function renderGallery() {
      galleryEmpty.style.display = capturedPhotos.length ? 'none' : 'block';
      gallery.innerHTML = '';

      capturedPhotos.forEach((photo, i) => {
        const isInLoveLetter = selectedPhotoIndices.includes(i);
        const item = document.createElement('div');
        item.className = 'gallery-item' + (isInLoveLetter ? ' selected' : '');
        item.addEventListener('click', (e) => {
          if (!e.target.classList.contains('download-btn') && !e.target.classList.contains('delete-btn')) {
            const idx = selectedPhotoIndices.indexOf(i);
            if (idx >= 0) {
              selectedPhotoIndices.splice(idx, 1);
            } else if (selectedPhotoIndices.length < 3) {
              selectedPhotoIndices.push(i);
              selectedPhotoIndices.sort((a, b) => a - b);
            }
            renderGallery();
            updateLoveLetter();
          }
        });
        const img = document.createElement('img');
        img.src = photo;
        img.alt = `Photo ${i + 1}`;
        const deleteBtn = document.createElement('button');
        deleteBtn.className = 'delete-btn';
        deleteBtn.innerHTML = '√ó';
        deleteBtn.title = 'Delete photo';
        deleteBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          const idx = selectedPhotoIndices.indexOf(i);
          if (idx >= 0) selectedPhotoIndices.splice(idx, 1);
          selectedPhotoIndices = selectedPhotoIndices.map(x => x > i ? x - 1 : x).filter(x => x >= 0);
          capturedPhotos.splice(i, 1);
          renderGallery();
          updateLoveLetter();
        });
        const downloadBtn = document.createElement('button');
        downloadBtn.className = 'download-btn';
        downloadBtn.textContent = 'Download';
        downloadBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          e.preventDefault();
          downloadPhoto(photo, `bea-photo-${i + 1}.png`);
        });
        item.appendChild(img);
        item.appendChild(deleteBtn);
        item.appendChild(downloadBtn);
        gallery.appendChild(item);
      });
    }

    // Update love letter preview
    function updateLoveLetter() {
      const msg = messageInput.value.trim();
      loveLetterMessage.textContent = msg || 'Write your message above...';
      loveLetterMessage.classList.toggle('empty', !msg);

      loveLetterPhotos.innerHTML = '';
      const hasPhotos = selectedPhotoIndices.length > 0;
      loveLetterPhotoPlaceholder.style.display = hasPhotos ? 'none' : 'flex';

      const n = selectedPhotoIndices.length;
      loveLetterPhotos.className = 'love-letter-photos' + (n === 1 ? ' layout-1' : n === 2 ? ' layout-2' : n === 3 ? ' layout-3' : '');

      selectedPhotoIndices.forEach(idx => {
        if (capturedPhotos[idx]) {
          const frame = document.createElement('div');
          frame.className = 'love-letter-photo-frame';
          const img = document.createElement('img');
          img.className = 'love-letter-photo';
          img.src = capturedPhotos[idx];
          img.alt = 'Love letter photo';
          frame.appendChild(img);
          loveLetterPhotos.appendChild(frame);
        }
      });

      const hasFlowers = flowerDecorations.length > 0;
      downloadLoveLetterBtn.disabled = !(msg || hasPhotos || hasFlowers);
      shareLoveLetterBtn.disabled = !(msg || hasPhotos || hasFlowers);

      const dateEl = document.getElementById('love-letter-date');
      if (dateEl) {
        const now = new Date();
        dateEl.textContent = now.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
      }
    }
    if (!('share' in navigator)) {
      shareLoveLetterBtn.style.display = 'none';
    }

    // Render love letter to canvas with full-resolution photos (never upscale = no blur)
    async function renderLoveLetterToCanvas() {
      const SCALE = 4;
      const CARD_W = 560 * SCALE;
      const PAD = 48 * SCALE;
      const MAX_PHOTO_W = 300 * SCALE;
      const MAX_PHOTO_H = (300 * 3 / 4) * SCALE;
      const PHOTO_GAP = 18 * SCALE;
      const MSG = messageInput.value.trim();
      const contentW = CARD_W - 72;

      // Pre-measure text to compute required height
      const measureCtx = document.createElement('canvas').getContext('2d');
      measureCtx.font = `${18 * SCALE}px Nunito, sans-serif`;
      const measureMaxW = CARD_W - 80;
      const measureText = MSG || 'Write your message above...';
      const measureWords = measureText.split(/\s+/);
      let lineCount = 0;
      let measureLine = '';
      for (const word of measureWords) {
        const test = measureLine ? measureLine + ' ' + word : word;
        if (measureCtx.measureText(test).width > measureMaxW && measureLine) {
          lineCount++;
          measureLine = word;
        } else {
          measureLine = test;
        }
      }
      if (measureLine) lineCount++;

      const LINE_H = 28 * SCALE;
      const photoList = selectedPhotoIndices.slice(0, 3).map(i => capturedPhotos[i]).filter(Boolean);
      const n = photoList.length;
      let photoBlockH = 0;
      if (n === 1) {
        const cellW = Math.min(MAX_PHOTO_W + 24 * SCALE, contentW);
        photoBlockH = Math.min(MAX_PHOTO_H + 40 * SCALE, contentW * 0.75 + 40 * SCALE);
      } else if (n === 2) {
        const cellW = (contentW - PHOTO_GAP) / 2;
        photoBlockH = Math.min(MAX_PHOTO_H, cellW * 0.75);
      } else if (n === 3) {
        const bigH = Math.min(MAX_PHOTO_H * 0.8, contentW * 0.4);
        const smallW = (contentW - PHOTO_GAP) / 2;
        const smallH = Math.min(MAX_PHOTO_H * 0.6, smallW * 0.75);
        photoBlockH = bigH + PHOTO_GAP + smallH;
      }

      const titleH = 40 * SCALE + 32 * SCALE + 24 * SCALE;
      const msgH = lineCount * LINE_H + 24 * SCALE;
      const dateH = 48 * SCALE;
      const bottomPad = 48 * SCALE;
      const computedCardH = titleH + (n > 0 ? photoBlockH + 28 * SCALE : 0) + msgH + dateH + bottomPad;
      const CARD_H = Math.max(480 * SCALE, computedCardH);
      const contentH = CARD_H - 72;

      const cvs = document.createElement('canvas');
      cvs.width = CARD_W + PAD * 2;
      cvs.height = CARD_H + PAD * 2;
      const ctx = cvs.getContext('2d');
      ctx.imageSmoothingEnabled = true;
      ctx.imageSmoothingQuality = 'high';

      const r = 12 * SCALE;
      const cardX = PAD, cardY = PAD, cardW = CARD_W, cardH = CARD_H;

      // Background
      const bg = ctx.createLinearGradient(cardX, cardY, cardX, cardY + cardH);
      bg.addColorStop(0, '#fffcf7');
      bg.addColorStop(0.2, '#fff8f5');
      bg.addColorStop(0.5, '#fff5f9');
      bg.addColorStop(1, '#fff0f5');
      ctx.fillStyle = bg;
      ctx.beginPath();
      if (ctx.roundRect) {
        ctx.roundRect(cardX, cardY, cardW, cardH, r);
      } else {
        ctx.rect(cardX, cardY, cardW, cardH);
      }
      ctx.fill();
      ctx.strokeStyle = 'rgba(233, 30, 140, 0.2)';
      ctx.lineWidth = 1 * SCALE;
      ctx.stroke();

      // Corner flourishes
      ctx.fillStyle = 'rgba(139, 115, 85, 0.15)';
      ctx.font = `${14 * SCALE}px serif`;
      ctx.textAlign = 'left';
      ctx.fillText('‚úø', cardX + 28, cardY + 32);
      ctx.textAlign = 'right';
      ctx.fillText('‚úø', cardX + cardW - 28, cardY + 32);
      ctx.textAlign = 'left';
      ctx.fillText('‚úø', cardX + 28, cardY + cardH - 20);
      ctx.textAlign = 'right';
      ctx.fillText('‚úø', cardX + cardW - 28, cardY + cardH - 20);
      ctx.textAlign = 'center';

      // Load image without tainting canvas (works with file:// and http)
      async function loadImageUntainted(url) {
        const dataUrl = typeof FLOWER_DATA_URLS !== 'undefined' && FLOWER_DATA_URLS[url];
        if (dataUrl) {
          const img = new Image();
          await new Promise((resolve, reject) => {
            img.onload = () => resolve();
            img.onerror = () => reject(new Error('Failed to load image'));
            img.src = dataUrl;
          });
          return img;
        }
        const res = await fetch(url);
        const blob = await res.blob();
        const objectUrl = URL.createObjectURL(blob);
        const img = new Image();
        await new Promise((resolve, reject) => {
          img.onload = () => { URL.revokeObjectURL(objectUrl); resolve(); };
          img.onerror = () => { URL.revokeObjectURL(objectUrl); reject(new Error('Failed to load image')); };
          img.src = objectUrl;
        });
        return img;
      }

      // Free-form flowers (x,y as 0-100 % of content area)
      const FLOWER_SIZE = 64 * SCALE;
      for (const fd of flowerDecorations) {
        const drawX = cardX + 36 + (fd.x / 100) * contentW - FLOWER_SIZE / 2;
        const drawY = cardY + 36 + (fd.y / 100) * contentH - FLOWER_SIZE / 2;
        const img = await loadImageUntainted(fd.path);
        ctx.drawImage(img, 0, 0, img.naturalWidth, img.naturalHeight, drawX, drawY, FLOWER_SIZE, FLOWER_SIZE);
      }

      let y = cardY + 40 * SCALE;

      // Title (script style)
      ctx.fillStyle = '#6B5344';
      ctx.font = `${28 * SCALE}px "Dancing Script", cursive`;
      ctx.textAlign = 'center';
      ctx.fillText('With Love ‚úø Care ‚Ä¢ Chill', cardX + cardW / 2, y);
      y += 32 * SCALE;

      // Line under title
      ctx.strokeStyle = 'rgba(156, 175, 136, 0.4)';
      ctx.lineWidth = 2 * SCALE;
      ctx.beginPath();
      ctx.moveTo(cardX + 80, y);
      ctx.lineTo(cardX + cardW - 80, y);
      ctx.stroke();
      y += 24 * SCALE;

      // Photos: layout-aware, max 3 (1=centered, 2=side-by-side, 3=1 large+2 small)
      if (photoList.length > 0) {
        const n = photoList.length;
        const loaded = [];
        for (let i = 0; i < photoList.length; i++) {
          const img = new Image();
          await new Promise((res, rej) => {
            img.onload = () => res();
            img.onerror = () => rej(new Error('Failed to load photo'));
            img.src = photoList[i];
          });
          loaded.push({ img, w: img.naturalWidth, h: img.naturalHeight });
        }

        const baseX = cardX + 36;
        let maxY = y;

        function fitInCell(nw, nh, cellW, cellH) {
          const sw = Math.min(cellW / nw, cellH / nh, 1);
          return { drawW: Math.round(nw * sw), drawH: Math.round(nh * sw) };
        }

        const POLAROID_PAD = 6 * SCALE;
        const POLAROID_FOOT = 16 * SCALE;
        function drawPhoto({ img, w, h }, dx, dy, cellW, cellH) {
          const { drawW, drawH } = fitInCell(w, h, cellW - POLAROID_PAD * 2, cellH - POLAROID_PAD * 2 - POLAROID_FOOT);
          const frameW = drawW + POLAROID_PAD * 2;
          const frameH = drawH + POLAROID_PAD * 2 + POLAROID_FOOT;
          const fx = dx + (cellW - frameW) / 2;
          const fy = dy + (cellH - frameH) / 2;
          ctx.fillStyle = '#ffffff';
          ctx.fillRect(fx, fy, frameW, frameH);
          ctx.drawImage(img, 0, 0, w, h, fx + POLAROID_PAD, fy + POLAROID_PAD, drawW, drawH);
          ctx.shadowColor = 'rgba(139, 115, 85, 0.2)';
          ctx.shadowBlur = 10 * SCALE;
          ctx.shadowOffsetY = 4 * SCALE;
          ctx.strokeStyle = 'rgba(139, 115, 85, 0.1)';
          ctx.lineWidth = 1 * SCALE;
          ctx.strokeRect(fx, fy, frameW, frameH);
          ctx.shadowBlur = 0;
          ctx.shadowOffsetY = 0;
          maxY = Math.max(maxY, fy + frameH);
        }

        if (n === 1) {
          const cellW = Math.min(MAX_PHOTO_W + 24 * SCALE, contentW);
          const cellH = Math.min(MAX_PHOTO_H + 40 * SCALE, contentW * 0.75 + 40 * SCALE);
          drawPhoto(loaded[0], baseX + (contentW - cellW) / 2, y, cellW, cellH);
        } else if (n === 2) {
          const cellW = (contentW - PHOTO_GAP) / 2;
          const cellH = Math.min(MAX_PHOTO_H, cellW * 0.75);
          drawPhoto(loaded[0], baseX, y, cellW, cellH);
          drawPhoto(loaded[1], baseX + cellW + PHOTO_GAP, y, cellW, cellH);
        } else if (n === 3) {
          const bigW = contentW;
          const bigH = Math.min(MAX_PHOTO_H * 0.8, contentW * 0.4);
          drawPhoto(loaded[0], baseX, y, bigW, bigH);
          const smallY = y + bigH + PHOTO_GAP;
          const smallW = (contentW - PHOTO_GAP) / 2;
          const smallH = Math.min(MAX_PHOTO_H * 0.6, smallW * 0.75);
          drawPhoto(loaded[1], baseX, smallY, smallW, smallH);
          drawPhoto(loaded[2], baseX + smallW + PHOTO_GAP, smallY, smallW, smallH);
        }
        y = maxY + 28 * SCALE;
      }

      // Message
      ctx.fillStyle = MSG ? '#5c3a4a' : '#b8a4ad';
      ctx.font = `${18 * SCALE}px Nunito, sans-serif`;
      ctx.textAlign = 'center';
      const maxW = cardW - 80;
      const text = MSG || 'Write your message above...';
      const words = text.split(/\s+/);
      let line = '';
      for (const word of words) {
        const test = line ? line + ' ' + word : word;
        if (ctx.measureText(test).width > maxW && line) {
          ctx.fillText(line, cardX + cardW / 2, y);
          y += 28 * SCALE;
          line = word;
        } else {
          line = test;
        }
      }
      if (line) ctx.fillText(line, cardX + cardW / 2, y);
      y += 24 * SCALE;

      // Date
      const dateStr = new Date().toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' });
      ctx.fillStyle = '#A0826D';
      ctx.font = `${16 * SCALE}px "Dancing Script", cursive`;
      ctx.fillText(dateStr, cardX + cardW / 2, y);

      return cvs;
    }

    // Share love letter (Web Share API - mobile)
    shareLoveLetterBtn.addEventListener('click', async () => {
      if (!navigator.share) return;
      try {
        const cvs = await renderLoveLetterToCanvas();
        cvs.toBlob(async (blob) => {
          const file = new File([blob], 'bea-love-letter.png', { type: 'image/png' });
          try {
            await navigator.share({ title: "Bea's Love Letter", files: [file] });
          } catch (e) {
            if (e.name !== 'AbortError') downloadLoveLetterBtn.click();
          }
        }, 'image/png');
      } catch (e) {
        console.error(e);
      }
    });

    // Download love letter as image (full-res photos, no compression)
    downloadLoveLetterBtn.addEventListener('click', async () => {
      const wasDisabled = downloadLoveLetterBtn.disabled;
      downloadLoveLetterBtn.disabled = true;
      downloadLoveLetterBtn.textContent = 'Preparing...';
      try {
        const cvs = await renderLoveLetterToCanvas();
        const link = document.createElement('a');
        link.download = 'bea-love-letter.png';
        link.href = cvs.toDataURL('image/png');
        link.click();
      } catch (e) {
        console.error(e);
        alert('Something went wrong. Please try again.');
      } finally {
        downloadLoveLetterBtn.disabled = wasDisabled;
        downloadLoveLetterBtn.textContent = 'Download Love Letter';
      }
    });

    messageInput.addEventListener('input', () => {
      updateLoveLetter();
      saveDraft();
    });

    // Mini Game selector - switch between games
    document.querySelectorAll('.game-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.game-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        document.querySelectorAll('.minigame-panel').forEach(p => p.classList.remove('visible'));
        const panel = document.getElementById('game-' + btn.dataset.game);
        if (panel) {
          panel.classList.add('visible');
          if (btn.dataset.game === 'scramble' && typeof renderScramble === 'function' && scrambleState) {
            renderScramble();
          }
        }
      });
    });

    // Care Match (memory game)
    const NURSING_PAIRS = ['‚ù§Ô∏è', 'üíä', 'ü©π', 'üíâ', 'üè•', 'ü©∫', 'üå°Ô∏è', 'üß¥'];
    const minigameBoard = document.getElementById('minigame-board');
    const minigameMoves = document.getElementById('minigame-moves');
    const minigameMatches = document.getElementById('minigame-matches');
    const minigameWin = document.getElementById('minigame-win');
    let minigameState = { cards: [], flipped: [], moves: 0, matched: 0, matchedIndices: [] };

    function initMinigame() {
      const doubled = [...NURSING_PAIRS, ...NURSING_PAIRS];
      for (let i = doubled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [doubled[i], doubled[j]] = [doubled[j], doubled[i]];
      }
      minigameState = { cards: doubled, flipped: [], moves: 0, matched: 0, matchedIndices: [] };
      renderMinigame();
    }

    function renderMinigame() {
      minigameBoard.innerHTML = '';
      minigameMoves.textContent = minigameState.moves;
      minigameMatches.textContent = minigameState.matched;
      minigameWin.classList.remove('visible');
      minigameState.cards.forEach((emoji, i) => {
        const card = document.createElement('div');
        card.className = 'minigame-card';
        card.dataset.index = i;
        const isMatched = minigameState.matchedIndices.includes(i);
        const isFlipped = minigameState.flipped.includes(i) || isMatched;
        if (isMatched) card.classList.add('flipped', 'matched');
        else if (isFlipped) card.classList.add('flipped');
        card.innerHTML = `<span class="card-back">${isFlipped ? emoji : '‚ùì'}</span>`;
        card.addEventListener('click', () => handleMinigameClick(i));
        minigameBoard.appendChild(card);
      });
    }

    function handleMinigameClick(i) {
      if (minigameState.flipped.length >= 2 || minigameState.flipped.includes(i) || minigameState.matchedIndices.includes(i)) return;
      const card = minigameBoard.children[i];
      minigameState.flipped.push(i);
      card.classList.add('flipped');
      card.querySelector('.card-back').textContent = minigameState.cards[i];
      if (minigameState.flipped.length === 2) {
        minigameState.moves++;
        minigameMoves.textContent = minigameState.moves;
        const [a, b] = minigameState.flipped;
        if (minigameState.cards[a] === minigameState.cards[b]) {
          minigameState.matched++;
          minigameState.matchedIndices.push(a, b);
          minigameMatches.textContent = minigameState.matched;
          minigameBoard.children[a].classList.add('matched');
          minigameBoard.children[b].classList.add('matched');
          minigameState.flipped = [];
          if (minigameState.matched === 8) {
            setTimeout(() => minigameWin.classList.add('visible'), 300);
          }
        } else {
          setTimeout(() => {
            minigameBoard.children[a].classList.remove('flipped');
            minigameBoard.children[b].classList.remove('flipped');
            minigameBoard.children[a].querySelector('.card-back').textContent = '‚ùì';
            minigameBoard.children[b].querySelector('.card-back').textContent = '‚ùì';
            minigameState.flipped = [];
          }, 600);
        }
      }
    }

    document.getElementById('minigame-reset').addEventListener('click', initMinigame);
    initMinigame();

    // Care Quiz - 100 questions, 10 random per game (hard choices)
    const QUIZ_QUESTIONS = [
      { q: 'What should you do first when a patient says they feel dizzy?', opts: ['Have them sit or lie down', 'Check blood pressure immediately', 'Administer anti-dizziness medication', 'Assess blood glucose level'], a: 0, subj: 'Fundamentals' },
      { q: 'The best way to prevent infection spread is:', opts: ['Handwashing', 'Chlorhexidine surgical scrub', 'Alcohol-based hand rub', 'Barrier precautions only'], a: 0, subj: 'Fundamentals' },
      { q: 'When should you reposition a bedbound patient?', opts: ['Every 2 hours', 'Every 3 hours', 'Every 4 hours', 'Every 6 hours'], a: 0, subj: 'Fundamentals' },
      { q: 'A normal adult resting heart rate is about:', opts: ['60‚Äì100 beats per minute', '50‚Äì70 bpm', '70‚Äì90 bpm', '80‚Äì120 bpm'], a: 0, subj: 'Fundamentals' },
      { q: 'Comfort and empathy are part of:', opts: ['Patient-centered care', 'Holistic nursing model', 'Therapeutic relationship', 'Quality improvement'], a: 0, subj: 'Fundamentals' },
      { q: 'Before any procedure, you must obtain:', opts: ['Informed consent', 'Written physician order', 'Family surrogate consent', 'Witnessed verbal consent'], a: 0, subj: 'Fundamentals' },
      { q: 'Patient information should be:', opts: ['Kept confidential', 'Shared only with direct caregivers', 'Available to all unit staff', 'Disclosed per family request'], a: 0, subj: 'Fundamentals' },
      { q: 'Normal adult body temperature in Celsius is:', opts: ['36.5‚Äì37.5¬∞C', '35.5‚Äì36.5¬∞C', '36.0‚Äì37.0¬∞C', '37.0‚Äì38.0¬∞C'], a: 0, subj: 'Fundamentals' },
      { q: 'When a patient refuses treatment, you should:', opts: ['Document and respect their decision', 'Notify the physician and document', 'Request family to persuade', 'Explain consequences and document'], a: 0, subj: 'Fundamentals' },
      { q: 'Hand hygiene should be performed:', opts: ['Before and after patient contact', 'After contact and before clean tasks', 'Before procedures only', 'After visible soiling only'], a: 0, subj: 'Fundamentals' },
      { q: 'Normal systolic blood pressure range is:', opts: ['90‚Äì120 mmHg', '100‚Äì130 mmHg', '80‚Äì110 mmHg', '110‚Äì140 mmHg'], a: 0, subj: 'Fundamentals' },
      { q: 'You witness a colleague make a medication error. You should:', opts: ['Report it immediately', 'Discuss with colleague first, then report', 'Document in incident report only', 'Notify charge nurse confidentially'], a: 0, subj: 'Fundamentals' },
      { q: 'The five rights of medication administration include:', opts: ['Right patient, drug, dose, route, time', 'Right patient, drug, dose, time, documentation', 'Right patient, drug, dose, reason, response', 'Right patient, indication, dose, route, time'], a: 0, subj: 'Fundamentals' },
      { q: 'When lifting a patient, you should:', opts: ['Use proper body mechanics', 'Bend knees and keep back straight', 'Use wide stance and lift smoothly', 'Request mechanical lift when available'], a: 0, subj: 'Fundamentals' },
      { q: 'A DNR order means:', opts: ['Do Not Resuscitate', 'Do Not Recover', 'Designated No Response', 'Deferred Nursing Recovery'], a: 0, subj: 'Fundamentals' },
      { q: 'Signs of a pressure ulcer in early stage include:', opts: ['Non-blanchable redness', 'Partial-thickness skin loss', 'Full-thickness tissue loss', 'Blanching erythema'], a: 0, subj: 'Fundamentals' },
      { q: 'Before administering medication, you verify the patient by:', opts: ['Name and date of birth', 'ID bracelet and room number', 'Name and medical record number', 'Bed number and armband'], a: 0, subj: 'Fundamentals' },
      { q: 'Hypoxia refers to:', opts: ['Low oxygen in tissues', 'Low oxygen in blood', 'Inadequate ventilation', 'Reduced hemoglobin'], a: 0, subj: 'Fundamentals' },
      { q: 'Ethically, you must advocate for the patient when:', opts: ['Their needs are not being met', 'Treatment conflicts with values', 'Family requests intervention', 'Provider disagrees with plan'], a: 0, subj: 'Fundamentals' },
      { q: 'Standard precautions apply to:', opts: ['All patients', 'Patients with known pathogens', 'Patients on isolation', 'Immunocompromised patients'], a: 0, subj: 'Fundamentals' },
      { q: 'Normal respiratory rate for an adult is:', opts: ['12‚Äì20 breaths per minute', '10‚Äì16 bpm', '16‚Äì24 bpm', '18‚Äì26 bpm'], a: 0, subj: 'Fundamentals' },
      { q: 'You discover a patient has fallen. First action:', opts: ['Assess for injury, call for help', 'Stabilize cervical spine first', 'Move to bed immediately', 'Obtain fall risk assessment'], a: 0, subj: 'Fundamentals' },
      { q: 'Informed consent requires that the patient:', opts: ['Understands risks, benefits, and alternatives', 'Has capacity and signs form', 'Receives verbal explanation', 'Has legal guardian present'], a: 0, subj: 'Fundamentals' },
      { q: 'Fowler\'s position is:', opts: ['Semi-sitting, head elevated', 'Supine with head elevated 15¬∞', 'High Fowler 90¬∞ sitting', 'Low Fowler 15‚Äì30¬∞'], a: 0, subj: 'Fundamentals' },
      { q: 'You may share patient info with:', opts: ['Care team with need to know', 'Consulting specialists on the case', 'Billing for payment purposes', 'Quality improvement team'], a: 0, subj: 'Fundamentals' },
      { q: 'When delegating tasks to unlicensed staff, you:', opts: ['Remain accountable for the task', 'Transfer accountability to delegate', 'Supervise outcome only', 'Assume competency after training'], a: 0, subj: 'Fundamentals' },
      { q: 'Normal oxygen saturation (SpO2) is:', opts: ['95‚Äì100%', '90‚Äì95%', '92‚Äì98%', '88‚Äì94%'], a: 0, subj: 'Fundamentals' },
      { q: 'Aseptic technique is used to:', opts: ['Prevent infection', 'Reduce pathogen load', 'Maintain sterile field', 'Comply with policy'], a: 0, subj: 'Fundamentals' },
      { q: 'A patient asks you to keep a secret about abuse. You should:', opts: ['Report per mandatory reporting laws', 'Report only if patient agrees', 'Document and inform supervisor', 'Maintain confidentiality per request'], a: 0, subj: 'Fundamentals' },
      { q: 'Before wound care, you clean:', opts: ['From clean to dirty', 'Center outward in circles', 'Most contaminated area first', 'Per physician preference'], a: 0, subj: 'Fundamentals' },
      { q: 'Restraints require:', opts: ['Medical order and frequent reassessment', 'Physician order and q2h assessment', 'Nursing judgment and documentation', 'Family consent and PRN order'], a: 0, subj: 'Fundamentals' },
      { q: 'Hypertension is:', opts: ['High blood pressure', 'Elevated diastolic only', 'Systolic over 140 mmHg', 'Labile blood pressure'], a: 0, subj: 'Fundamentals' },
      { q: 'You must report a nurse suspected of impairment to:', opts: ['Board of Nursing or supervisor', 'Risk management department', 'Peer review committee', 'Human resources only'], a: 0, subj: 'Fundamentals' },
      { q: 'Trendelenburg position is used for:', opts: ['Shock (head lower than feet)', 'Hypotension with poor perfusion', 'Spinal shock', 'Hemorrhagic shock'], a: 0, subj: 'Fundamentals' },
      { q: 'Documentation should be:', opts: ['Accurate, timely, and factual', 'Concise and objective', 'Complete and legible', 'Chart by exception'], a: 0, subj: 'Fundamentals' },
      { q: 'When a patient is confused, you should:', opts: ['Reorient gently, ensure safety', 'Use validation therapy', 'Provide familiar objects', 'Assess for reversible causes'], a: 0, subj: 'Fundamentals' },
      { q: 'Normal blood glucose range (fasting) is:', opts: ['70‚Äì100 mg/dL', '80‚Äì110 mg/dL', '60‚Äì90 mg/dL', '90‚Äì120 mg/dL'], a: 0, subj: 'Fundamentals' },
      { q: 'You receive an order you believe is harmful. You should:', opts: ['Clarify with prescriber, refuse if unsafe', 'Document concern and carry out order', 'Ask charge nurse to verify', 'Request pharmacy review'], a: 0, subj: 'Fundamentals' },
      { q: 'Isolation precautions protect:', opts: ['Patients and staff', 'Immunocompromised patients', 'High-risk procedures', 'Contaminated equipment'], a: 0, subj: 'Fundamentals' },
      { q: 'PRN means:', opts: ['As needed', 'At bedtime', 'Every 4 hours', 'When necessary'], a: 0, subj: 'Fundamentals' },
      { q: 'Cultural competence in nursing means:', opts: ['Respecting diverse beliefs and practices', 'Providing interpreter services', 'Adapting care to patient values', 'Avoiding cultural assumptions'], a: 0, subj: 'Fundamentals' },
      { q: 'Before blood draw, you confirm:', opts: ['Patient ID and tube labels', 'Two identifiers and requisition', 'Armband and order', 'Name and room number'], a: 0, subj: 'Fundamentals' },
      { q: 'A patient has a living will. You must:', opts: ['Honor their documented wishes', 'Follow most recent advance directive', 'Consult ethics committee', 'Verify with next of kin'], a: 0, subj: 'Fundamentals' },
      { q: 'Supine position is:', opts: ['Lying on back', 'Dorsal recumbent', 'Lithotomy without stirrups', 'Flat with legs extended'], a: 0, subj: 'Fundamentals' },
      { q: 'Verbal orders should be:', opts: ['Written and signed by prescriber promptly', 'Read back to verify accuracy', 'Witnessed by second nurse', 'Documented in nursing notes'], a: 0, subj: 'Fundamentals' },
      { q: 'Tachycardia is:', opts: ['Heart rate over 100 bpm', 'HR 90‚Äì100 at rest', 'Sinus rhythm over 80', 'Irregular rapid rhythm'], a: 0, subj: 'Fundamentals' },
      { q: 'You must respect patient autonomy, meaning:', opts: ['Their right to make own decisions', 'Informed refusal must be honored', 'Capacity determines decision-making', 'Substituted judgment when incapacitated'], a: 0, subj: 'Fundamentals' },
      { q: 'When transferring a patient, you ensure:', opts: ['Safe body mechanics and patient stability', 'Gait belt and assistive device', 'Clear path and adequate help', 'Patient wears non-slip footwear'], a: 0, subj: 'Fundamentals' },
      { q: 'NPO means:', opts: ['Nothing by mouth', 'Nil per os', 'No oral intake', 'NPO before procedure'], a: 0, subj: 'Fundamentals' },
      { q: 'A breach of confidentiality occurs if you:', opts: ['Share info without authorization', 'Discuss in hallway', 'Leave chart unattended', 'Email unencrypted PHI'], a: 0, subj: 'Fundamentals' },
      { q: 'Prone position is:', opts: ['Lying on stomach', 'Ventral recumbent', 'Face-down positioning', 'Abdomen on surface'], a: 0, subj: 'Fundamentals' },
      { q: 'Fall prevention includes:', opts: ['Call bell, non-slip footwear, clutter-free', 'Bed alarms and low beds', 'Orientation to room', 'Frequent rounding'], a: 0, subj: 'Fundamentals' },
      { q: 'Bradycardia is:', opts: ['Heart rate under 60 bpm', 'HR 50‚Äì60 at rest', 'Sinus bradycardia', 'Slow irregular rhythm'], a: 0, subj: 'Fundamentals' },
      { q: 'Beneficence in nursing means:', opts: ['Acting for the patient\'s good', 'Preventing harm', 'Promoting welfare', 'Balancing benefits and risks'], a: 0, subj: 'Fundamentals' },
      { q: 'Before IV insertion, you:', opts: ['Verify site, cleanse, use aseptic technique', 'Select largest vein available', 'Apply tourniquet and palpate', 'Ensure IV fluid compatibility'], a: 0, subj: 'Fundamentals' },
      { q: 'A patient\'s advance directive:', opts: ['Must be followed per their wishes', 'Requires physician verification', 'Can be overridden in emergency', 'Expires after 1 year'], a: 0, subj: 'Fundamentals' },
      { q: 'Lateral position is:', opts: ['Side-lying', 'Left lateral recumbent', 'Right lateral recumbent', 'Sims variation'], a: 0, subj: 'Fundamentals' },
      { q: 'Incident reports are used to:', opts: ['Improve safety, not punish', 'Root cause analysis', 'Quality improvement', 'Risk management review'], a: 0, subj: 'Fundamentals' },
      { q: 'Hypotension is:', opts: ['Low blood pressure', 'Systolic under 90 mmHg', 'Orthostatic drop', 'Decreased perfusion'], a: 0, subj: 'Fundamentals' },
      { q: 'Nonmaleficence means:', opts: ['Do no harm', 'Minimize risk', 'Prevent injury', 'Avoid negligence'], a: 0, subj: 'Fundamentals' },
      { q: 'When giving an injection, you use:', opts: ['Appropriate site, needle size, angle', 'Z-track for IM', 'Subcutaneous 45‚Äì90¬∞', 'Aspirate before injecting'], a: 0, subj: 'Fundamentals' },
      { q: 'A competent patient refuses a life-saving treatment. You:', opts: ['Respect the refusal, document', 'Obtain psychiatric evaluation', 'Request ethics consultation', 'Document capacity assessment'], a: 0, subj: 'Fundamentals' },
      { q: 'Sims position is:', opts: ['Left side-lying, leg flexed', 'Left lateral with top leg flexed', 'Semi-prone positioning', 'Modified lateral recumbent'], a: 0, subj: 'Fundamentals' },
      { q: 'Chain of command is used when:', opts: ['Resolving concerns or unsafe situations', 'Escalating unresolved issues', 'Reporting up the hierarchy', 'Bypassing direct supervisor'], a: 0, subj: 'Fundamentals' },
      { q: 'Febrile means:', opts: ['Having a fever', 'Temperature above 38¬∞C', 'Pyrexia', 'Elevated core temp'], a: 0, subj: 'Fundamentals' },
      { q: 'Justice in healthcare means:', opts: ['Fair allocation of resources', 'Equal access to care', 'Non-discrimination', 'Equitable treatment'], a: 0, subj: 'Fundamentals' },
      { q: 'Sterile field must remain:', opts: ['Above waist, within sight', 'Dry and intact', 'Uncontaminated', '1-inch border sterile'], a: 0, subj: 'Fundamentals' },
      { q: 'You suspect elder abuse. You must:', opts: ['Report per state law', 'Document findings first', 'Confront the abuser', 'Inform adult protective services'], a: 0, subj: 'Fundamentals' },
      { q: 'Lithotomy position is used for:', opts: ['Pelvic exams, childbirth', 'Gynecological procedures', 'Urological exams', 'Rectal procedures'], a: 0, subj: 'Fundamentals' },
      { q: 'SBAR stands for:', opts: ['Situation, Background, Assessment, Recommendation', 'Status, Brief, Action, Response', 'Summarize, Background, Act, Review', 'Safety, Best, Assessment, Record'], a: 0, subj: 'Fundamentals' },
      { q: 'Afebrile means:', opts: ['Without fever', 'Normothermic', 'No hyperthermia', 'Temperature normal'], a: 0, subj: 'Fundamentals' },
      { q: 'Fidelity in nursing means:', opts: ['Keeping promises, being trustworthy', 'Loyalty to patient', 'Maintaining confidentiality', 'Honoring commitments'], a: 0, subj: 'Fundamentals' },
      { q: 'When a patient has an allergic reaction, first:', opts: ['Assess airway, call for help', 'Administer epinephrine', 'Stop the allergen', 'Obtain vital signs'], a: 0, subj: 'Fundamentals' },
      { q: 'HIPAA protects:', opts: ['Patient health information', 'Medical records', 'Treatment plans', 'Diagnostic results'], a: 0, subj: 'Fundamentals' },
      { q: 'Dorsal recumbent position is:', opts: ['On back, knees bent', 'Supine with flexed knees', 'Dorsal lithotomy', 'Recumbent with legs apart'], a: 0, subj: 'Fundamentals' },
      { q: 'Double-checking high-alert medications means:', opts: ['Two nurses verify before administration', 'Independent double-check', 'Pharmacy verification', 'Barcode scan verification'], a: 0, subj: 'Fundamentals' },
      { q: 'Dyspnea means:', opts: ['Difficulty breathing', 'Shortness of breath', 'Labored breathing', 'Respiratory distress'], a: 0, subj: 'Fundamentals' },
      { q: 'Veracity means:', opts: ['Truthfulness', 'Honesty with patient', 'Accurate documentation', 'Informed disclosure'], a: 0, subj: 'Fundamentals' },
      { q: 'When a patient codes, you:', opts: ['Start CPR, call for help, get defibrillator', 'Begin chest compressions', 'Activate emergency response', 'Retrieve crash cart'], a: 0, subj: 'Fundamentals' },
      { q: 'Protected health information (PHI) includes:', opts: ['Name, DOB, diagnoses, treatments', 'Social Security number', 'Insurance information', 'All identifiers and health data'], a: 0, subj: 'Fundamentals' },
      { q: 'Knee-chest position is used for:', opts: ['Rectal exams, sigmoidoscopy', 'Pelvic examination', 'Proctoscopy', 'Digital rectal exam'], a: 0, subj: 'Fundamentals' },
      { q: 'You make a medication error. You must:', opts: ['Report immediately, assess patient', 'Hide it', 'Blame pharmacy', 'Only tell the patient'], a: 0, subj: 'Fundamentals' },
      { q: 'Tachypnea means:', opts: ['Rapid breathing', 'Slow breathing', 'Normal breathing', 'No breathing'], a: 0, subj: 'Fundamentals' },
      { q: 'Patient advocacy includes:', opts: ['Speaking up for patient rights and needs', 'Agreeing with doctors always', 'Ignoring concerns', 'Deferring to family only'], a: 0, subj: 'Fundamentals' },
      { q: 'When applying a dressing, you:', opts: ['Use clean or sterile technique as ordered', 'Reuse old dressing', 'Leave wound exposed', 'Apply tight bandage'], a: 0, subj: 'Fundamentals' },
      { q: 'A patient asks to see their chart. You:', opts: ['Facilitate per facility policy', 'Refuse always', 'Give them the original', 'Tell them no'], a: 0, subj: 'Fundamentals' },
      { q: 'Orthopnea is:', opts: ['Shortness of breath when lying flat', 'Easy breathing', 'No breathing', 'Fast breathing'], a: 0, subj: 'Fundamentals' },
      { q: 'Accountability in nursing means:', opts: ['Taking responsibility for your actions', 'Blaming others', 'Hiding errors', 'Avoiding documentation'], a: 0, subj: 'Fundamentals' },
      { q: 'Nasogastric tube placement is verified by:', opts: ['X-ray confirmation', 'Auscultation only', 'Patient feeling', 'No verification'], a: 0, subj: 'Fundamentals' },
      { q: 'Gift-giving from patients:', opts: ['May have policy limits; avoid conflict of interest', 'Always accept', 'Refuse always', 'Demand more'], a: 0, subj: 'Fundamentals' },
      { q: 'Cyanosis indicates:', opts: ['Blue tint from lack of oxygen', 'Healthy color', 'Jaundice', 'Pale only'], a: 0, subj: 'Fundamentals' },
      { q: 'Scope of practice means:', opts: ['Legal limits of your role', 'What you want to do', 'Whatever doctor says', 'No limits'], a: 0, subj: 'Fundamentals' },
      { q: 'Catheter care includes:', opts: ['Clean per protocol, secure, check drainage', 'Leave unchanged', 'Ignore output', 'Remove daily'], a: 0, subj: 'Fundamentals' },
      { q: 'Social media and patient info:', opts: ['Never mix; no posting patient details', 'OK if no names', 'OK with consent', 'Always allowed'], a: 0, subj: 'Fundamentals' },
      { q: 'Edema is:', opts: ['Swelling from fluid retention', 'Dry skin', 'Bruising', 'Rash'], a: 0, subj: 'Fundamentals' },
      { q: 'Mandatory reporting applies to:', opts: ['Abuse, neglect, certain diseases', 'Nothing', 'Only crimes', 'Only medication errors'], a: 0, subj: 'Fundamentals' },
      { q: 'Before suctioning, you:', opts: ['Hyperoxygenate the patient', 'Suction quickly', 'Skip pre-oxygenation', 'Never suction'], a: 0, subj: 'Fundamentals' },
      { q: 'Impaired colleague protocol:', opts: ['Report to protect patients', 'Cover for them', 'Ignore', 'Tell patients'], a: 0, subj: 'Fundamentals' },
      { q: 'Oxygen is a medication and requires:', opts: ['Order, monitoring, safety precautions', 'No order', 'Patient request only', 'No monitoring'], a: 0, subj: 'Fundamentals' },
      { q: 'End-of-life care prioritizes:', opts: ['Comfort, dignity, patient wishes', 'Cure only', 'Family wishes over patient', 'Avoiding discussion'], a: 0, subj: 'Fundamentals' },
      { q: 'Surgical asepsis means:', opts: ['Sterile technique, no pathogens', 'Clean technique', 'Handwashing only', 'No special care'], a: 0, subj: 'Fundamentals' },
      { q: 'Moral distress occurs when:', opts: ['You know right action but cannot do it', 'Patient is difficult', 'Family disagrees', 'Shift is long'], a: 0, subj: 'Fundamentals' },
      { q: 'Tracheostomy care includes:', opts: ['Cleaning stoma, securing tube, suctioning', 'Ignoring tube', 'Removing daily', 'No hygiene'], a: 0, subj: 'Fundamentals' },
      { q: 'Whistleblower protection exists for:', opts: ['Those reporting illegal/unethical acts', 'No one', 'Only supervisors', 'Only doctors'], a: 0, subj: 'Fundamentals' },
      { q: 'Normal urine output is about:', opts: ['30 mL/hour or 0.5 mL/kg/hr', '10‚Äì20 mL/hour', '50‚Äì80 mL/hour', '100‚Äì150 mL/hour'], a: 0, subj: 'Fundamentals' },
      { q: 'Boundary violation examples:', opts: ['Romantic relationship, over-involvement', 'Being kind', 'Documenting', 'Advocating'], a: 0, subj: 'Fundamentals' },
      { q: 'When discontinuing IV, you:', opts: ['Apply pressure, check site, dispose safely', 'Pull quickly', 'Leave catheter in', 'No pressure needed'], a: 0, subj: 'Fundamentals' },
      { q: 'Quality improvement focuses on:', opts: ['Improving outcomes and safety', 'Blaming individuals', 'Cutting costs only', 'Ignoring data'], a: 0, subj: 'Fundamentals' },
      { q: 'Syncope is:', opts: ['Fainting or loss of consciousness', 'Seizure only', 'Stroke', 'Headache'], a: 0, subj: 'Fundamentals' },
      { q: 'Ethical dilemma resolution may use:', opts: ['Ethics committee, framework, dialogue', 'Ignoring', 'Guessing', 'Picking randomly'], a: 0, subj: 'Fundamentals' },
      { q: 'Central line care requires:', opts: ['Sterile technique, dressing changes, assessment', 'No special care', 'Daily removal', 'Ignore site'], a: 0, subj: 'Fundamentals' },
      { q: 'Informed consent can be withdrawn:', opts: ['At any time by the patient', 'Never', 'Only by doctor', 'Only by family'], a: 0, subj: 'Fundamentals' },
      { q: 'Oliguria is:', opts: ['Decreased urine output', 'Increased output', 'No output', 'Blood in urine'], a: 0, subj: 'Fundamentals' },
      { q: 'Professional boundaries protect:', opts: ['Patient and nurse', 'Only nurse', 'Only patient', 'No one'], a: 0, subj: 'Fundamentals' },
      { q: 'Pain assessment uses:', opts: ['Patient self-report as primary', 'Staff opinion only', 'Vital signs only', 'Family report only'], a: 0, subj: 'Fundamentals' },
      { q: 'Consent for minors typically requires:', opts: ['Parent/guardian in most cases', 'Child only', 'No consent', 'Teacher'], a: 0, subj: 'Fundamentals' },
      { q: 'Anuria is:', opts: ['No urine output', 'High output', 'Bloody urine', 'Cloudy urine'], a: 0, subj: 'Fundamentals' },
      { q: 'Conflict of interest means:', opts: ['Personal gain may override patient care', 'Having opinions', 'Working overtime', 'Being tired'], a: 0, subj: 'Fundamentals' },
      { q: 'Fall risk assessment includes:', opts: ['History, mobility, medications, environment', 'Age only', 'Nothing', 'Guardian opinion'], a: 0, subj: 'Fundamentals' },
      { q: 'Telehealth requires:', opts: ['Patient consent, privacy, appropriate use', 'No consent', 'Any device', 'No privacy needed'], a: 0, subj: 'Fundamentals' },
      { q: 'Pallor means:', opts: ['Paleness', 'Redness', 'Blue tint', 'Yellow tint'], a: 0, subj: 'Fundamentals' },
      { q: 'Moral courage is:', opts: ['Standing up for what is right despite risk', 'Avoiding conflict', 'Following orders blindly', 'Ignoring problems'], a: 0, subj: 'Fundamentals' },
      /* Med-Surg */
      { q: 'Post-op ileus is characterized by:', opts: ['Absent bowel sounds, no flatus', 'Abdominal distension', 'Nausea and vomiting', 'Delayed gastric emptying'], a: 0, subj: 'Med-Surg' },
      { q: 'Deep vein thrombosis (DVT) prevention includes:', opts: ['Early ambulation, SCDs, anticoagulants', 'Compression stockings', 'Leg exercises', 'Adequate hydration'], a: 0, subj: 'Med-Surg' },
      { q: 'Signs of pulmonary embolism include:', opts: ['Sudden dyspnea, chest pain, tachycardia', 'Pleuritic chest pain', 'Hemoptysis', 'Sense of doom'], a: 0, subj: 'Med-Surg' },
      { q: 'CHF patients should be taught to:', opts: ['Weigh daily, limit sodium, report edema', 'Restrict fluids to 2L', 'Monitor daily weights', 'Report shortness of breath'], a: 0, subj: 'Med-Surg' },
      { q: 'Acute MI (heart attack) classic symptom is:', opts: ['Crushing substernal chest pain', 'Radiating to left arm', 'Jaw and back pain', 'Diaphoresis and nausea'], a: 0, subj: 'Med-Surg' },
      { q: 'Hypoglycemia symptoms include:', opts: ['Sweating, tremor, confusion, hunger', 'Polyuria and polydipsia', 'Kussmaul respirations', 'Fruity breath odor'], a: 0, subj: 'Med-Surg' },
      { q: 'Diabetic ketoacidosis (DKA) presents with:', opts: ['Hyperglycemia, ketones, metabolic acidosis', 'Hypoglycemia', 'Normal blood sugar', 'Alkalosis'], a: 0, subj: 'Med-Surg' },
      { q: 'COPD patients need:', opts: ['Low-flow oxygen, pursed-lip breathing', 'High-flow oxygen (6L+) always', 'Oxygen only when SpO2 below 90%', 'Continuous positive pressure only'], a: 0, subj: 'Med-Surg' },
      { q: 'Post-op atelectasis is prevented by:', opts: ['Incentive spirometry, coughing, turning', 'Bed rest', 'No deep breathing', 'Fluid restriction'], a: 0, subj: 'Med-Surg' },
      { q: 'Acute kidney injury may cause:', opts: ['Electrolyte imbalance, fluid overload', 'Hypovolemia only', 'No changes', 'Hypernatremia only'], a: 0, subj: 'Med-Surg' },
      { q: 'Cushing\'s triad (ICP) includes:', opts: ['Hypertension, bradycardia, irregular respirations', 'Hypotension, tachycardia', 'Fever, chills', 'Rash, itching'], a: 0, subj: 'Med-Surg' },
      { q: 'Stroke (CVA) assessment uses:', opts: ['FAST: Face, Arms, Speech, Time', 'Only BP check', 'X-ray', 'No urgent assessment'], a: 0, subj: 'Med-Surg' },
      { q: 'SIADH causes:', opts: ['Hyponatremia, diluted blood', 'Hypernatremia', 'Hypervolemia', 'Dehydration'], a: 0, subj: 'Med-Surg' },
      { q: 'Addisonian crisis presents with:', opts: ['Hypotension, weakness, hyperpigmentation', 'Hypertension', 'Hyperglycemia', 'No symptoms'], a: 0, subj: 'Med-Surg' },
      { q: 'Post-thyroidectomy priority is:', opts: ['Airway, bleeding, hypocalcemia', 'Eating immediately', 'Ambulation', 'IV removal'], a: 0, subj: 'Med-Surg' },
      { q: 'Cirrhosis patients should avoid:', opts: ['Alcohol, hepatotoxic drugs, high protein', 'All food', 'Fluids', 'Rest'], a: 0, subj: 'Med-Surg' },
      { q: 'Heparin is reversed with:', opts: ['Protamine sulfate', 'Vitamin K', 'Fresh frozen plasma', 'Factor VIIa'], a: 0, subj: 'Med-Surg' },
      { q: 'Warfarin is reversed with:', opts: ['Vitamin K', 'Protamine sulfate', 'Andexanet alfa', 'Idarucizumab'], a: 0, subj: 'Med-Surg' },
      { q: 'Paralytic ileus post-op is normal for:', opts: ['24‚Äì72 hours', '12‚Äì24 hours', '3‚Äì5 days', 'Up to 1 week'], a: 0, subj: 'Med-Surg' },
      { q: 'T tube care includes:', opts: ['Keep below drainage level, clamp before meals', 'Remove immediately', 'No drainage check', 'Elevate always'], a: 0, subj: 'Med-Surg' },
      { q: 'Colostomy output should be:', opts: ['Pasty, formed (depends on location)', 'Always liquid', 'Always solid', 'No output'], a: 0, subj: 'Med-Surg' },
      { q: 'Bowel prep before colonoscopy aims to:', opts: ['Empty colon for clear visualization', 'Hydrate only', 'Give antibiotics', 'Sedate'], a: 0, subj: 'Med-Surg' },
      { q: 'ARDS management includes:', opts: ['Low tidal volume, PEEP, prone positioning', 'High tidal volume', 'No ventilator', 'Fluid boluses'], a: 0, subj: 'Med-Surg' },
      { q: 'Sepsis early signs include:', opts: ['Fever, tachycardia, tachypnea, altered mental status', 'Bradycardia only', 'Hypothermia only', 'No fever'], a: 0, subj: 'Med-Surg' },
      { q: 'Surgical wound dehiscence requires:', opts: ['Notify provider, cover with sterile saline dressing', 'Push organs back', 'Suture at bedside', 'Ignore'], a: 0, subj: 'Med-Surg' },
      { q: 'Evisceration means:', opts: ['Organs protruding through wound', 'Infection', 'Normal healing', 'Scar formation'], a: 0, subj: 'Med-Surg' },
      { q: 'NG tube irrigation uses:', opts: ['Normal saline, gentle pressure', 'Water only', 'Never irrigate', 'HCl'], a: 0, subj: 'Med-Surg' },
      { q: 'Fistula between bowel and skin causes:', opts: ['Drainage of stool through skin', 'No drainage', 'Urine only', 'Blood only'], a: 0, subj: 'Med-Surg' },
      { q: 'Peritonitis signs include:', opts: ['Rigid abdomen, rebound tenderness, fever', 'Soft abdomen', 'No pain', 'Rash'], a: 0, subj: 'Med-Surg' },
      { q: 'Pancreatitis patients should:', opts: ['NPO, NG tube, pain control', 'Eat normally', 'High fat diet', 'No pain meds'], a: 0, subj: 'Med-Surg' },
      /* Psych */
      { q: 'Therapeutic communication includes:', opts: ['Open-ended questions, reflection, silence', 'Active listening', 'Empathetic responses', 'Clarifying and paraphrasing'], a: 0, subj: 'Psych' },
      { q: 'A patient says "Nobody cares." Best response:', opts: ['"It sounds like you feel alone."', '"I care about you."', '"Can you tell me more?"', '"That must be difficult."'], a: 0, subj: 'Psych' },
      { q: 'Defense mechanism: projecting means:', opts: ['Attributing own feelings to others', 'Displacing onto someone else', 'Rationalizing behavior', 'Denying reality'], a: 0, subj: 'Psych' },
      { q: 'Milieu therapy emphasizes:', opts: ['Structured, therapeutic environment', 'Isolation', 'Unlimited freedom', 'No structure'], a: 0, subj: 'Psych' },
      { q: 'PRN medications in psych are used for:', opts: ['Agitation, anxiety, insomnia as needed', 'Routine only', 'Never', 'With every meal'], a: 0, subj: 'Psych' },
      { q: 'Extrapyramidal side effects (EPS) of antipsychotics include:', opts: ['Dystonia, akathisia, parkinsonism', 'Weight gain only', 'Dry mouth only', 'No side effects'], a: 0, subj: 'Psych' },
      { q: 'Tardive dyskinesia is:', opts: ['Involuntary movements from long-term antipsychotics', 'Acute reaction', 'Allergic reaction', 'Curable easily'], a: 0, subj: 'Psych' },
      { q: 'Neuroleptic malignant syndrome (NMS) includes:', opts: ['Fever, rigidity, altered mental status', 'Rash only', 'Mild sedation', 'No symptoms'], a: 0, subj: 'Psych' },
      { q: 'SSRIs may cause initially:', opts: ['Increased anxiety, GI upset, sexual dysfunction', 'No side effects', 'Hypertension', 'Hypoglycemia'], a: 0, subj: 'Psych' },
      { q: 'Lithium requires:', opts: ['Therapeutic levels, fluid balance, thyroid/renal monitoring', 'No monitoring', 'Weekly only', 'No labs'], a: 0, subj: 'Psych' },
      { q: 'Suicide risk is highest when:', opts: ['Depression lifts and energy returns', 'Deeply depressed', 'Asleep', 'With family'], a: 0, subj: 'Psych' },
      { q: 'Contracting for safety means:', opts: ['Patient agrees to seek help before self-harm', 'Legal document', 'Discharge', 'No suicide risk'], a: 0, subj: 'Psych' },
      { q: 'Transference is when:', opts: ['Patient redirects feelings from past onto nurse', 'Nurse likes patient', 'Family intervenes', 'Doctor disagrees'], a: 0, subj: 'Psych' },
      { q: 'Countertransference is when:', opts: ['Nurse\'s own feelings affect care', 'Patient is angry', 'Family is present', 'Medication works'], a: 0, subj: 'Psych' },
      { q: 'Schizophrenia positive symptoms include:', opts: ['Hallucinations, delusions, disorganized speech', 'Flat affect only', 'Social withdrawal only', 'No symptoms'], a: 0, subj: 'Psych' },
      { q: 'Schizophrenia negative symptoms include:', opts: ['Flat affect, avolition, anhedonia', 'Hallucinations', 'Delusions', 'Agitation'], a: 0, subj: 'Psych' },
      { q: 'Bipolar manic episode features:', opts: ['Elevated mood, grandiosity, decreased need for sleep', 'Depression only', 'Anxiety only', 'No mood change'], a: 0, subj: 'Psych' },
      { q: 'Borderline personality disorder may show:', opts: ['Splitting, fear of abandonment, impulsivity', 'No emotions', 'Stable relationships', 'No treatment needed'], a: 0, subj: 'Psych' },
      { q: 'Splitting means:', opts: ['Seeing people as all good or all bad', 'Dividing tasks', 'Sharing feelings', 'Avoiding conflict'], a: 0, subj: 'Psych' },
      { q: 'Delirium differs from dementia in that delirium:', opts: ['Is acute, fluctuating, often reversible', 'Is chronic', 'Has no confusion', 'Is irreversible'], a: 0, subj: 'Psych' },
      { q: 'Crisis intervention focuses on:', opts: ['Immediate safety, brief support, referral', 'Long therapy', 'Medication only', 'Family only'], a: 0, subj: 'Psych' },
      { q: 'De-escalation techniques include:', opts: ['Calm voice, space, avoid arguing', 'Restraints first', 'Yelling back', 'Ignoring'], a: 0, subj: 'Psych' },
      { q: 'Restraints in psych require:', opts: ['Order, least restrictive, frequent reassessment', 'No order', 'Family consent only', 'Permanent use'], a: 0, subj: 'Psych' },
      { q: 'Anorexia nervosa may cause:', opts: ['Electrolyte imbalance, cardiac issues, osteoporosis', 'Obesity', 'No physical effects', 'Hypertension'], a: 0, subj: 'Psych' },
      { q: 'Bulimia involves:', opts: ['Binge eating and purging', 'Only restricting', 'Only overeating', 'No eating'], a: 0, subj: 'Psych' },
      { q: 'PTSD symptoms include:', opts: ['Flashbacks, avoidance, hyperarousal', 'No memory', 'Only anxiety', 'Only depression'], a: 0, subj: 'Psych' },
      { q: 'ECT (electroconvulsive therapy) is used for:', opts: ['Severe depression, catatonia when other treatments fail', 'First-line always', 'Anxiety only', 'Personality disorders'], a: 0, subj: 'Psych' },
      { q: 'Monoamine oxidase inhibitors (MAOIs) require:', opts: ['Tyramine-free diet, drug interactions', 'No diet', 'High protein', 'No restrictions'], a: 0, subj: 'Psych' },
      { q: 'Serotonin syndrome symptoms include:', opts: ['Agitation, confusion, hyperthermia, tremor', 'None', 'Hypothermia', 'Bradycardia'], a: 0, subj: 'Psych' },
      { q: 'A patient with paranoia may need:', opts: ['Clear explanations, consistency, low stimulation', 'Secrets', 'Surprises', 'Crowds'], a: 0, subj: 'Psych' },
      /* Additional Fundamentals */
      { q: 'Sharps should be disposed in:', opts: ['Puncture-resistant sharps container', 'Regular trash bag', 'Red bag only', 'Sink'], a: 0, subj: 'Fundamentals' },
      { q: 'A pulse oximeter measures:', opts: ['Oxygen saturation and pulse rate', 'Blood pressure only', 'Temperature only', 'Respiratory rate'], a: 0, subj: 'Fundamentals' },
      { q: 'RACE in fire safety stands for:', opts: ['Rescue, Alarm, Contain, Extinguish', 'Rescue, Alert, Confine, Evacuate', 'Remove, Activate, Contain, Exit', 'Rescue, Announce, Control, Extinguish'], a: 0, subj: 'Fundamentals' },
      { q: 'PASS for fire extinguisher means:', opts: ['Pull, Aim, Squeeze, Sweep', 'Pull pin, Aim, Squeeze, Sweep base', 'Point, Activate, Spray, Sweep', 'Press, Aim, Squeeze, Sweep'], a: 0, subj: 'Fundamentals' },
      { q: 'Correct order for donning PPE is:', opts: ['Gown, mask, goggles, gloves', 'Gown, mask, face shield, gloves', 'Gown, respirator, goggles, gloves', 'Mask, gown, gloves, goggles'], a: 0, subj: 'Fundamentals' },
      { q: 'Correct doffing order for PPE is:', opts: ['Gloves, goggles, gown, mask', 'Gown, gloves, goggles, mask', 'Mask first, then rest', 'All at once'], a: 0, subj: 'Fundamentals' },
      { q: 'A standing order differs from a protocol in that:', opts: ['It is pre-approved for specific situations', 'It requires physician presence', 'It cannot be delegated', 'It expires daily'], a: 0, subj: 'Fundamentals' },
      { q: 'First step in nursing process is:', opts: ['Assessment', 'Diagnosis', 'Planning', 'Implementation'], a: 0, subj: 'Fundamentals' },
      { q: 'Maslow\'s hierarchy prioritizes:', opts: ['Physiological needs first', 'Self-actualization first', 'Safety after love', 'Esteem before safety'], a: 0, subj: 'Fundamentals' },
      { q: 'Active listening involves:', opts: ['Reflecting, summarizing, minimal encouragers', 'Giving advice quickly', 'Finishing patient sentences', 'Redirecting to solutions'], a: 0, subj: 'Fundamentals' },
      /* Additional Med-Surg */
      { q: 'Signs of fluid overload include:', opts: ['Crackles, edema, weight gain, JVD', 'Dry mucous membranes only', 'Hypotension', 'Decreased urine output'], a: 0, subj: 'Med-Surg' },
      { q: 'Atrial fibrillation increases risk of:', opts: ['Stroke from clot formation', 'MI only', 'DVT only', 'Pulmonary edema only'], a: 0, subj: 'Med-Surg' },
      { q: 'Patient on diuretic should be taught to:', opts: ['Take in morning, report dizziness', 'Take at bedtime', 'Double dose if missed', 'Avoid all potassium'], a: 0, subj: 'Med-Surg' },
      { q: 'Priority intervention for chest tube disconnection:', opts: ['Clamp tube close to chest, call provider', 'Reconnect immediately', 'Place in water', 'Leave open to air'], a: 0, subj: 'Med-Surg' },
      { q: 'Signs of compartment syndrome include:', opts: ['Pain, pallor, pulselessness, paresthesia', 'Warmth and redness only', 'Decreased pain', 'Normal pulses'], a: 0, subj: 'Med-Surg' },
      { q: 'MET form for fall risk means:', opts: ['Multifactorial assessment and intervention', 'Minimum exposure time', 'Maximum effort test', 'Medication evaluation tool'], a: 0, subj: 'Med-Surg' },
      { q: 'C. diff requires:', opts: ['Contact precautions, soap and water handwash', 'Droplet precautions only', 'Alcohol hand sanitizer only', 'No special precautions'], a: 0, subj: 'Med-Surg' },
      { q: 'MRSA colonization vs infection:', opts: ['Colonization = present without symptoms', 'Same treatment for both', 'Colonization requires isolation', 'Infection needs no precautions'], a: 0, subj: 'Med-Surg' },
      { q: 'Priority for post-op nausea and vomiting:', opts: ['Assess airway, position on side', 'Give antiemetic immediately', 'Document only', 'Increase PO fluids'], a: 0, subj: 'Med-Surg' },
      { q: 'Hyperkalemia EKG changes include:', opts: ['Peaked T waves, widened QRS', 'Flat T waves only', 'Shortened QT', 'Normal EKG'], a: 0, subj: 'Med-Surg' },
      /* Additional Psych */
      { q: 'Flight of ideas is seen in:', opts: ['Manic episodes', 'Depression', 'Anxiety', 'Schizophrenia negative symptoms'], a: 0, subj: 'Psych' },
      { q: 'Word salad refers to:', opts: ['Incoherent jumble of words', 'Organized list making', 'Repetitive phrases', 'Silent refusal to speak'], a: 0, subj: 'Psych' },
      { q: 'Priority for acutely suicidal patient:', opts: ['Maintain safety, 1:1 if needed', 'Discuss feelings at length', 'Allow private time', 'Delay hospitalization'], a: 0, subj: 'Psych' },
      { q: 'Akathisia from antipsychotics presents as:', opts: ['Motor restlessness, inability to sit still', 'Drowsiness', 'Rigidity', 'Tremor at rest'], a: 0, subj: 'Psych' },
      { q: 'Black box warning for antidepressants:', opts: ['Increased suicidal ideation in young adults', 'Weight gain', 'Sexual dysfunction', 'Withdrawal symptoms'], a: 0, subj: 'Psych' },
      /* Pharmacology */
      { q: 'ACE inhibitors (e.g., lisinopril) may cause:', opts: ['Dry cough, angioedema, hyperkalemia', 'Hypotension and dizziness', 'Renal impairment', 'Taste disturbance'], a: 0, subj: 'Pharmacology' },
      { q: 'Beta-blockers should be used cautiously in:', opts: ['Asthma, heart block, bradycardia', 'COPD and diabetes', 'Heart failure', 'Thyroid disorders'], a: 0, subj: 'Pharmacology' },
      { q: 'Metformin should be held before:', opts: ['Contrast dye procedures (risk of lactic acidosis)', 'Surgery only', 'Meals', 'Exercise'], a: 0, subj: 'Pharmacology' },
      { q: 'Warfarin interacts with:', opts: ['Vitamin K-rich foods, many drugs, NSAIDs', 'Only alcohol', 'Only aspirin', 'Nothing significant'], a: 0, subj: 'Pharmacology' },
      { q: 'Aminoglycosides (e.g., gentamicin) can cause:', opts: ['Nephrotoxicity, ototoxicity', 'Hepatotoxicity only', 'No major toxicity', 'Bone marrow suppression'], a: 0, subj: 'Pharmacology' },
      { q: 'Opioids require monitoring for:', opts: ['Respiratory depression, constipation, dependence', 'Hypertension only', 'Hyperactivity', 'Hypoglycemia'], a: 0, subj: 'Pharmacology' },
      { q: 'Naloxone is used to reverse:', opts: ['Opioid overdose', 'Benzodiazepine overdose', 'Acetaminophen overdose', 'Aspirin overdose'], a: 0, subj: 'Pharmacology' },
      { q: 'NSAIDs should be used cautiously in patients with:', opts: ['Renal impairment, GI ulcers, bleeding disorders', 'No specific cautions', 'Diabetes only', 'Asthma only'], a: 0, subj: 'Pharmacology' },
      { q: 'Digoxin toxicity signs include:', opts: ['Nausea, vision changes, cardiac arrhythmias', 'Hypertension', 'Hyperkalemia', 'Hyperglycemia'], a: 0, subj: 'Pharmacology' },
      { q: 'Heparin is monitored with:', opts: ['aPTT (activated partial thromboplastin time)', 'PT/INR', 'CBC only', 'No monitoring needed'], a: 0, subj: 'Pharmacology' },
      { q: 'Insulin should be given:', opts: ['Subcutaneously (typically abdomen, thigh, arm)', 'Orally', 'Intramuscular only', 'Intravenously only'], a: 0, subj: 'Pharmacology' },
      { q: 'IV push medications require:', opts: ['Slow administration, compatibility check', 'Rapid push', 'No dilution', 'Oral alternative preferred'], a: 0, subj: 'Pharmacology' },
      { q: 'Calcium channel blockers (e.g., amlodipine) can cause:', opts: ['Peripheral edema, dizziness, hypotension', 'Hyperkalemia only', 'Dry cough', 'Hyperglycemia'], a: 0, subj: 'Pharmacology' },
      { q: 'Statins may cause:', opts: ['Myopathy, elevated liver enzymes', 'Hypotension', 'Hypoglycemia', 'Hyperkalemia'], a: 0, subj: 'Pharmacology' },
      { q: 'Anticholinergic side effects include:', opts: ['Dry mouth, urinary retention, constipation', 'Diarrhea', 'Increased sweating', 'Bradycardia'], a: 0, subj: 'Pharmacology' },
      { q: 'Vancomycin requires:', opts: ['Trough level monitoring, slow IV infusion', 'Peak levels only', 'No levels', 'Oral administration only'], a: 0, subj: 'Pharmacology' },
      { q: 'Phenytoin (Dilantin) has a narrow therapeutic index and:', opts: ['Requires blood level monitoring', 'No monitoring needed', 'Is safe in pregnancy', 'Has no drug interactions'], a: 0, subj: 'Pharmacology' },
      { q: 'Corticosteroids (e.g., prednisone) long-term use may cause:', opts: ['Hyperglycemia, osteoporosis, immunosuppression', 'Hypoglycemia only', 'Weight loss', 'Hyponatremia'], a: 0, subj: 'Pharmacology' },
      { q: 'Fluoroquinolones (e.g., ciprofloxacin) can cause:', opts: ['Tendon rupture, QT prolongation', 'Nephrotoxicity only', 'No major risks', 'Ototoxicity only'], a: 0, subj: 'Pharmacology' },
      { q: 'Proton pump inhibitors (PPIs) long-term may increase risk of:', opts: ['Fractures, C. diff, magnesium deficiency', 'Hypertension', 'Hyperkalemia', 'No risks'], a: 0, subj: 'Pharmacology' },
      /* More Fundamentals (20) */
      { q: 'Jaundice presents as:', opts: ['Yellow tint to skin and sclera', 'Blue tint', 'Pale skin', 'Red rash'], a: 0, subj: 'Fundamentals' },
      { q: 'Hematemesis means:', opts: ['Vomiting blood', 'Blood in stool', 'Blood in urine', 'Nosebleed'], a: 0, subj: 'Fundamentals' },
      { q: 'Melena refers to:', opts: ['Dark, tarry stools from digested blood', 'Bright red blood in stool', 'Pale stools', 'Diarrhea'], a: 0, subj: 'Fundamentals' },
      { q: 'Nosocomial infection means:', opts: ['Acquired in a healthcare setting', 'Community-acquired', 'Congenital', 'Viral only'], a: 0, subj: 'Fundamentals' },
      { q: 'Turgor assessment checks:', opts: ['Skin elasticity for hydration status', 'Blood pressure', 'Heart rate', 'Temperature'], a: 0, subj: 'Fundamentals' },
      { q: 'Reflex assessment uses:', opts: ['Graded 0‚Äì4 scale', 'Yes/no only', 'Pain scale', 'No grading'], a: 0, subj: 'Fundamentals' },
      { q: 'Percussion assesses:', opts: ['Density of underlying structures', 'Skin color only', 'Pulse strength', 'Temperature'], a: 0, subj: 'Fundamentals' },
      { q: 'Auscultation involves:', opts: ['Listening with stethoscope', 'Tapping body surfaces', 'Palpating', 'Observing only'], a: 0, subj: 'Fundamentals' },
      { q: 'Stridor indicates:', opts: ['Upper airway obstruction', 'Lower airway disease', 'Normal breathing', 'Heart murmur'], a: 0, subj: 'Fundamentals' },
      { q: 'Wheezing suggests:', opts: ['Narrowed lower airways', 'Upper airway blockage', 'Normal lungs', 'Cardiac issue'], a: 0, subj: 'Fundamentals' },
      { q: 'Crepitus indicates:', opts: ['Air or gas under tissue', 'Normal joint movement', 'Muscle spasm', 'Bone fracture only'], a: 0, subj: 'Fundamentals' },
      { q: 'Phlebitis is:', opts: ['Inflammation of a vein', 'Artery blockage', 'Lymph node swelling', 'Skin infection'], a: 0, subj: 'Fundamentals' },
      { q: 'Extravasation means:', opts: ['IV fluid leaking into surrounding tissue', 'Normal IV flow', 'Vein collapse', 'Clot formation'], a: 0, subj: 'Fundamentals' },
      { q: 'PO means:', opts: ['By mouth (orally)', 'As needed', 'Every hour', 'Nothing by mouth'], a: 0, subj: 'Fundamentals' },
      { q: 'IM means:', opts: ['Intramuscular', 'Intravenous', 'By mouth', 'Subcutaneous'], a: 0, subj: 'Fundamentals' },
      { q: 'Subcutaneous injection angle is typically:', opts: ['45‚Äì90 degrees', '15‚Äì30 degrees', '0 degrees', '180 degrees'], a: 0, subj: 'Fundamentals' },
      { q: 'Z-track technique is used for:', opts: ['IM injections to prevent leakage', 'IV starts', 'Subcutaneous', 'Oral medications'], a: 0, subj: 'Fundamentals' },
      { q: 'Asepsis means:', opts: ['Absence of pathogens', 'Sterilization', 'Disinfection only', 'Clean technique'], a: 0, subj: 'Fundamentals' },
      { q: 'Medical asepsis (clean technique) aims to:', opts: ['Reduce microorganisms', 'Eliminate all pathogens', 'Sterilize equipment', 'No specific aim'], a: 0, subj: 'Fundamentals' },
      { q: 'Contaminated items should be:', opts: ['Disposed of or reprocessed per protocol', 'Reused immediately', 'Left at bedside', 'Given to patient'], a: 0, subj: 'Fundamentals' },
      /* More Med-Surg (20) */
      { q: 'Hyperthyroidism symptoms include:', opts: ['Weight loss, tachycardia, heat intolerance', 'Weight gain, bradycardia', 'Cold intolerance', 'Hypotension'], a: 0, subj: 'Med-Surg' },
      { q: 'Hypothyroidism presents with:', opts: ['Fatigue, weight gain, cold intolerance', 'Weight loss, heat intolerance', 'Tachycardia', 'Hyperactivity'], a: 0, subj: 'Med-Surg' },
      { q: 'Myocardial infarction troponin:', opts: ['Increases with heart muscle damage', 'Decreases with MI', 'Unchanged', 'Only used for stroke'], a: 0, subj: 'Med-Surg' },
      { q: 'Asthma attack management includes:', opts: ['Bronchodilators, corticosteroids, oxygen', 'Fluid restriction', 'Bed rest only', 'Antibiotics first'], a: 0, subj: 'Med-Surg' },
      { q: 'Pneumonia crackles are heard:', opts: ['On auscultation, often in lower lobes', 'Only on x-ray', 'Never', 'In heart sounds'], a: 0, subj: 'Med-Surg' },
      { q: 'Urinary retention requires:', opts: ['Catheterization if unable to void', 'Diuretics', 'Fluid restriction', 'No intervention'], a: 0, subj: 'Med-Surg' },
      { q: 'Bowel obstruction presents with:', opts: ['Abdominal distension, absent bowel sounds', 'Diarrhea', 'Hyperactive bowel sounds only', 'No abdominal changes'], a: 0, subj: 'Med-Surg' },
      { q: 'Shock priority intervention is:', opts: ['Restore perfusion, fluid resuscitation', 'Give food', 'Cool the patient', 'Document only'], a: 0, subj: 'Med-Surg' },
      { q: 'Anaphylaxis requires:', opts: ['Epinephrine, airway support, IV fluids', 'Antihistamine only', 'Wait and see', 'Antibiotics'], a: 0, subj: 'Med-Surg' },
      { q: 'Hematocrit measures:', opts: ['Percentage of blood that is RBCs', 'White blood cell count', 'Platelet count', 'Hemoglobin only'], a: 0, subj: 'Med-Surg' },
      { q: 'BUN and creatinine indicate:', opts: ['Kidney function', 'Liver function only', 'Heart function', 'Lung function'], a: 0, subj: 'Med-Surg' },
      { q: 'Albumin reflects:', opts: ['Nutritional status, liver function', 'Kidney function only', 'Cardiac output', 'Respiratory status'], a: 0, subj: 'Med-Surg' },
      { q: 'INR monitors:', opts: ['Anticoagulation (e.g., warfarin)', 'Blood sugar', 'Kidney function', 'Liver function'], a: 0, subj: 'Med-Surg' },
      { q: 'Osteoporosis increases risk of:', opts: ['Fractures', 'Infection only', 'Bleeding', 'Stroke'], a: 0, subj: 'Med-Surg' },
      { q: 'Rheumatoid arthritis is:', opts: ['Autoimmune, systemic', 'Wear and tear only', 'Infectious', 'Trauma-related'], a: 0, subj: 'Med-Surg' },
      { q: 'Gout is caused by:', opts: ['Uric acid crystal buildup', 'Calcium deposits', 'Infection', 'Trauma'], a: 0, subj: 'Med-Surg' },
      { q: 'Guillain-Barr√© syndrome affects:', opts: ['Peripheral nerves, ascending weakness', 'Brain only', 'Heart', 'Kidneys'], a: 0, subj: 'Med-Surg' },
      { q: 'Multiple sclerosis involves:', opts: ['Demyelination of CNS', 'Peripheral neuropathy', 'Muscle degeneration', 'Bone loss'], a: 0, subj: 'Med-Surg' },
      { q: 'Parkinson\'s disease hallmark is:', opts: ['Tremor, rigidity, bradykinesia', 'Weakness', 'Seizures', 'Memory loss only'], a: 0, subj: 'Med-Surg' },
      { q: 'ALS (Lou Gehrig\'s disease) affects:', opts: ['Motor neurons, progressive weakness', 'Sensory nerves only', 'Heart', 'Kidneys'], a: 0, subj: 'Med-Surg' },
      /* More Psych (20) */
      { q: 'Denial as defense mechanism means:', opts: ['Refusing to acknowledge reality', 'Blaming others', 'Making excuses', 'Acting opposite'], a: 0, subj: 'Psych' },
      { q: 'Rationalization means:', opts: ['Justifying behavior with logical excuses', 'Forgetting entirely', 'Redirecting feelings', 'Reverting to earlier stage'], a: 0, subj: 'Psych' },
      { q: 'Regression is:', opts: ['Reverting to earlier developmental stage', 'Moving forward', 'Staying neutral', 'Avoiding growth'], a: 0, subj: 'Psych' },
      { q: 'Sublimation redirects unacceptable urges into:', opts: ['Socially acceptable activities', 'Aggression', 'Withdrawal', 'Denial'], a: 0, subj: 'Psych' },
      { q: 'Displacement means:', opts: ['Redirecting feelings to safer target', 'Expressing directly', 'Suppressing entirely', 'Forgetting'], a: 0, subj: 'Psych' },
      { q: 'Antisocial personality disorder features:', opts: ['Disregard for others, lack of remorse', 'Anxiety', 'Depression', 'Hallucinations'], a: 0, subj: 'Psych' },
      { q: 'Obsessive-compulsive disorder involves:', opts: ['Intrusive thoughts and repetitive behaviors', 'Only depression', 'Only anxiety', 'Mood swings'], a: 0, subj: 'Psych' },
      { q: 'Generalized anxiety disorder includes:', opts: ['Excessive worry about many things', 'Single phobia only', 'Panic attacks only', 'No physical symptoms'], a: 0, subj: 'Psych' },
      { q: 'Panic disorder features:', opts: ['Sudden intense fear, physical symptoms', 'Gradual anxiety', 'Only worry', 'No physical component'], a: 0, subj: 'Psych' },
      { q: 'Phobia is:', opts: ['Irrational fear of specific object/situation', 'General anxiety', 'Depression', 'Psychosis'], a: 0, subj: 'Psych' },
      { q: 'Dissociative identity disorder involves:', opts: ['Multiple distinct identities', 'Memory loss only', 'Depersonalization only', 'Anxiety'], a: 0, subj: 'Psych' },
      { q: 'Somatic symptom disorder involves:', opts: ['Physical symptoms without medical explanation', 'Faking illness', 'Malingering', 'Hypochondria only'], a: 0, subj: 'Psych' },
      { q: 'Cognitive behavioral therapy (CBT) focuses on:', opts: ['Thoughts, behaviors, and their link', 'Unconscious only', 'Medication only', 'Past trauma only'], a: 0, subj: 'Psych' },
      { q: 'Dialectical behavior therapy (DBT) is used for:', opts: ['Borderline PD, emotional regulation', 'Schizophrenia only', 'Depression only', 'Anxiety only'], a: 0, subj: 'Psych' },
      { q: 'Group therapy benefits include:', opts: ['Support, feedback, shared experience', 'Individual focus only', 'No interaction', 'Medication management'], a: 0, subj: 'Psych' },
      { q: 'Therapeutic milieu includes:', opts: ['Safe, structured, supportive environment', 'Isolation', 'Unlimited freedom', 'Punishment'], a: 0, subj: 'Psych' },
      { q: 'Seclusion is used when:', opts: ['Patient poses imminent danger, least restrictive', 'Convenience', 'Punishment', 'Routine'], a: 0, subj: 'Psych' },
      { q: 'Avolition means:', opts: ['Lack of motivation or initiative', 'Excess energy', 'Anxiety', 'Hallucinations'], a: 0, subj: 'Psych' },
      { q: 'Anhedonia is:', opts: ['Inability to feel pleasure', 'Excess pleasure', 'Anxiety', 'Anger'], a: 0, subj: 'Psych' },
      { q: 'Circumstantiality in speech means:', opts: ['Excessive detail before answering', 'Quick answers', 'Incoherence', 'Silence'], a: 0, subj: 'Psych' },
      /* More Pharmacology (20) */
      { q: 'Aspirin in children may cause:', opts: ['Reye\'s syndrome', 'No risk', 'Hypertension', 'Hypoglycemia'], a: 0, subj: 'Pharmacology' },
      { q: 'Acetaminophen overdose can cause:', opts: ['Hepatotoxicity', 'Nephrotoxicity only', 'Cardiotoxicity', 'Neurotoxicity'], a: 0, subj: 'Pharmacology' },
      { q: 'Acetylcysteine is the antidote for:', opts: ['Acetaminophen overdose', 'Opioid overdose', 'Aspirin overdose', 'Iron overdose'], a: 0, subj: 'Pharmacology' },
      { q: 'Benzodiazepines (e.g., lorazepam) should be tapered to avoid:', opts: ['Withdrawal, seizures', 'Hypertension', 'Hypoglycemia', 'No withdrawal'], a: 0, subj: 'Pharmacology' },
      { q: 'Flumazenil reverses:', opts: ['Benzodiazepines', 'Opioids', 'Acetaminophen', 'Warfarin'], a: 0, subj: 'Pharmacology' },
      { q: 'Thiazide diuretics can cause:', opts: ['Hypokalemia, hyperglycemia', 'Hyperkalemia', 'Hyponatremia only', 'No electrolyte changes'], a: 0, subj: 'Pharmacology' },
      { q: 'Loop diuretics (e.g., furosemide) act on:', opts: ['Ascending loop of Henle', 'Proximal tubule', 'Collecting duct', 'Glomerulus'], a: 0, subj: 'Pharmacology' },
      { q: 'Potassium-sparing diuretics include:', opts: ['Spironolactone, amiloride', 'Furosemide', 'Hydrochlorothiazide', 'Mannitol'], a: 0, subj: 'Pharmacology' },
      { q: 'Nitroglycerin is given for:', opts: ['Angina, sublingual', 'Hypertension', 'Heart failure', 'Arrhythmia'], a: 0, subj: 'Pharmacology' },
      { q: 'Morphine in acute MI helps by:', opts: ['Reducing pain, preload, anxiety', 'Increasing BP', 'Stopping arrhythmia', 'Dissolving clot'], a: 0, subj: 'Pharmacology' },
      { q: 'Anticoagulants do NOT:', opts: ['Dissolve existing clots', 'Prevent new clots', 'Prolong clotting time', 'Require monitoring'], a: 0, subj: 'Pharmacology' },
      { q: 'Antiplatelet drugs (e.g., aspirin, clopidogrel) prevent:', opts: ['Platelet aggregation', 'Fibrin formation', 'Clot dissolution', 'Bleeding'], a: 0, subj: 'Pharmacology' },
      { q: 'H2 blockers (e.g., ranitidine) reduce:', opts: ['Stomach acid production', 'GI motility', 'Pancreatic enzymes', 'Bile secretion'], a: 0, subj: 'Pharmacology' },
      { q: 'Metoclopramide promotes:', opts: ['GI motility, gastric emptying', 'Constipation', 'Acid secretion', 'Bile flow'], a: 0, subj: 'Pharmacology' },
      { q: 'Ondansetron is an:', opts: ['Antiemetic (5-HT3 antagonist)', 'Antacid', 'Laxative', 'Antidiarrheal'], a: 0, subj: 'Pharmacology' },
      { q: 'Diphenhydramine causes:', opts: ['Sedation, anticholinergic effects', 'Stimulation', 'No CNS effects', 'Hypertension'], a: 0, subj: 'Pharmacology' },
      { q: 'Epinephrine in anaphylaxis is given:', opts: ['IM (thigh), repeat as needed', 'Orally', 'Slow IV only', 'Subcutaneous only'], a: 0, subj: 'Pharmacology' },
      { q: 'Albuterol is a:', opts: ['Short-acting bronchodilator (SABA)', 'Corticosteroid', 'Anticholinergic', 'Antihistamine'], a: 0, subj: 'Pharmacology' },
      { q: 'Magnesium sulfate in obstetrics is used for:', opts: ['Seizure prevention in preeclampsia', 'Pain relief', 'Inducing labor', 'Stopping contractions'], a: 0, subj: 'Pharmacology' },
      { q: 'Levothyroxine treats:', opts: ['Hypothyroidism', 'Hyperthyroidism', 'Diabetes', 'Adrenal insufficiency'], a: 0, subj: 'Pharmacology' },
      /* +30 Fundamentals */
      { q: 'Orthostatic hypotension is assessed by:', opts: ['BP and pulse lying, sitting, standing', 'BP only', 'Pulse only', 'No assessment needed'], a: 0, subj: 'Fundamentals' },
      { q: 'The nursing process step after Assessment is:', opts: ['Diagnosis', 'Planning', 'Implementation', 'Evaluation'], a: 0, subj: 'Fundamentals' },
      { q: 'Delegation to UAP (unlicensed assistive personnel) must consider:', opts: ['Scope, competency, supervision', 'Speed only', 'Patient preference only', 'No considerations'], a: 0, subj: 'Fundamentals' },
      { q: 'Critical thinking in nursing involves:', opts: ['Questioning, analyzing, applying standards', 'Following orders blindly', 'Guessing', 'Avoiding decisions'], a: 0, subj: 'Fundamentals' },
      { q: 'Prioritization uses principles such as:', opts: ['ABCs, Maslow, acute vs chronic', 'Alphabetical order', 'Patient request order', 'Doctor preference'], a: 0, subj: 'Fundamentals' },
      { q: 'A focused assessment is:', opts: ['Targeted to specific body system or concern', 'Full head-to-toe only', 'Never used', 'Only for discharge'], a: 0, subj: 'Fundamentals' },
      { q: 'Subjective data comes from:', opts: ['What the patient reports', 'Lab values only', 'Vital signs', 'Physical exam'], a: 0, subj: 'Fundamentals' },
      { q: 'Objective data includes:', opts: ['Observable, measurable findings', 'Patient feelings only', 'Family opinions', 'Guesses'], a: 0, subj: 'Fundamentals' },
      { q: 'A nursing diagnosis differs from medical diagnosis in that it:', opts: ['Addresses human response to condition', 'Names the disease', 'Requires MD order', 'Is the same thing'], a: 0, subj: 'Fundamentals' },
      { q: 'SMART goals are:', opts: ['Specific, measurable, attainable, realistic, timely', 'Simple, minor, average', 'Same for all patients', 'Not used in nursing'], a: 0, subj: 'Fundamentals' },
      { q: 'Evaluation in nursing process determines:', opts: ['Whether goals were met', 'Only vital signs', 'Discharge date', 'Nothing'], a: 0, subj: 'Fundamentals' },
      { q: 'Handoff report (SBAR or similar) ensures:', opts: ['Continuity and patient safety', 'Speed only', 'Minimal talking', 'Secrecy'], a: 0, subj: 'Fundamentals' },
      { q: 'A care plan is:', opts: ['Individualized roadmap for patient care', 'Same for all patients', 'Optional', 'Only for discharge'], a: 0, subj: 'Fundamentals' },
      { q: 'Reassessment is important because:', opts: ['Patient status changes', 'It is never needed', 'Policy requires it only', 'Doctors demand it'], a: 0, subj: 'Fundamentals' },
      { q: 'Discharge planning begins:', opts: ['At admission', 'Day before discharge', 'At discharge only', 'Never'], a: 0, subj: 'Fundamentals' },
      { q: 'Teaching evaluation includes:', opts: ['Patient demonstration or verbalization', 'Assuming they know', 'No evaluation', 'Family report only'], a: 0, subj: 'Fundamentals' },
      { q: 'Health literacy affects:', opts: ['Understanding and following care instructions', 'Nothing', 'Only reading', 'Only writing'], a: 0, subj: 'Fundamentals' },
      { q: 'A teach-back method means:', opts: ['Patient explains back in own words', 'Nurse repeats', 'Family teaches', 'No verification'], a: 0, subj: 'Fundamentals' },
      { q: 'Time-out before procedure verifies:', opts: ['Correct patient, site, procedure', 'Only patient name', 'Nothing', 'Room number'], a: 0, subj: 'Fundamentals' },
      { q: 'Sentinel event requires:', opts: ['Root cause analysis, action plan', 'No response', 'Blame assignment', 'Ignore'], a: 0, subj: 'Fundamentals' },
      { q: 'Near-miss reporting helps:', opts: ['Prevent future errors', 'Punish staff', 'Hide problems', 'Save time'], a: 0, subj: 'Fundamentals' },
      { q: 'Multidrug-resistant organisms require:', opts: ['Contact precautions per facility policy', 'No precautions', 'Droplet only', 'Standard only'], a: 0, subj: 'Fundamentals' },
      { q: 'VRE stands for:', opts: ['Vancomycin-resistant Enterococcus', 'Viral respiratory infection', 'Vascular response event', 'Vital sign error'], a: 0, subj: 'Fundamentals' },
      { q: 'Bloodborne pathogen exposure requires:', opts: ['Immediate wash, report, follow-up', 'Ignore', 'Document only', 'No action'], a: 0, subj: 'Fundamentals' },
      { q: 'Needlestick protocol includes:', opts: ['Wash, report, baseline labs, follow-up', 'Bandage only', 'Ignore', 'Tell patient only'], a: 0, subj: 'Fundamentals' },
      { q: 'Safe patient handling reduces:', opts: ['Nurse and patient injury', 'Time only', 'Cost only', 'Nothing'], a: 0, subj: 'Fundamentals' },
      { q: 'Ergonomic principles in nursing include:', opts: ['Proper posture, body mechanics, equipment', 'Speed over safety', 'Lifting alone', 'Ignoring pain'], a: 0, subj: 'Fundamentals' },
      { q: 'Fatigue and nursing errors:', opts: ['Are linked; rest and breaks matter', 'Have no connection', 'Only affect night shift', 'Are unavoidable'], a: 0, subj: 'Fundamentals' },
      { q: 'Self-care for nurses includes:', opts: ['Rest, nutrition, stress management', 'Ignoring needs', 'Working more', 'No time for it'], a: 0, subj: 'Fundamentals' },
      { q: 'Professional development in nursing means:', opts: ['Ongoing learning and competence', 'Staying the same', 'Ignoring new evidence', 'Only initial license'], a: 0, subj: 'Fundamentals' },
      /* +30 Med-Surg */
      { q: 'Peripheral arterial disease (PAD) causes:', opts: ['Reduced blood flow to limbs, claudication', 'Swelling only', 'No symptoms', 'Rash'], a: 0, subj: 'Med-Surg' },
      { q: 'Venous insufficiency leads to:', opts: ['Edema, ulcers, discoloration', 'Pale limbs', 'No changes', 'Hypertension'], a: 0, subj: 'Med-Surg' },
      { q: 'Acute respiratory distress syndrome (ARDS) management includes:', opts: ['Low tidal volume, prone positioning', 'High tidal volume', 'No ventilator', 'Fluids only'], a: 0, subj: 'Med-Surg' },
      { q: 'Pneumothorax presents with:', opts: ['Sudden dyspnea, absent breath sounds', 'Crackles', 'Wheezing only', 'No respiratory change'], a: 0, subj: 'Med-Surg' },
      { q: 'Hemothorax means:', opts: ['Blood in pleural space', 'Air in pleural space', 'Infection', 'Fluid overload'], a: 0, subj: 'Med-Surg' },
      { q: 'Peptic ulcer hemorrhage signs include:', opts: ['Hematemesis, melena, shock', 'Chest pain only', 'Rash', 'No symptoms'], a: 0, subj: 'Med-Surg' },
      { q: 'Diverticulitis management includes:', opts: ['NPO or clear liquids, antibiotics', 'High fiber immediately', 'Laxatives', 'No diet change'], a: 0, subj: 'Med-Surg' },
      { q: 'Crohn\'s vs ulcerative colitis: Crohn\'s can affect:', opts: ['Any part of GI tract', 'Colon only', 'Stomach only', 'No difference'], a: 0, subj: 'Med-Surg' },
      { q: 'Acute pancreatitis lab finding:', opts: ['Elevated amylase and lipase', 'Low amylase', 'Normal enzymes', 'Elevated BUN only'], a: 0, subj: 'Med-Surg' },
      { q: 'Cholecystitis is often triggered by:', opts: ['Fatty meal, gallstones', 'Exercise', 'Rest', 'Fluids'], a: 0, subj: 'Med-Surg' },
      { q: 'Acute kidney injury phases include:', opts: ['Oliguric, diuretic, recovery', 'Only recovery', 'No phases', 'Chronic only'], a: 0, subj: 'Med-Surg' },
      { q: 'Dialysis access care includes:', opts: ['Assessing thrill/bruit, infection prevention', 'No special care', 'Tight BP cuff on access arm', 'Avoid all blood draws'], a: 0, subj: 'Med-Surg' },
      { q: 'Transplant rejection signs include:', opts: ['Fever, organ dysfunction, lab changes', 'No symptoms', 'Only pain', 'Rash only'], a: 0, subj: 'Med-Surg' },
      { q: 'HIV/AIDS patients need:', opts: ['Standard plus transmission precautions per stage', 'Contact always', 'No precautions', 'Isolation'], a: 0, subj: 'Med-Surg' },
      { q: 'Chemotherapy extravasation requires:', opts: ['Stop infusion, aspirate, antidote per drug', 'Continue infusion', 'Document only', 'Warm compress only'], a: 0, subj: 'Med-Surg' },
      { q: 'Neutropenic precautions include:', opts: ['Reverse isolation, no fresh flowers, cooked food', 'Standard only', 'Contact only', 'No restrictions'], a: 0, subj: 'Med-Surg' },
      { q: 'Thrombocytopenia precautions:', opts: ['Avoid trauma, bleeding, soft toothbrush', 'No precautions', 'Restraints', 'Anticoagulants'], a: 0, subj: 'Med-Surg' },
      { q: 'Sickle cell crisis is managed with:', opts: ['Hydration, oxygen, pain control', 'Blood transfusion only', 'No specific care', 'Antibiotics only'], a: 0, subj: 'Med-Surg' },
      { q: 'Deep vein thrombosis (DVT) risk factors include:', opts: ['Immobility, surgery, cancer', 'Exercise only', 'Low BMI', 'Young age'], a: 0, subj: 'Med-Surg' },
      { q: 'Warfarin and heparin both:', opts: ['Prevent clot formation', 'Dissolve clots', 'Increase bleeding time only', 'Have no effect'], a: 0, subj: 'Med-Surg' },
      { q: 'Tissue plasminogen activator (tPA) is used for:', opts: ['Acute ischemic stroke within window', 'Hemorrhagic stroke', 'Chronic stroke', 'All strokes'], a: 0, subj: 'Med-Surg' },
      { q: 'Seizure precautions include:', opts: ['Padded siderails, suction, O2', 'Restraints', 'Nothing', 'Soft diet only'], a: 0, subj: 'Med-Surg' },
      { q: 'Status epilepticus is:', opts: ['Prolonged or repeated seizures', 'Single brief seizure', 'Post-ictal state', 'No seizure'], a: 0, subj: 'Med-Surg' },
      { q: 'Increased intracranial pressure (ICP) interventions:', opts: ['Elevate HOB, limit stimuli, avoid Valsalva', 'Flat bed', 'Bright lights', 'More fluids'], a: 0, subj: 'Med-Surg' },
      { q: 'Diabetes insipidus causes:', opts: ['Excessive dilute urine, thirst', 'Concentrated urine', 'No urine change', 'Hyperglycemia'], a: 0, subj: 'Med-Surg' },
      { q: 'Cushing\'s syndrome features:', opts: ['Moon face, buffalo hump, hyperglycemia', 'Weight loss', 'Hypotension', 'Hyponatremia'], a: 0, subj: 'Med-Surg' },
      { q: 'Addison\'s disease requires:', opts: ['Lifelong glucocorticoid replacement', 'No treatment', 'Surgery only', 'Diet only'], a: 0, subj: 'Med-Surg' },
      { q: 'Thyroid storm is a medical emergency with:', opts: ['Fever, tachycardia, agitation', 'Hypothermia', 'Bradycardia', 'No symptoms'], a: 0, subj: 'Med-Surg' },
      { q: 'Myxedema coma presents with:', opts: ['Hypothermia, bradycardia, altered mental status', 'Hyperthermia', 'Tachycardia', 'Agitation'], a: 0, subj: 'Med-Surg' },
      { q: 'Burns: Rule of Nines estimates:', opts: ['Body surface area affected', 'Depth only', 'Pain level', 'Healing time'], a: 0, subj: 'Med-Surg' },
      { q: 'Burn fluid resuscitation uses:', opts: ['Parkland or similar formula', 'Oral fluids only', 'No fluids', 'Blood only'], a: 0, subj: 'Med-Surg' },
      { q: 'Osteomyelitis is:', opts: ['Bone infection', 'Joint inflammation', 'Muscle disease', 'Skin infection'], a: 0, subj: 'Med-Surg' },
      /* +30 Psych */
      { q: 'Repression is:', opts: ['Unconsciously blocking painful thoughts', 'Consciously forgetting', 'Blaming others', 'Acting out'], a: 0, subj: 'Psych' },
      { q: 'Suppression differs from repression in that suppression is:', opts: ['Conscious effort to avoid thoughts', 'Unconscious', 'Never used', 'Same as denial'], a: 0, subj: 'Psych' },
      { q: 'Intellectualization means:', opts: ['Using logic to avoid emotions', 'Being smart', 'Forgetting', 'Minimizing'], a: 0, subj: 'Psych' },
      { q: 'Reaction formation is:', opts: ['Expressing opposite of true feelings', 'Repeating actions', 'Redirecting', 'Forgetting'], a: 0, subj: 'Psych' },
      { q: 'Undoing attempts to:', opts: ['Cancel out unacceptable thought/action', 'Repeat behavior', 'Ignore guilt', 'Blame others'], a: 0, subj: 'Psych' },
      { q: 'Compensation means:', opts: ['Excelling in one area to offset weakness', 'Giving money', 'Apologizing', 'Avoiding'], a: 0, subj: 'Psych' },
      { q: 'Clang associations are:', opts: ['Words linked by sound, not meaning', 'Logical connections', 'Silence', 'Repetition'], a: 0, subj: 'Psych' },
      { q: 'Neologisms are:', opts: ['Made-up words', 'Foreign words', 'Slang', 'Medical terms'], a: 0, subj: 'Psych' },
      { q: 'Echolalia is:', opts: ['Repeating others\' words', 'Silence', 'Made-up words', 'Rapid speech'], a: 0, subj: 'Psych' },
      { q: 'Flat affect presents as:', opts: ['Little or no emotional expression', 'Exaggerated emotion', 'Inappropriate emotion', 'Changing rapidly'], a: 0, subj: 'Psych' },
      { q: 'Labile affect means:', opts: ['Rapid, exaggerated mood shifts', 'No emotion', 'Stable mood', 'Depressed only'], a: 0, subj: 'Psych' },
      { q: 'Insight in psych refers to:', opts: ['Awareness of own illness', 'Intelligence', 'Memory', 'Judgment'], a: 0, subj: 'Psych' },
      { q: 'Judgment in psych refers to:', opts: ['Ability to make sound decisions', 'Memory', 'Intelligence', 'Mood'], a: 0, subj: 'Psych' },
      { q: 'First-generation (typical) antipsychotics include:', opts: ['Haloperidol, chlorpromazine', 'Risperidone, olanzapine', 'Lithium', 'SSRIs'], a: 0, subj: 'Psych' },
      { q: 'Second-generation (atypical) antipsychotics have lower risk of:', opts: ['EPS, tardive dyskinesia', 'Weight gain', 'Metabolic syndrome', 'Sedation'], a: 0, subj: 'Psych' },
      { q: 'Clozapine requires:', opts: ['CBC monitoring (agranulocytosis risk)', 'No monitoring', 'Liver only', 'Kidney only'], a: 0, subj: 'Psych' },
      { q: 'Benzodiazepines for anxiety should be:', opts: ['Short-term, tapered when stopping', 'Long-term first choice', 'Never used', 'Given with MAOIs'], a: 0, subj: 'Psych' },
      { q: 'Buspirone is:', opts: ['Non-benzodiazepine anxiolytic', 'Antidepressant', 'Antipsychotic', 'Mood stabilizer'], a: 0, subj: 'Psych' },
      { q: 'ECT (electroconvulsive therapy) common side effect:', opts: ['Short-term memory loss', 'Permanent brain damage', 'No side effects', 'Seizures afterward'], a: 0, subj: 'Psych' },
      { q: 'Substance use disorder assessment includes:', opts: ['CAGE, AUDIT, use patterns', 'Blood test only', 'No screening', 'Family report only'], a: 0, subj: 'Psych' },
      { q: 'Alcohol withdrawal can cause:', opts: ['DTs, seizures, death', 'Mild symptoms only', 'No risk', 'Hypotension only'], a: 0, subj: 'Psych' },
      { q: 'Benzodiazepine withdrawal can cause:', opts: ['Seizures, rebound anxiety', 'No withdrawal', 'Hypertension only', 'Rash'], a: 0, subj: 'Psych' },
      { q: 'Dual diagnosis means:', opts: ['Mental illness plus substance use', 'Two mental illnesses', 'Two doctors', 'Family history'], a: 0, subj: 'Psych' },
      { q: 'Malingering is:', opts: ['Feigning illness for secondary gain', 'Real illness', 'Hypochondria', 'Somatic disorder'], a: 0, subj: 'Psych' },
      { q: 'Factitious disorder involves:', opts: ['Faking illness for attention/care', 'Secondary gain (money)', 'Real symptoms', 'Malingering'], a: 0, subj: 'Psych' },
      { q: 'Conversion disorder presents with:', opts: ['Neurological symptoms without organic cause', 'Faked symptoms', 'Organic disease', 'Malingering'], a: 0, subj: 'Psych' },
      { q: 'Cognitive distortions in depression include:', opts: ['All-or-nothing, catastrophizing', 'Logical thinking', 'Reality-based', 'No thought patterns'], a: 0, subj: 'Psych' },
      { q: 'Behavioral activation for depression aims to:', opts: ['Increase rewarding activities', 'Decrease all activity', 'Medication only', 'Talk only'], a: 0, subj: 'Psych' },
      { q: 'Mania requires:', opts: ['Mood stabilizer, possible antipsychotic', 'Antidepressant only', 'No medication', 'Benzodiazepine only'], a: 0, subj: 'Psych' },
      { q: 'Rapid cycling in bipolar means:', opts: ['4+ mood episodes per year', 'Daily mood changes', 'No episodes', 'Mixed episode only'], a: 0, subj: 'Psych' },
      { q: 'Antidepressants in bipolar depression may trigger:', opts: ['Mania (use with mood stabilizer)', 'Depression', 'Nothing', 'Anxiety only'], a: 0, subj: 'Psych' },
      { q: 'Schizoaffective disorder includes:', opts: ['Psychosis plus mood episodes', 'Psychosis only', 'Mood only', 'Anxiety only'], a: 0, subj: 'Psych' },
      { q: 'Negative symptoms of schizophrenia are harder to treat because:', opts: ['Fewer effective medications', 'They are fake', 'Patients refuse', 'No medications exist'], a: 0, subj: 'Psych' },
      { q: 'Prodromal phase of schizophrenia includes:', opts: ['Subtle changes before full psychosis', 'Full psychosis', 'Recovery', 'No phase'], a: 0, subj: 'Psych' },
      { q: 'Recovery model in mental health emphasizes:', opts: ['Hope, self-determination, wellness', 'Cure only', 'Medication only', 'Hospitalization'], a: 0, subj: 'Psych' },
      /* +30 Pharmacology */
      { q: 'Antacids (e.g., calcium carbonate) can interfere with:', opts: ['Absorption of other drugs', 'Nothing', 'Only food', 'Only liquids'], a: 0, subj: 'Pharmacology' },
      { q: 'Laxatives: bulk-forming (e.g., psyllium) work by:', opts: ['Absorbing water, increasing stool bulk', 'Stimulating nerves', 'Lubricating', 'Osmotic draw'], a: 0, subj: 'Pharmacology' },
      { q: 'Stimulant laxatives (e.g., bisacodyl) can cause:', opts: ['Cramping, dependency with long use', 'No side effects', 'Hyperkalemia', 'Constipation'], a: 0, subj: 'Pharmacology' },
      { q: 'Osmotic laxatives (e.g., polyethylene glycol) work by:', opts: ['Drawing water into bowel', 'Stimulating motility', 'Bulk', 'Lubrication'], a: 0, subj: 'Pharmacology' },
      { q: 'Antidiarrheals (e.g., loperamide) should be avoided in:', opts: ['C. diff, infectious diarrhea', 'All diarrhea', 'Never avoid', 'Constipation'], a: 0, subj: 'Pharmacology' },
      { q: 'Bismuth subsalicylate (Pepto-Bismol) may cause:', opts: ['Black stool, tongue discoloration', 'White stool', 'No change', 'Bleeding'], a: 0, subj: 'Pharmacology' },
      { q: 'Antiemetics: promethazine has', opts: ['Sedation, anticholinergic effects', 'No side effects', 'Stimulation', 'Weight gain'], a: 0, subj: 'Pharmacology' },
      { q: 'Scopolamine patch is used for:', opts: ['Motion sickness, N/V', 'Pain', 'Anxiety', 'Infection'], a: 0, subj: 'Pharmacology' },
      { q: 'Metformin contraindication:', opts: ['Severe renal impairment', 'Diabetes', 'Obesity', 'Hypertension'], a: 0, subj: 'Pharmacology' },
      { q: 'Sulfonylureas (e.g., glyburide) can cause:', opts: ['Hypoglycemia', 'Hyperglycemia only', 'No blood sugar effect', 'Weight loss'], a: 0, subj: 'Pharmacology' },
      { q: 'GLP-1 agonists (e.g., semaglutide) promote:', opts: ['Weight loss, blood sugar control', 'Weight gain', 'Hypoglycemia risk', 'No GI effects'], a: 0, subj: 'Pharmacology' },
      { q: 'SGLT2 inhibitors can cause:', opts: ['Genital infections, UTI risk', 'Hypoglycemia', 'Weight gain', 'No side effects'], a: 0, subj: 'Pharmacology' },
      { q: 'Insulin glargine is:', opts: ['Long-acting, once daily', 'Rapid-acting', 'Short-acting', 'Mixed'], a: 0, subj: 'Pharmacology' },
      { q: 'Insulin lispro is:', opts: ['Rapid-acting, given with meals', 'Long-acting', 'Intermediate', 'Oral'], a: 0, subj: 'Pharmacology' },
      { q: 'ACE inhibitor + potassium-sparing diuretic can cause:', opts: ['Hyperkalemia', 'Hypokalemia', 'Hyponatremia', 'No interaction'], a: 0, subj: 'Pharmacology' },
      { q: 'Potassium supplements should be given:', opts: ['With food, diluted', 'IV push', 'With potassium-sparing diuretic always', 'On empty stomach'], a: 0, subj: 'Pharmacology' },
      { q: 'Magnesium sulfate IV requires:', opts: ['Slow infusion, monitoring reflexes', 'Rapid push', 'No monitoring', 'Oral only'], a: 0, subj: 'Pharmacology' },
      { q: 'Calcium channel blocker + beta-blocker can cause:', opts: ['Bradycardia, heart block', 'Tachycardia', 'Hypertension', 'No interaction'], a: 0, subj: 'Pharmacology' },
      { q: 'Clopidogrel and aspirin are often used together for:', opts: ['Dual antiplatelet (e.g., post-PCI)', 'Pain only', 'Fever', 'Single use'], a: 0, subj: 'Pharmacology' },
      { q: 'Direct oral anticoagulants (DOACs) include:', opts: ['Apixaban, rivaroxaban', 'Warfarin', 'Heparin', 'Aspirin'], a: 0, subj: 'Pharmacology' },
      { q: 'DOACs have advantage over warfarin of:', opts: ['No routine INR monitoring', 'Reversible', 'Cheaper', 'No bleeding risk'], a: 0, subj: 'Pharmacology' },
      { q: 'Andexanet alfa reverses:', opts: ['Factor Xa inhibitors (e.g., apixaban)', 'Warfarin', 'Heparin', 'Aspirin'], a: 0, subj: 'Pharmacology' },
      { q: 'Idarucizumab reverses:', opts: ['Dabigatran', 'Warfarin', 'Apixaban', 'Heparin'], a: 0, subj: 'Pharmacology' },
      { q: 'Quinolones and dairy/antacids:', opts: ['Reduce absorption (give 2h apart)', 'No interaction', 'Increase absorption', 'Cause toxicity'], a: 0, subj: 'Pharmacology' },
      { q: 'Methotrexate requires:', opts: ['Folic acid supplementation', 'No supplementation', 'Vitamin K', 'Calcium'], a: 0, subj: 'Pharmacology' },
      { q: 'Allopurinol is used for:', opts: ['Gout prevention', 'Acute gout attack only', 'Hypertension', 'Diabetes'], a: 0, subj: 'Pharmacology' },
      { q: 'Colchicine is used for:', opts: ['Acute gout attack', 'Chronic gout only', 'Hypertension', 'Diabetes'], a: 0, subj: 'Pharmacology' },
      { q: 'Gabapentin is used for:', opts: ['Neuropathic pain, seizures', 'Acute pain only', 'Depression', 'Hypertension'], a: 0, subj: 'Pharmacology' },
      { q: 'Pregabalin is similar to gabapentin but:', opts: ['More potent, different dosing', 'Identical', 'Not for pain', 'Oral only'], a: 0, subj: 'Pharmacology' },
      { q: 'Tramadol has both:', opts: ['Opioid and SNRI-like effects', 'Only opioid', 'Only antidepressant', 'No analgesic effect'], a: 0, subj: 'Pharmacology' },
      { q: 'Acetaminophen max daily dose (adult) is generally:', opts: ['3000‚Äì4000 mg', '2000 mg', '6000 mg', 'No limit'], a: 0, subj: 'Pharmacology' },
      { q: 'Aspirin for cardiac prevention is often:', opts: ['Low dose (81 mg)', 'High dose (325 mg)', 'No dose', 'PRN only'], a: 0, subj: 'Pharmacology' },
      { q: 'Ketorolac is:', opts: ['Short-term NSAID, max 5 days', 'Long-term use', 'No limit', 'Topical only'], a: 0, subj: 'Pharmacology' },
      /* +100 Fundamentals */
      { q: 'Primary prevention focuses on:', opts: ['Preventing disease before it occurs', 'Treating existing disease', 'Rehabilitation', 'Screening only'], a: 0, subj: 'Fundamentals' },
      { q: 'Secondary prevention includes:', opts: ['Screening and early detection', 'Vaccinations only', 'Surgery', 'Palliative care'], a: 0, subj: 'Fundamentals' },
      { q: 'Tertiary prevention aims to:', opts: ['Reduce complications, manage chronic disease', 'Prevent new cases', 'Screen for disease', 'Cure disease'], a: 0, subj: 'Fundamentals' },
      { q: 'Health promotion differs from disease prevention in that it:', opts: ['Focuses on wellness and positive health', 'Only prevents illness', 'Treats disease', 'Is the same'], a: 0, subj: 'Fundamentals' },
      { q: 'A nursing care plan is:', opts: ['Individualized and dynamic', 'Same for all patients', 'Written by doctor only', 'Optional'], a: 0, subj: 'Fundamentals' },
      { q: 'Expected outcomes should be:', opts: ['Measurable and time-bound', 'Vague and general', 'Written by family', 'Ignored'], a: 0, subj: 'Fundamentals' },
      { q: 'Nursing interventions are:', opts: ['Actions to achieve outcomes', 'Diagnoses only', 'Doctor orders', 'Family requests'], a: 0, subj: 'Fundamentals' },
      { q: 'Independent nursing interventions:', opts: ['Do not require physician order', 'Always need order', 'Are illegal', 'Only for RNs'], a: 0, subj: 'Fundamentals' },
      { q: 'Dependent interventions require:', opts: ['Physician or prescriber order', 'No order', 'Family consent only', 'Nurse judgment only'], a: 0, subj: 'Fundamentals' },
      { q: 'Collaborative interventions involve:', opts: ['Multiple healthcare team members', 'Nurse only', 'Family only', 'No one else'], a: 0, subj: 'Fundamentals' },
      { q: 'Clinical pathways are:', opts: ['Standardized care plans for common conditions', 'Individual only', 'Optional', 'Not evidence-based'], a: 0, subj: 'Fundamentals' },
      { q: 'Critical thinking in nursing means:', opts: ['Analyzing, evaluating, making informed decisions', 'Following orders only', 'Guessing', 'Avoiding decisions'], a: 0, subj: 'Fundamentals' },
      { q: 'Evidence-based practice combines:', opts: ['Research, clinical expertise, patient values', 'Opinion only', 'Tradition only', 'Cost only'], a: 0, subj: 'Fundamentals' },
      { q: 'Therapeutic relationship is built on:', opts: ['Trust, respect, professional boundaries', 'Friendship', 'Secrets', 'Favoritism'], a: 0, subj: 'Fundamentals' },
      { q: 'Empathy in nursing means:', opts: ['Understanding patient feelings without losing objectivity', 'Feeling same as patient', 'Crying with patient', 'Avoiding emotion'], a: 0, subj: 'Fundamentals' },
      { q: 'Sympathy differs from empathy in that sympathy:', opts: ['Involves sharing distress', 'Maintains professional distance', 'Is always wrong', 'Is the same'], a: 0, subj: 'Fundamentals' },
      { q: 'Closed-ended questions elicit:', opts: ['Brief, specific answers', 'Long narratives', 'Feelings only', 'Nothing'], a: 0, subj: 'Fundamentals' },
      { q: 'Open-ended questions encourage:', opts: ['Detailed patient response', 'Yes/no only', 'Silence', 'Short answers'], a: 0, subj: 'Fundamentals' },
      { q: 'Clarifying in communication means:', opts: ['Asking for more information when unclear', 'Changing subject', 'Ignoring', 'Assuming'], a: 0, subj: 'Fundamentals' },
      { q: 'Paraphrasing demonstrates:', opts: ['Active listening and understanding', 'Ignoring', 'Interrupting', 'Judgment'], a: 0, subj: 'Fundamentals' },
      { q: 'Non-therapeutic communication includes:', opts: ['Giving advice, false reassurance', 'Listening', 'Clarifying', 'Reflecting'], a: 0, subj: 'Fundamentals' },
      { q: 'When a patient is nonverbal, you can:', opts: ['Use touch, pictures, writing', 'Ignore them', 'Assume understanding', 'Leave'], a: 0, subj: 'Fundamentals' },
      { q: 'Health literacy affects patient outcomes because:', opts: ['Low literacy impairs understanding of care', 'It does not matter', 'Only reading matters', 'Nurses explain everything'], a: 0, subj: 'Fundamentals' },
      { q: 'An interpreter should be used when:', opts: ['Patient prefers or has limited English', 'Never', 'Family can translate', 'Nurse knows some words'], a: 0, subj: 'Fundamentals' },
      { q: 'Family-centered care means:', opts: ['Involving family in care decisions', 'Ignoring family', 'Family makes all decisions', 'Excluding family'], a: 0, subj: 'Fundamentals' },
      { q: 'Patient education should be:', opts: ['Individualized, clear, evaluated', 'One-size-fits-all', 'Brief only', 'Written only'], a: 0, subj: 'Fundamentals' },
      { q: 'Learning styles include:', opts: ['Visual, auditory, kinesthetic', 'Only reading', 'Only listening', 'None'], a: 0, subj: 'Fundamentals' },
      { q: 'Barriers to learning include:', opts: ['Anxiety, pain, cognitive impairment', 'Nothing', 'Only age', 'Only language'], a: 0, subj: 'Fundamentals' },
      { q: 'Discharge teaching should begin:', opts: ['At admission', 'Day of discharge', 'When family arrives', 'Never'], a: 0, subj: 'Fundamentals' },
      { q: 'A transfer report includes:', opts: ['Current status, care plan, pending items', 'Only diagnosis', 'Nothing', 'Gossip'], a: 0, subj: 'Fundamentals' },
      { q: 'Handoff communication reduces:', opts: ['Errors and omissions in care', 'Time', 'Documentation', 'Nothing'], a: 0, subj: 'Fundamentals' },
      { q: 'I-SBAR adds:', opts: ['Introduction (who you are)', 'Nothing', 'Only Situation', 'Only Recommendation'], a: 0, subj: 'Fundamentals' },
      { q: 'CUS words (Concerned, Uncomfortable, Safety) help:', opts: ['Escalate safety concerns', 'Ignore problems', 'Avoid conflict', 'Document only'], a: 0, subj: 'Fundamentals' },
      { q: 'Two-challenge rule means:', opts: ['Address concern twice before escalating', 'Challenge patient', 'Never escalate', 'Ignore first time'], a: 0, subj: 'Fundamentals' },
      { q: 'TeamSTEPPS promotes:', opts: ['Team communication and safety', 'Individual work', 'Hierarchy only', 'Blame culture'], a: 0, subj: 'Fundamentals' },
      { q: 'Cognitive load in nursing refers to:', opts: ['Mental demand of tasks', 'Physical load', 'Patient weight', 'Documentation only'], a: 0, subj: 'Fundamentals' },
      { q: 'Workarounds can:', opts: ['Introduce safety risks', 'Always improve care', 'Replace policy', 'Be ignored'], a: 0, subj: 'Fundamentals' },
      { q: 'Near-miss reporting helps:', opts: ['Identify system improvements', 'Punish staff', 'Hide errors', 'Save time'], a: 0, subj: 'Fundamentals' },
      { q: 'Root cause analysis aims to:', opts: ['Find system failures, not blame', 'Blame individuals', 'Punish', 'Hide issues'], a: 0, subj: 'Fundamentals' },
      { q: 'Just culture balances:', opts: ['Accountability and learning', 'Blame only', 'No accountability', 'Secrecy'], a: 0, subj: 'Fundamentals' },
      { q: 'Medication reconciliation compares:', opts: ['Current meds across care transitions', 'Only at admission', 'Never', 'Only discharge'], a: 0, subj: 'Fundamentals' },
      { q: 'High-alert medications include:', opts: ['Insulin, heparin, opioids', 'Vitamins only', 'OTC only', 'None'], a: 0, subj: 'Fundamentals' },
      { q: 'Look-alike, sound-alike (LASA) drugs require:', opts: ['Extra verification', 'No special care', 'Same storage', 'Ignoring'], a: 0, subj: 'Fundamentals' },
      { q: 'Unit dose packaging reduces:', opts: ['Dosing errors', 'Cost only', 'Nothing', 'Storage'], a: 0, subj: 'Fundamentals' },
      { q: 'Barcode scanning at bedside:', opts: ['Verifies right drug, dose, patient', 'Slows care', 'Not needed', 'Optional'], a: 0, subj: 'Fundamentals' },
      { q: 'Tall man lettering (e.g., hydrALAzine) helps:', opts: ['Distinguish similar drug names', 'Nothing', 'Readability only', 'Marketing'], a: 0, subj: 'Fundamentals' },
      { q: 'Abbreviations to avoid include:', opts: ['U (unit), QD, trailing zeros', 'All abbreviations', 'None', 'Only U'], a: 0, subj: 'Fundamentals' },
      { q: 'Leading zeros (0.5 not .5) prevent:', opts: ['Overdose from misreading', 'Nothing', 'Confusion', 'Cost'], a: 0, subj: 'Fundamentals' },
      { q: 'Trailing zeros (5 not 5.0) prevent:', opts: ['Overdose from misreading', 'Nothing', 'Underdose', 'Error'], a: 0, subj: 'Fundamentals' },
      { q: 'Culture affects health beliefs including:', opts: ['Diet, treatment preferences, family role', 'Nothing', 'Only religion', 'Only language'], a: 0, subj: 'Fundamentals' },
      { q: 'Spiritual distress may present as:', opts: ['Hopelessness, questioning meaning', 'Physical pain only', 'Anger only', 'Nothing'], a: 0, subj: 'Fundamentals' },
      { q: 'Spiritual care includes:', opts: ['Presence, listening, facilitating practices', 'Converting', 'Ignoring', 'Medication only'], a: 0, subj: 'Fundamentals' },
      { q: 'Age affects drug absorption due to:', opts: ['Metabolic and organ changes', 'Nothing', 'Only weight', 'Only diet'], a: 0, subj: 'Fundamentals' },
      { q: 'Polypharmacy increases risk of:', opts: ['Interactions, adverse effects', 'Cure', 'Nothing', 'Compliance only'], a: 0, subj: 'Fundamentals' },
      { q: 'Medication adherence barriers include:', opts: ['Cost, complexity, side effects', 'Nothing', 'Only forgetfulness', 'Only age'], a: 0, subj: 'Fundamentals' },
      { q: 'Vulnerable populations may include:', opts: ['Elderly, homeless, mentally ill', 'No one', 'Only children', 'Only poor'], a: 0, subj: 'Fundamentals' },
      { q: 'Social determinants of health include:', opts: ['Income, education, environment', 'Genes only', 'Nothing', 'Only diet'], a: 0, subj: 'Fundamentals' },
      { q: 'Health disparities are:', opts: ['Avoidable differences in health outcomes', 'Same for all', 'Genetic only', 'Inevitable'], a: 0, subj: 'Fundamentals' },
      { q: 'Advocacy in nursing means:', opts: ['Speaking up for patient rights and needs', 'Obeying only', 'Ignoring', 'Family only'], a: 0, subj: 'Fundamentals' },
      { q: 'Informed refusal must be:', opts: ['Documented like informed consent', 'Ignored', 'Overridden', 'Not documented'], a: 0, subj: 'Fundamentals' },
      { q: 'Capacity to make decisions means:', opts: ['Ability to understand and decide', 'Always present', 'Never present', 'Same as competence'], a: 0, subj: 'Fundamentals' },
      { q: 'Competence is a legal determination by:', opts: ['Court', 'Nurse', 'Doctor', 'Family'], a: 0, subj: 'Fundamentals' },
      { q: 'A surrogate decision-maker acts when:', opts: ['Patient lacks capacity', 'Family requests', 'Always', 'Never'], a: 0, subj: 'Fundamentals' },
      { q: 'POLST (Physician Orders for Life-Sustaining Treatment):', opts: ['Translates wishes into medical orders', 'Replaces advance directive', 'Is optional only', 'Expires daily'], a: 0, subj: 'Fundamentals' },
      { q: 'Palliative care focuses on:', opts: ['Quality of life, symptom management', 'Cure only', 'End of life only', 'Hospice only'], a: 0, subj: 'Fundamentals' },
      { q: 'Hospice is for:', opts: ['Terminal illness, life expectancy limited', 'All patients', 'Recovery', 'Acute care'], a: 0, subj: 'Fundamentals' },
      { q: 'DNR does not mean:', opts: ['Do not treat; comfort care still given', 'No care', 'No medication', 'Abandon patient'], a: 0, subj: 'Fundamentals' },
      { q: 'Active listening involves:', opts: ['Full attention, nonverbal cues', 'Planning response', 'Interrupting', 'Multitasking'], a: 0, subj: 'Fundamentals' },
      { q: 'Therapeutic silence allows:', opts: ['Patient to gather thoughts', 'Nurse to leave', 'Nothing', 'Awkwardness only'], a: 0, subj: 'Fundamentals' },
      { q: 'Touch in nursing should be:', opts: ['Appropriate, purposeful, patient-acceptable', 'Avoided', 'Frequent', 'Unplanned'], a: 0, subj: 'Fundamentals' },
      { q: 'Personal space varies by:', opts: ['Culture, situation, individual', 'Nothing', 'Age only', 'Gender only'], a: 0, subj: 'Fundamentals' },
      { q: 'Documentation principles include:', opts: ['Factual, timely, accurate', 'Brief and vague', 'Delayed', 'Oral preferred'], a: 0, subj: 'Fundamentals' },
      { q: 'Charting by exception documents:', opts: ['Only abnormal or significant findings', 'Everything', 'Nothing', 'Only meds'], a: 0, subj: 'Fundamentals' },
      { q: 'SOAP format stands for:', opts: ['Subjective, Objective, Assessment, Plan', 'Same, Only, Always, Plan', 'Simple, Objective, Action', 'Status Only'], a: 0, subj: 'Fundamentals' },
      { q: 'DAR (Data, Action, Response) is used in:', opts: ['Focus charting', 'SOAP only', 'Never', 'Narrative only'], a: 0, subj: 'Fundamentals' },
      { q: 'A variance in documentation means:', opts: ['Deviation from expected outcome', 'Normal finding', 'Error', 'Nothing'], a: 0, subj: 'Fundamentals' },
      { q: 'Correcting a charting error:', opts: ['Single line through, initial, date, correct', 'Erase', 'White-out', 'Delete'], a: 0, subj: 'Fundamentals' },
      { q: 'Never chart:', opts: ['Before care is given', 'After care', 'At shift end', 'When busy'], a: 0, subj: 'Fundamentals' },
      { q: 'Confidentiality in telehealth requires:', opts: ['Secure platform, private setting', 'Any video app', 'No special care', 'Phone only'], a: 0, subj: 'Fundamentals' },
      { q: 'Telehealth nursing considerations include:', opts: ['Technology access, safety assessment', 'Nothing', 'Only video', 'Only phone'], a: 0, subj: 'Fundamentals' },
      { q: 'Remote patient monitoring allows:', opts: ['Data collection between visits', 'No monitoring', 'Only in hospital', 'Only vital signs'], a: 0, subj: 'Fundamentals' },
      { q: 'Safe patient handling programs reduce:', opts: ['Nurse and patient injury', 'Time only', 'Cost only', 'Nothing'], a: 0, subj: 'Fundamentals' },
      { q: 'Mechanical lifts should be used when:', opts: ['Per facility policy, patient assessment', 'Never', 'Always', 'Only bariatric'], a: 0, subj: 'Fundamentals' },
      { q: 'Repositioning schedule for immobile patients:', opts: ['Every 2 hours or per protocol', 'Every 4 hours', 'Once per shift', 'When requested'], a: 0, subj: 'Fundamentals' },
      { q: 'Pressure injury staging uses:', opts: ['Stages 1-4, plus unstageable and DTI', 'Numbers only', 'Color only', 'No staging'], a: 0, subj: 'Fundamentals' },
      { q: 'Stage 1 pressure injury shows:', opts: ['Non-blanchable erythema', 'Open wound', 'Deep tissue', 'Necrosis'], a: 0, subj: 'Fundamentals' },
      { q: 'Deep tissue injury (DTI) may appear:', opts: ['Purple or maroon localized area', 'Open wound', 'Stage 1', 'Healed'], a: 0, subj: 'Fundamentals' },
      { q: 'Braden scale assesses:', opts: ['Pressure injury risk', 'Fall risk', 'Pain', 'Nutrition'], a: 0, subj: 'Fundamentals' },
      { q: 'Moisture-associated skin damage (MASD) includes:', opts: ['Incontinence-associated dermatitis', 'Only pressure', 'Only friction', 'Nothing'], a: 0, subj: 'Fundamentals' },
      { q: 'Skin tears are classified by:', opts: ['Payne-Martin or ISTAP system', 'Stage 1-4', 'Color', 'Size only'], a: 0, subj: 'Fundamentals' },
      { q: 'Wound assessment includes:', opts: ['Location, size, drainage, surrounding skin', 'Color only', 'Nothing', 'Depth only'], a: 0, subj: 'Fundamentals' },
      { q: 'Granulation tissue in healing appears:', opts: ['Pink/red, moist', 'Yellow', 'Black', 'White'], a: 0, subj: 'Fundamentals' },
      { q: 'Slough in a wound is:', opts: ['Yellow/white necrotic tissue', 'Healthy tissue', 'Infection', 'Granulation'], a: 0, subj: 'Fundamentals' },
      { q: 'Eschar is:', opts: ['Black/brown hard necrotic tissue', 'Healthy', 'Infection', 'Drainage'], a: 0, subj: 'Fundamentals' },
      { q: 'Negative pressure wound therapy (NPWT):', opts: ['Promotes healing by suction', 'Prevents healing', 'Is outdated', 'Causes infection'], a: 0, subj: 'Fundamentals' },
      /* +100 Med-Surg */
      { q: 'Acute coronary syndrome (ACS) includes:', opts: ['Unstable angina, NSTEMI, STEMI', 'Stable angina only', 'CHF only', 'Arrhythmia only'], a: 0, subj: 'Med-Surg' },
      { q: 'STEMI requires:', opts: ['Urgent reperfusion (PCI or thrombolytics)', 'Observation only', 'Medication only', 'Discharge'], a: 0, subj: 'Med-Surg' },
      { q: 'Cardiac biomarkers include:', opts: ['Troponin, CK-MB, BNP', 'Only BUN', 'Only creatinine', 'Only WBC'], a: 0, subj: 'Med-Surg' },
      { q: 'BNP (B-type natriuretic peptide) elevates with:', opts: ['Heart failure', 'Liver failure', 'Kidney failure only', 'Lung cancer'], a: 0, subj: 'Med-Surg' },
      { q: 'Heart failure classification (NYHA) assesses:', opts: ['Functional capacity and symptoms', 'Ejection fraction only', 'BP only', 'Weight only'], a: 0, subj: 'Med-Surg' },
      { q: 'Left-sided heart failure causes:', opts: ['Pulmonary congestion, dyspnea', 'Peripheral edema only', 'JVD only', 'No pulmonary effects'], a: 0, subj: 'Med-Surg' },
      { q: 'Right-sided heart failure causes:', opts: ['JVD, peripheral edema, hepatomegaly', 'Pulmonary edema', 'Dyspnea only', 'Cough only'], a: 0, subj: 'Med-Surg' },
      { q: 'Cardiogenic shock presents with:', opts: ['Hypotension, poor perfusion, pump failure', 'Hypertension', 'Warm extremities', 'Good output'], a: 0, subj: 'Med-Surg' },
      { q: 'Hypovolemic shock results from:', opts: ['Blood or fluid loss', 'Heart failure', 'Infection', 'Allergy'], a: 0, subj: 'Med-Surg' },
      { q: 'Distributive shock includes:', opts: ['Septic, neurogenic, anaphylactic', 'Hypovolemic only', 'Cardiogenic only', 'None'], a: 0, subj: 'Med-Surg' },
      { q: 'Obstructive shock is caused by:', opts: ['Tamponade, PE, tension pneumothorax', 'Bleeding', 'Infection', 'Heart failure'], a: 0, subj: 'Med-Surg' },
      { q: 'Chest tube bubbling in water seal indicates:', opts: ['Air leak ( assess significance)', 'Normal', 'Clogged', 'Disconnected'], a: 0, subj: 'Med-Surg' },
      { q: 'Chest tube tidaling with respiration is:', opts: ['Normal, reflects pressure changes', 'Air leak', 'Clogged', 'Problem'], a: 0, subj: 'Med-Surg' },
      { q: 'Pneumonia prevention includes:', opts: ['Vaccination, hand hygiene, mobility', 'Bed rest', 'Fluids only', 'Antibiotics only'], a: 0, subj: 'Med-Surg' },
      { q: 'Community-acquired vs hospital-acquired pneumonia:', opts: ['Different pathogens, treatment', 'Same always', 'No difference', 'Only location'], a: 0, subj: 'Med-Surg' },
      { q: 'COPD exacerbation management includes:', opts: ['Bronchodilators, steroids, oxygen', 'High-flow oxygen always', 'No oxygen', 'Antibiotics only'], a: 0, subj: 'Med-Surg' },
      { q: 'Asthma action plan includes:', opts: ['Green/yellow/red zones, when to seek help', 'Nothing', 'Only meds', 'Only peak flow'], a: 0, subj: 'Med-Surg' },
      { q: 'Peak flow monitoring helps:', opts: ['Detect worsening asthma early', 'Nothing', 'Only diagnose', 'Only in hospital'], a: 0, subj: 'Med-Surg' },
      { q: 'Pulmonary embolism prophylaxis includes:', opts: ['SCDs, anticoagulation, early mobility', 'Bed rest', 'No prophylaxis', 'Compression only'], a: 0, subj: 'Med-Surg' },
      { q: 'Wells score assesses:', opts: ['DVT/PE probability', 'MI risk', 'Stroke risk', 'Bleeding risk'], a: 0, subj: 'Med-Surg' },
      { q: 'Renal failure can cause:', opts: ['Fluid overload, electrolyte imbalance', 'Dehydration only', 'No metabolic effects', 'Hypertension only'], a: 0, subj: 'Med-Surg' },
      { q: 'AKI phases include:', opts: ['Oliguric, diuretic, recovery', 'Only oliguric', 'Only recovery', 'No phases'], a: 0, subj: 'Med-Surg' },
      { q: 'Contrast-induced nephropathy prevention:', opts: ['Hydration, limit contrast', 'No prevention', 'Diuretics', 'NPO'], a: 0, subj: 'Med-Surg' },
      { q: 'Hemodialysis removes:', opts: ['Waste, excess fluid via blood', 'Nothing', 'Only fluid', 'Only toxins'], a: 0, subj: 'Med-Surg' },
      { q: 'Peritoneal dialysis uses:', opts: ['Peritoneum as filter, dwell fluid', 'Blood only', 'Kidney', 'Liver'], a: 0, subj: 'Med-Surg' },
      { q: 'Dialysis disequilibrium can cause:', opts: ['Headache, nausea, neurologic changes', 'Nothing', 'Hypotension only', 'Infection only'], a: 0, subj: 'Med-Surg' },
      { q: 'Hepatorenal syndrome is:', opts: ['Renal failure in liver disease', 'Liver failure only', 'Heart failure', 'Sepsis'], a: 0, subj: 'Med-Surg' },
      { q: 'Hepatic encephalopathy signs include:', opts: ['Altered mental status, asterixis', 'Jaundice only', 'Ascites only', 'No neurologic signs'], a: 0, subj: 'Med-Surg' },
      { q: 'Asterixis (liver flap) indicates:', opts: ['Metabolic encephalopathy', 'Stroke', 'Seizure', 'Normal'], a: 0, subj: 'Med-Surg' },
      { q: 'Lactulose for hepatic encephalopathy works by:', opts: ['Reducing ammonia absorption', 'Constipation', 'Diuresis', 'Nothing'], a: 0, subj: 'Med-Surg' },
      { q: 'Esophageal varices rupture is:', opts: ['Life-threatening bleed', 'Minor', 'Rare', 'Preventable easily'], a: 0, subj: 'Med-Surg' },
      { q: 'TIPS (transjugular intrahepatic portosystemic shunt):', opts: ['Relieves portal hypertension', 'Cures cirrhosis', 'Transplants liver', 'Removes fluid'], a: 0, subj: 'Med-Surg' },
      { q: 'Spontaneous bacterial peritonitis (SBP):', opts: ['Infection of ascitic fluid', 'Bowel infection', 'Liver infection', 'Pneumonia'], a: 0, subj: 'Med-Surg' },
      { q: 'Paracentesis large-volume requires:', opts: ['Albumin replacement', 'Nothing', 'Fluids only', 'No replacement'], a: 0, subj: 'Med-Surg' },
      { q: 'Acute pancreatitis causes include:', opts: ['Gallstones, alcohol', 'Only alcohol', 'Only diet', 'Infection only'], a: 0, subj: 'Med-Surg' },
      { q: 'Ranson criteria predict:', opts: ['Pancreatitis severity', 'Survival', 'Recurrence', 'Nothing'], a: 0, subj: 'Med-Surg' },
      { q: 'Chronic pancreatitis leads to:', opts: ['Malabsorption, diabetes, pain', 'Acute only', 'No sequelae', 'Cure'], a: 0, subj: 'Med-Surg' },
      { q: 'Inflammatory bowel disease (IBD) includes:', opts: ['Crohn\'s, ulcerative colitis', 'IBS only', 'Celiac only', 'Diverticulitis'], a: 0, subj: 'Med-Surg' },
      { q: 'IBS (irritable bowel) differs from IBD:', opts: ['No structural damage, functional', 'Same', 'IBD is functional', 'No difference'], a: 0, subj: 'Med-Surg' },
      { q: 'C. diff treatment includes:', opts: ['Vancomycin or fidaxomicin', 'Metronidazole only now', 'No antibiotics', 'Surgery only'], a: 0, subj: 'Med-Surg' },
      { q: 'Fecal transplant (FMT) is used for:', opts: ['Recurrent C. diff', 'First episode', 'All diarrhea', 'Constipation'], a: 0, subj: 'Med-Surg' },
      { q: 'Upper GI bleed presents with:', opts: ['Hematemesis, melena', 'Bright red stool only', 'No blood', 'Diarrhea only'], a: 0, subj: 'Med-Surg' },
      { q: 'Lower GI bleed may present with:', opts: ['Bright red or dark stool', 'Hematemesis', 'Melena only', 'No change'], a: 0, subj: 'Med-Surg' },
      { q: 'GERD management includes:', opts: ['Lifestyle, PPIs, elevation', 'Surgery only', 'No treatment', 'Antibiotics'], a: 0, subj: 'Med-Surg' },
      { q: 'Barrett\'s esophagus is:', opts: ['Metaplastic change, cancer risk', 'Normal', 'GERD only', 'No risk'], a: 0, subj: 'Med-Surg' },
      { q: 'Type 1 diabetes is characterized by:', opts: ['Autoimmune, insulin deficiency', 'Insulin resistance', 'Obesity', 'Adult onset'], a: 0, subj: 'Med-Surg' },
      { q: 'Type 2 diabetes involves:', opts: ['Insulin resistance, relative deficiency', 'No insulin', 'Autoimmune', 'Childhood only'], a: 0, subj: 'Med-Surg' },
      { q: 'DKA treatment includes:', opts: ['IV fluids, insulin, electrolyte replacement', 'Oral hypoglycemics', 'No insulin', 'Observation'], a: 0, subj: 'Med-Surg' },
      { q: 'HHNS (HHS) differs from DKA:', opts: ['Higher glucose, less ketosis', 'Same', 'More ketosis', 'Lower glucose'], a: 0, subj: 'Med-Surg' },
      { q: 'Hypoglycemia treatment (conscious):', opts: ['15-20g fast-acting carbs', 'Insulin', 'Glucagon', 'Wait'], a: 0, subj: 'Med-Surg' },
      { q: 'Glucagon is for:', opts: ['Severe hypoglycemia when unable to eat', 'Mild hypo', 'DKA', 'HHNS'], a: 0, subj: 'Med-Surg' },
      { q: 'Diabetic neuropathy affects:', opts: ['Nerves, sensation, autonomic function', 'Eyes only', 'Kidneys only', 'Heart only'], a: 0, subj: 'Med-Surg' },
      { q: 'Diabetic retinopathy can lead to:', opts: ['Blindness', 'Nothing', 'Kidney failure', 'Neuropathy'], a: 0, subj: 'Med-Surg' },
      { q: 'Diabetic nephropathy progresses to:', opts: ['ESRD', 'Recovery', 'No progression', 'Cure'], a: 0, subj: 'Med-Surg' },
      { q: 'Metabolic syndrome includes:', opts: ['Obesity, HTN, dyslipidemia, glucose', 'Diabetes only', 'Obesity only', 'Nothing'], a: 0, subj: 'Med-Surg' },
      { q: 'Addisonian crisis treatment:', opts: ['IV hydrocortisone, fluids', 'Oral steroids', 'Observation', 'No steroids'], a: 0, subj: 'Med-Surg' },
      { q: 'SIADH treatment may include:', opts: ['Fluid restriction, hypertonic saline', 'Free water', 'Diuretics only', 'No restriction'], a: 0, subj: 'Med-Surg' },
      { q: 'Diabetes insipidus treatment:', opts: ['Vasopressin, fluids', 'Fluid restriction', 'Diuretics', 'Nothing'], a: 0, subj: 'Med-Surg' },
      { q: 'Syndrome of inappropriate antidiuretic hormone:', opts: ['Causes hyponatremia', 'Hypernatremia', 'Hyperkalemia', 'Hypokalemia'], a: 0, subj: 'Med-Surg' },
      { q: 'SIADH causes:', opts: ['Dilutional hyponatremia', 'Concentrated blood', 'Dehydration', 'Hypervolemia'], a: 0, subj: 'Med-Surg' },
      { q: 'Hyperkalemia EKG changes:', opts: ['Peaked T waves, widened QRS', 'Flat T waves', 'Short QT', 'Normal'], a: 0, subj: 'Med-Surg' },
      { q: 'Hypokalemia can cause:', opts: ['Muscle weakness, arrhythmias', 'Hyperreflexia', 'Peaked T waves', 'Bradycardia'], a: 0, subj: 'Med-Surg' },
      { q: 'Calcium gluconate in hyperkalemia:', opts: ['Stabilizes cardiac membrane', 'Lowers potassium', 'Does nothing', 'Raises potassium'], a: 0, subj: 'Med-Surg' },
      { q: 'Kayexalate removes potassium via:', opts: ['GI tract', 'Urine', 'Dialysis', 'IV'], a: 0, subj: 'Med-Surg' },
      { q: 'Hypermagnesemia can cause:', opts: ['Hyporeflexia, respiratory depression', 'Hyperreflexia', 'Seizures', 'Tachycardia'], a: 0, subj: 'Med-Surg' },
      { q: 'Hypomagnesemia often accompanies:', opts: ['Hypokalemia, hypocalcemia', 'Hyperkalemia', 'No other deficits', 'Hypermagnesemia'], a: 0, subj: 'Med-Surg' },
      { q: 'Hypocalcemia can cause:', opts: ['Tetany, Chvostek, Trousseau', 'Flaccidity', 'Hyperreflexia', 'Nothing'], a: 0, subj: 'Med-Surg' },
      { q: 'Hypercalcemia treatment includes:', opts: ['Hydration, loop diuretics, bisphosphonates', 'Thiazides', 'Calcium supplements', 'No treatment'], a: 0, subj: 'Med-Surg' },
      { q: 'Phosphate imbalance often relates to:', opts: ['Calcium, kidney function', 'Nothing', 'Sodium only', 'Potassium only'], a: 0, subj: 'Med-Surg' },
      { q: 'Sepsis is defined as:', opts: ['Life-threatening organ dysfunction from infection', 'Infection only', 'Fever only', 'Bacteremia'], a: 0, subj: 'Med-Surg' },
      { q: 'Septic shock includes:', opts: ['Persistent hypotension despite fluids', 'Hypotension only', 'No fluids needed', 'Hypertension'], a: 0, subj: 'Med-Surg' },
      { q: 'Sepsis bundle (Surviving Sepsis) includes:', opts: ['Lactate, cultures, antibiotics, fluids', 'Observation', 'Antibiotics only', 'Nothing'], a: 0, subj: 'Med-Surg' },
      { q: 'SIRS criteria include:', opts: ['Temp, HR, RR, WBC abnormalities', 'BP only', 'Lactate only', 'Nothing'], a: 0, subj: 'Med-Surg' },
      { q: 'qSOFA assesses:', opts: ['Sepsis risk (altered mental status, RR, BP)', 'DKA', 'Stroke', 'MI'], a: 0, subj: 'Med-Surg' },
      { q: 'MODS (multi-organ dysfunction) is:', opts: ['Failure of multiple organ systems', 'Single organ', 'Reversible always', 'Rare'], a: 0, subj: 'Med-Surg' },
      { q: 'ARDS diagnostic criteria include:', opts: ['Bilateral infiltrates, hypoxemia', 'Unilateral only', 'Normal oxygenation', 'No infiltrates'], a: 0, subj: 'Med-Surg' },
      { q: 'Prone positioning in ARDS:', opts: ['Improves oxygenation', 'Worsens', 'No effect', 'Prevents'], a: 0, subj: 'Med-Surg' },
      { q: 'VAP (ventilator-associated pneumonia) prevention:', opts: ['VAP bundle, oral care, elevation', 'Nothing', 'Antibiotics only', 'No elevation'], a: 0, subj: 'Med-Surg' },
      { q: 'CLABSI prevention includes:', opts: ['Central line bundle, hand hygiene', 'Nothing', 'Antibiotics', 'No dressing changes'], a: 0, subj: 'Med-Surg' },
      { q: 'CAUTI prevention includes:', opts: ['Remove catheter when not needed', 'Never remove', 'No care', 'Antibiotics only'], a: 0, subj: 'Med-Surg' },
      { q: 'Surgical site infection risk factors:', opts: ['Diabetes, obesity, prolonged surgery', 'None', 'Age only', 'Gender only'], a: 0, subj: 'Med-Surg' },
      { q: 'ERAS (Enhanced Recovery After Surgery):', opts: ['Protocol to optimize surgical recovery', 'Prolongs stay', 'No evidence', 'Old protocol'], a: 0, subj: 'Med-Surg' },
      { q: 'Post-op ileus resolves when:', opts: ['Bowel sounds, flatus return', 'Day 1', 'Never', 'With medication only'], a: 0, subj: 'Med-Surg' },
      { q: 'Wound vacuum (VAC) therapy:', opts: ['Negative pressure for wound healing', 'Positive pressure', 'No pressure', 'Bandage only'], a: 0, subj: 'Med-Surg' },
      /* +100 Psych */
      { q: 'Therapeutic alliance is the:', opts: ['Collaborative relationship between clinician and patient', 'Friendship', 'Dependency', 'Control'], a: 0, subj: 'Psych' },
      { q: 'Transference in therapy refers to:', opts: ['Patient redirects feelings from past onto therapist', 'Therapist feelings', 'Family involvement', 'Medication'], a: 0, subj: 'Psych' },
      { q: 'Countertransference is when:', opts: ['Therapist\'s feelings affect the therapeutic relationship', 'Patient is angry', 'Family intervenes', 'Medication works'], a: 0, subj: 'Psych' },
      { q: 'Boundaries in therapeutic relationship:', opts: ['Maintain professional role, avoid dual relationships', 'No boundaries', 'Friendship OK', 'Personal disclosure OK'], a: 0, subj: 'Psych' },
      { q: 'Validation in DBT means:', opts: ['Acknowledging and accepting emotions as valid', 'Agreeing with all', 'Minimizing', 'Ignoring'], a: 0, subj: 'Psych' },
      { q: 'Mindfulness in mental health care:', opts: ['Present-moment awareness, non-judgment', 'Meditation only', 'Religion', 'Ignoring thoughts'], a: 0, subj: 'Psych' },
      { q: 'Distress tolerance skills help:', opts: ['Cope with crisis without making it worse', 'Eliminate distress', 'Avoid all stress', 'Ignore feelings'], a: 0, subj: 'Psych' },
      { q: 'Emotion regulation aims to:', opts: ['Understand and modify emotional responses', 'Suppress emotions', 'Ignore emotions', 'Act on all emotions'], a: 0, subj: 'Psych' },
      { q: 'Interpersonal effectiveness (DBT) focuses on:', opts: ['Assertiveness, relationships', 'Isolation', 'Conflict only', 'Avoidance'], a: 0, subj: 'Psych' },
      { q: 'Exposure therapy is used for:', opts: ['Anxiety, PTSD, phobias', 'Depression only', 'Psychosis', 'Bipolar'], a: 0, subj: 'Psych' },
      { q: 'Systematic desensitization involves:', opts: ['Gradual exposure with relaxation', 'Flooding only', 'Avoidance', 'No exposure'], a: 0, subj: 'Psych' },
      { q: 'Flooding in exposure therapy:', opts: ['Intense, prolonged exposure', 'Gradual only', 'No exposure', 'Imaginary only'], a: 0, subj: 'Psych' },
      { q: 'Cognitive restructuring targets:', opts: ['Irrational or distorted thoughts', 'Emotions only', 'Behavior only', 'Nothing'], a: 0, subj: 'Psych' },
      { q: 'Automatic thoughts are:', opts: ['Rapid, often distorted thoughts', 'Planned', 'Logical', 'Rare'], a: 0, subj: 'Psych' },
      { q: 'Core beliefs in CBT are:', opts: ['Deep-seated assumptions about self/world', 'Surface thoughts', 'Facts', 'Irrelevant'], a: 0, subj: 'Psych' },
      { q: 'Behavioral experiments in CBT:', opts: ['Test beliefs through action', 'Thought only', 'No testing', 'Avoidance'], a: 0, subj: 'Psych' },
      { q: 'Psychoeducation provides:', opts: ['Information about illness and treatment', 'Medication only', 'Diagnosis only', 'Nothing'], a: 0, subj: 'Psych' },
      { q: 'Relapse prevention focuses on:', opts: ['Identifying triggers, coping plans', 'Cure', 'Avoidance only', 'Medication only'], a: 0, subj: 'Psych' },
      { q: 'Warning signs of relapse include:', opts: ['Sleep changes, withdrawal, mood shifts', 'Nothing', 'Only hospitalization', 'Only medication noncompliance'], a: 0, subj: 'Psych' },
      { q: 'Motivational interviewing uses:', opts: ['OARS: Open questions, Affirmations, Reflections, Summaries', 'Confrontation', 'Advice-giving', 'Directiveness'], a: 0, subj: 'Psych' },
      { q: 'Stages of change model includes:', opts: ['Precontemplation, contemplation, preparation, action, maintenance', 'Action only', 'Two stages', 'No stages'], a: 0, subj: 'Psych' },
      { q: 'Ambivalence in change means:', opts: ['Mixed feelings about changing', 'No feelings', 'Decided', 'Resistance only'], a: 0, subj: 'Psych' },
      { q: 'Rolling with resistance means:', opts: ['Avoid arguing, explore', 'Confront', 'Give up', 'Force change'], a: 0, subj: 'Psych' },
      { q: 'Expressed emotion (EE) in families:', opts: ['Criticism, hostility, overinvolvement', 'Support only', 'Nothing', 'Love only'], a: 0, subj: 'Psych' },
      { q: 'High EE correlates with:', opts: ['Worse outcomes, relapse', 'Better outcomes', 'No effect', 'Cure'], a: 0, subj: 'Psych' },
      { q: 'Family psychoeducation aims to:', opts: ['Reduce EE, improve support', 'Blame family', 'Exclude family', 'Medication only'], a: 0, subj: 'Psych' },
      { q: 'Assertive community treatment (ACT):', opts: ['Intensive community-based care for SMI', 'Hospital only', 'Outpatient only', 'No outreach'], a: 0, subj: 'Psych' },
      { q: 'SMI stands for:', opts: ['Serious mental illness', 'Somatic mental illness', 'Simple', 'Severe'], a: 0, subj: 'Psych' },
      { q: 'Wraparound services provide:', opts: ['Individualized, comprehensive care planning', 'Standard care only', 'Hospital only', 'Nothing'], a: 0, subj: 'Psych' },
      { q: 'Crisis residential services offer:', opts: ['Short-term alternative to hospitalization', 'Long-term care', 'No care', 'Hospital only'], a: 0, subj: 'Psych' },
      { q: 'Partial hospitalization (PHP) provides:', opts: ['Day treatment, return home at night', '24/7 care', 'Outpatient only', 'No structure'], a: 0, subj: 'Psych' },
      { q: 'Intensive outpatient (IOP) typically:', opts: ['Several hours per day, several days/week', 'Once weekly', 'Daily 24hr', 'Monthly'], a: 0, subj: 'Psych' },
      { q: 'Supported employment helps:', opts: ['Find and maintain jobs despite mental illness', 'Avoid work', 'Disability only', 'Nothing'], a: 0, subj: 'Psych' },
      { q: 'Clubhouse model provides:', opts: ['Peer support, work-ordered day', 'Medical care only', 'Housing only', 'Nothing'], a: 0, subj: 'Psych' },
      { q: 'Peer support specialists:', opts: ['Have lived experience of mental illness', 'Are always professionals', 'No training', 'Replace clinicians'], a: 0, subj: 'Psych' },
      { q: 'Trauma-informed care recognizes:', opts: ['Impact of trauma on behavior and health', 'Nothing', 'Only PTSD', 'Only adults'], a: 0, subj: 'Psych' },
      { q: 'ACE (Adverse Childhood Experiences) study showed:', opts: ['Link between trauma and health outcomes', 'No link', 'Only mental health', 'Only adults'], a: 0, subj: 'Psych' },
      { q: 'Triggers in PTSD are:', opts: ['Reminders that evoke trauma response', 'Nothing', 'Only sights', 'Only sounds'], a: 0, subj: 'Psych' },
      { q: 'Grounding techniques help with:', opts: ['Dissociation, flashbacks', 'Nothing', 'Only anxiety', 'Only depression'], a: 0, subj: 'Psych' },
      { q: 'EMDR (Eye Movement Desensitization) is used for:', opts: ['PTSD, trauma', 'Depression only', 'Psychosis', 'Bipolar'], a: 0, subj: 'Psych' },
      { q: 'Prolonged exposure therapy for PTSD:', opts: ['Repeated recounting and in-vivo exposure', 'Avoidance', 'Medication only', 'Brief only'], a: 0, subj: 'Psych' },
      { q: 'CPT (Cognitive Processing Therapy) addresses:', opts: ['Trauma-related stuck points', 'Behavior only', 'Medication', 'Nothing'], a: 0, subj: 'Psych' },
      { q: 'Disorganized attachment may result from:', opts: ['Inconsistent or frightening caregiving', 'Good parenting', 'Genetics only', 'Nothing'], a: 0, subj: 'Psych' },
      { q: 'Attachment styles affect:', opts: ['Relationships, coping', 'Nothing', 'Only childhood', 'Only therapy'], a: 0, subj: 'Psych' },
      { q: 'Object relations theory focuses on:', opts: ['Internalized relationships', 'External only', 'Behavior only', 'Nothing'], a: 0, subj: 'Psych' },
      { q: 'Splitting in BPD manifests as:', opts: ['Seeing people as all good or all bad', 'Dividing tasks', 'Sharing', 'Compromise'], a: 0, subj: 'Psych' },
      { q: 'Dialectics in DBT means:', opts: ['Balancing opposites, both-and', 'Either-or', 'One truth', 'No balance'], a: 0, subj: 'Psych' },
      { q: 'Self-harm assessment includes:', opts: ['Intent, lethality, function', 'Only cuts', 'Only suicide', 'Nothing'], a: 0, subj: 'Psych' },
      { q: 'NSSI (non-suicidal self-injury) may function to:', opts: ['Regulate emotion, punish self', 'Suicide attempt', 'Nothing', 'Attention only'], a: 0, subj: 'Psych' },
      { q: 'Safety planning for suicide includes:', opts: ['Warning signs, coping strategies, supports', 'Contract only', 'Hospitalization only', 'Nothing'], a: 0, subj: 'Psych' },
      { q: 'No-suicide contract is:', opts: ['Not a substitute for thorough assessment', 'Always reliable', 'Legal document', 'Sufficient alone'], a: 0, subj: 'Psych' },
      { q: 'Lethal means counseling aims to:', opts: ['Reduce access to lethal methods', 'Nothing', 'Only guns', 'Only medication'], a: 0, subj: 'Psych' },
      { q: 'Serotonin syndrome can result from:', opts: ['Excess serotonergic activity', 'Too little serotonin', 'Dopamine', 'Nothing'], a: 0, subj: 'Psych' },
      { q: 'NMS vs serotonin syndrome: NMS involves:', opts: ['Dopamine blockade, rigidity', 'Serotonin', 'Both same', 'Neither'], a: 0, subj: 'Psych' },
      { q: 'Anticholinergic toxicity presents with:', opts: ['Dry, hot, red, mad, blind', 'Wet, cold', 'No symptoms', 'Only GI'], a: 0, subj: 'Psych' },
      { q: 'Toxic serotonin syndrome treatment:', opts: ['Stop serotonergic drugs, support', 'More SSRIs', 'Anticholinergics', 'Nothing'], a: 0, subj: 'Psych' },
      { q: 'Lithium toxicity signs include:', opts: ['Coarse tremor, ataxia, confusion', 'No signs', 'Only nausea', 'Only thirst'], a: 0, subj: 'Psych' },
      { q: 'Lithium level should be checked:', opts: ['Regularly, with changes', 'Never', 'Once', 'Only if toxic'], a: 0, subj: 'Psych' },
      { q: 'Valproate requires:', opts: ['Liver function, platelet monitoring', 'No monitoring', 'Kidney only', 'CBC only'], a: 0, subj: 'Psych' },
      { q: 'Carbamazepine can cause:', opts: ['SIADH, blood dyscrasias', 'Nothing', 'Only sedation', 'Only weight gain'], a: 0, subj: 'Psych' },
      { q: 'Lamotrigine requires:', opts: ['Slow titration (rash risk)', 'Rapid titration', 'No titration', 'No risk'], a: 0, subj: 'Psych' },
      { q: 'Lamotrigine rash (SJS) is:', opts: ['Medical emergency', 'Benign', 'Common', 'Ignore'], a: 0, subj: 'Psych' },
      { q: 'Antipsychotic metabolic effects include:', opts: ['Weight gain, diabetes, dyslipidemia', 'Weight loss', 'Nothing', 'Only sedation'], a: 0, subj: 'Psych' },
      { q: 'Prolactin elevation from antipsychotics can cause:', opts: ['Galactorrhea, sexual dysfunction', 'Nothing', 'Only weight gain', 'Only sedation'], a: 0, subj: 'Psych' },
      { q: 'QT prolongation risk with psychotropics:', opts: ['Some antipsychotics, antidepressants', 'None', 'Only lithium', 'Only benzos'], a: 0, subj: 'Psych' },
      { q: 'Antidepressant discontinuation syndrome:', opts: ['Flu-like, dizziness when stopped abruptly', 'Nothing', 'Only with MAOIs', 'Rare'], a: 0, subj: 'Psych' },
      { q: 'SSRIs should be tapered to:', opts: ['Reduce discontinuation symptoms', 'Nothing', 'Stop immediately', 'Double dose'], a: 0, subj: 'Psych' },
      { q: 'MAOI diet restricts:', opts: ['Tyramine-containing foods', 'All food', 'Nothing', 'Only alcohol'], a: 0, subj: 'Psych' },
      { q: 'Tyramine in MAOI use can cause:', opts: ['Hypertensive crisis', 'Hypotension', 'Nothing', 'Serotonin syndrome'], a: 0, subj: 'Psych' },
      { q: 'Washout between MAOI and SSRI:', opts: ['Required (2-5 weeks typically)', 'Not needed', '1 day', '1 week'], a: 0, subj: 'Psych' },
      { q: 'Delirium vs dementia: delirium is:', opts: ['Acute, fluctuating, often reversible', 'Chronic', 'Progressive only', 'Same'], a: 0, subj: 'Psych' },
      { q: 'Sundowning in dementia refers to:', opts: ['Increased confusion/agitation in evening', 'Morning only', 'No pattern', 'Sleep only'], a: 0, subj: 'Psych' },
      { q: 'Validation therapy in dementia:', opts: ['Acknowledge feelings, enter their reality', 'Reorient only', 'Correct always', 'Ignore'], a: 0, subj: 'Psych' },
      { q: 'Reality orientation:', opts: ['Remind of time, place, person', 'Go along with delusions', 'Nothing', 'Only for mild dementia'], a: 0, subj: 'Psych' },
      { q: 'Wandering in dementia management:', opts: ['Safe environment, activities', 'Restraints', 'Medication only', 'Ignore'], a: 0, subj: 'Psych' },
      { q: 'Hoarding disorder treatment includes:', opts: ['CBT, harm reduction', 'Forced cleanup', 'Medication only', 'Nothing'], a: 0, subj: 'Psych' },
      { q: 'Body dysmorphic disorder involves:', opts: ['Preoccupation with perceived flaw', 'Actual deformity', 'Eating disorder only', 'Nothing'], a: 0, subj: 'Psych' },
      { q: 'Trichotillomania is:', opts: ['Hair-pulling disorder', 'Skin picking', 'Nail biting', 'OCD only'], a: 0, subj: 'Psych' },
      { q: 'Excoriation disorder is:', opts: ['Skin-picking disorder', 'Hair pulling', 'OCD', 'Dermatology only'], a: 0, subj: 'Psych' },
      /* +100 Pharmacology */
      { q: 'Bioavailability is:', opts: ['Fraction of drug reaching systemic circulation', 'Dose', 'Half-life', 'Peak level'], a: 0, subj: 'Pharmacology' },
      { q: 'Half-life determines:', opts: ['Dosing interval, time to steady state', 'Efficacy', 'Toxicity only', 'Nothing'], a: 0, subj: 'Pharmacology' },
      { q: 'Steady state is reached after:', opts: ['~5 half-lives', '1 dose', '1 hour', '1 day'], a: 0, subj: 'Pharmacology' },
      { q: 'First-pass metabolism occurs in:', opts: ['Liver after oral absorption', 'Kidney', 'Gut only', 'Blood'], a: 0, subj: 'Pharmacology' },
      { q: 'CYP450 enzymes primarily in:', opts: ['Liver', 'Kidney', 'Gut', 'Blood'], a: 0, subj: 'Pharmacology' },
      { q: 'CYP3A4 inhibitors include:', opts: ['Ketoconazole, grapefruit', 'Rifampin', 'Phenytoin', 'Carbamazepine'], a: 0, subj: 'Pharmacology' },
      { q: 'CYP3A4 inducers include:', opts: ['Rifampin, phenytoin', 'Ketoconazole', 'Grapefruit', 'Erythromycin'], a: 0, subj: 'Pharmacology' },
      { q: 'Prodrug requires:', opts: ['Metabolism to active form', 'No metabolism', 'Direct action', 'Activation only in liver'], a: 0, subj: 'Pharmacology' },
      { q: 'Enterohepatic circulation:', opts: ['Drug reabsorbed from bile', 'Elimination only', 'First pass', 'Nothing'], a: 0, subj: 'Pharmacology' },
      { q: 'Volume of distribution (Vd) affects:', opts: ['Loading dose, tissue distribution', 'Efficacy', 'Half-life only', 'Nothing'], a: 0, subj: 'Pharmacology' },
      { q: 'Loading dose is used to:', opts: ['Reach therapeutic level quickly', 'Maintain level', 'Reduce toxicity', 'Nothing'], a: 0, subj: 'Pharmacology' },
      { q: 'Maintenance dose:', opts: ['Replaces eliminated drug', 'Loading only', 'Single dose', 'Bolus only'], a: 0, subj: 'Pharmacology' },
      { q: 'Narrow therapeutic index means:', opts: ['Small difference between therapeutic and toxic', 'Wide margin', 'Safe', 'No monitoring'], a: 0, subj: 'Pharmacology' },
      { q: 'Drugs with narrow therapeutic index include:', opts: ['Warfarin, digoxin, lithium', 'Acetaminophen', 'Ibuprofen', 'Metformin'], a: 0, subj: 'Pharmacology' },
      { q: 'Trough level is drawn:', opts: ['Just before next dose', 'At peak', 'Random', 'After dose'], a: 0, subj: 'Pharmacology' },
      { q: 'Peak level timing varies by:', opts: ['Drug, route', 'Always 1 hour', 'Always 30 min', 'No variation'], a: 0, subj: 'Pharmacology' },
      { q: 'Renal dosing considers:', opts: ['GFR, creatinine clearance', 'Liver only', 'Weight only', 'Nothing'], a: 0, subj: 'Pharmacology' },
      { q: 'Hepatic dosing considers:', opts: ['Liver function, Child-Pugh', 'Kidney only', 'Nothing', 'Weight only'], a: 0, subj: 'Pharmacology' },
      { q: 'Child-Pugh score assesses:', opts: ['Liver disease severity', 'Kidney', 'Heart', 'Lung'], a: 0, subj: 'Pharmacology' },
      { q: 'Cockcroft-Gault estimates:', opts: ['Creatinine clearance', 'GFR only', 'Liver function', 'Nothing'], a: 0, subj: 'Pharmacology' },
      { q: 'Beers criteria list:', opts: ['Potentially inappropriate meds in elderly', 'All meds', 'Pediatric', 'Pregnancy'], a: 0, subj: 'Pharmacology' },
      { q: 'START/STOPP criteria address:', opts: ['Medication appropriateness in elderly', 'Pediatrics', 'Pregnancy', 'Nothing'], a: 0, subj: 'Pharmacology' },
      { q: 'Black box warning indicates:', opts: ['Serious risk from FDA', 'Mild risk', 'No risk', 'Contraindication'], a: 0, subj: 'Pharmacology' },
      { q: 'Contraindication means:', opts: ['Should not use', 'Use with caution', 'Same as precaution', 'Optional'], a: 0, subj: 'Pharmacology' },
      { q: 'Precaution means:', opts: ['Use with caution, weigh risk/benefit', 'Do not use', 'Same as contraindication', 'No concern'], a: 0, subj: 'Pharmacology' },
      { q: 'Adverse drug reaction (ADR):', opts: ['Harmful response to drug', 'Therapeutic effect', 'Placebo', 'Nothing'], a: 0, subj: 'Pharmacology' },
      { q: 'Type A adverse reaction is:', opts: ['Dose-dependent, predictable', 'Idiosyncratic', 'Allergic', 'Rare'], a: 0, subj: 'Pharmacology' },
      { q: 'Type B adverse reaction is:', opts: ['Unpredictable, idiosyncratic', 'Dose-dependent', 'Common', 'Expected'], a: 0, subj: 'Pharmacology' },
      { q: 'Anaphylaxis is:', opts: ['Life-threatening allergic reaction', 'Mild rash', 'Nausea', 'Headache'], a: 0, subj: 'Pharmacology' },
      { q: 'Cross-sensitivity may occur between:', opts: ['Structurally similar drugs', 'Unrelated drugs', 'No drugs', 'All drugs'], a: 0, subj: 'Pharmacology' },
      { q: 'Sulfa allergy may cross with:', opts: ['Sulfonamide antibiotics, some diuretics', 'Penicillins', 'Cephalosporins', 'Nothing'], a: 0, subj: 'Pharmacology' },
      { q: 'Penicillin allergy cross-reactivity with cephalosporins:', opts: ['Low with 2nd/3rd gen', 'High always', 'None', '100%'], a: 0, subj: 'Pharmacology' },
      { q: 'Teratogenic drugs in pregnancy:', opts: ['Can cause fetal harm', 'Safe', 'All drugs', 'None'], a: 0, subj: 'Pharmacology' },
      { q: 'Pregnancy category (old) X means:', opts: ['Contraindicated in pregnancy', 'Safe', 'Unknown', 'Caution'], a: 0, subj: 'Pharmacology' },
      { q: 'Pregnancy Lactation Rule (new) provides:', opts: ['Risk summary for pregnancy and breastfeeding', 'Nothing', 'Old categories', 'Safety only'], a: 0, subj: 'Pharmacology' },
      { q: 'Drugs excreted in breast milk:', opts: ['Vary; check compatibility', 'None', 'All', 'Only OTC'], a: 0, subj: 'Pharmacology' },
      { q: 'LactMed is a resource for:', opts: ['Drug use in breastfeeding', 'Pregnancy only', 'Pediatrics', 'Elderly'], a: 0, subj: 'Pharmacology' },
      { q: 'Pediatric dosing often uses:', opts: ['Weight or BSA', 'Adult dose', 'Age only', 'No calculation'], a: 0, subj: 'Pharmacology' },
      { q: 'Clark\'s rule estimates pediatric dose from:', opts: ['Adult dose by weight', 'BSA', 'Age', 'Nothing'], a: 0, subj: 'Pharmacology' },
      { q: 'Young\'s rule uses:', opts: ['Age in formula for pediatric dose', 'Weight', 'BSA', 'Nothing'], a: 0, subj: 'Pharmacology' },
      { q: 'IV compatibility means:', opts: ['Drugs can be mixed without reaction', 'Same syringe', 'Same bag', 'Nothing'], a: 0, subj: 'Pharmacology' },
      { q: 'Y-site compatibility:', opts: ['Compatibility when given through same IV line', 'Oral', 'IM', 'Nothing'], a: 0, subj: 'Pharmacology' },
      { q: 'Precipitation occurs when:', opts: ['Incompatible drugs form solid', 'Drug dissolves', 'Normal', 'Nothing'], a: 0, subj: 'Pharmacology' },
      { q: 'IV push rate varies by:', opts: ['Drug; some must be slow', 'Always fast', 'Always slow', 'No variation'], a: 0, subj: 'Pharmacology' },
      { q: 'Vesicant drugs can cause:', opts: ['Tissue damage if extravasated', 'Nothing', 'Mild irritation', 'Allergy'], a: 0, subj: 'Pharmacology' },
      { q: 'Vinca alkaloids are:', opts: ['Vesicants', 'Irritants only', 'Safe', 'Never extravasate'], a: 0, subj: 'Pharmacology' },
      { q: 'Antidote for vinca extravasation may include:', opts: ['Hyaluronidase', 'Nothing', 'Warm compress', 'Ice'], a: 0, subj: 'Pharmacology' },
      { q: 'Doxorubicin extravasation:', opts: ['Requires prompt management', 'No concern', 'Ice only', 'Nothing'], a: 0, subj: 'Pharmacology' },
      { q: 'Antiemetic for chemotherapy:', opts: ['5-HT3 antagonists, NK1 antagonists', 'Opioids', 'Antibiotics', 'Nothing'], a: 0, subj: 'Pharmacology' },
      { q: 'Ondansetron is a:', opts: ['5-HT3 receptor antagonist', 'Dopamine antagonist', 'NK1 antagonist', 'Anticholinergic'], a: 0, subj: 'Pharmacology' },
      { q: 'Aprepitant is:', opts: ['NK1 receptor antagonist', '5-HT3 antagonist', 'Dopamine antagonist', 'Corticosteroid'], a: 0, subj: 'Pharmacology' },
      { q: 'Dexamethasone in chemo regimens:', opts: ['Enhances antiemetic effect', 'Causes nausea', 'No role', 'Replaces others'], a: 0, subj: 'Pharmacology' },
      { q: 'G-CSF (filgrastim) stimulates:', opts: ['White blood cell production', 'RBC', 'Platelets', 'Nothing'], a: 0, subj: 'Pharmacology' },
      { q: 'Erythropoietin stimulates:', opts: ['Red blood cell production', 'WBC', 'Platelets', 'Nothing'], a: 0, subj: 'Pharmacology' },
      { q: 'Opioid rotation is used when:', opts: ['Tolerance or poor response', 'First choice', 'Never', 'Cost only'], a: 0, subj: 'Pharmacology' },
      { q: 'Equianalgesic dosing:', opts: ['Converts between opioids at equivalent pain relief', 'Same dose', 'Random', 'Nothing'], a: 0, subj: 'Pharmacology' },
      { q: 'Morphine to hydromorphone conversion:', opts: ['Approximately 5:1 to 7.5:1', '1:1', '10:1', 'No conversion'], a: 0, subj: 'Pharmacology' },
      { q: 'Fentanyl patch onset:', opts: ['12-24 hours to steady state', 'Immediate', '1 hour', '5 minutes'], a: 0, subj: 'Pharmacology' },
      { q: 'Fentanyl patch has:', opts: ['Residual drug after removal', 'No residual', 'Short half-life', 'No risk'], a: 0, subj: 'Pharmacology' },
      { q: 'Buprenorphine is:', opts: ['Partial opioid agonist', 'Full agonist', 'Antagonist', 'Nothing'], a: 0, subj: 'Pharmacology' },
      { q: 'Naloxone duration is:', opts: ['Shorter than many opioids; may need repeat', 'Longer', 'Same', 'No limit'], a: 0, subj: 'Pharmacology' },
      { q: 'Methylnaltrexone is used for:', opts: ['Opioid-induced constipation', 'Overdose', 'Pain', 'Nothing'], a: 0, subj: 'Pharmacology' },
      { q: 'Alpha-2 agonists (clonidine, dexmedetomidine):', opts: ['Reduce sympathetic outflow', 'Stimulate', 'No cardiovascular effect', 'Hypertension'], a: 0, subj: 'Pharmacology' },
      { q: 'Clonidine withdrawal can cause:', opts: ['Rebound hypertension', 'Hypotension', 'Nothing', 'Bradycardia'], a: 0, subj: 'Pharmacology' },
      { q: 'Hydralazine is a:', opts: ['Direct vasodilator', 'ACE inhibitor', 'Beta-blocker', 'CCB'], a: 0, subj: 'Pharmacology' },
      { q: 'Nitroprusside is:', opts: ['IV vasodilator for hypertensive emergency', 'Oral', 'Long-acting', 'Not for emergency'], a: 0, subj: 'Pharmacology' },
      { q: 'Nitroprusside can cause:', opts: ['Cyanide/thiocyanate toxicity with prolonged use', 'Nothing', 'Hypotension only', 'Hypertension'], a: 0, subj: 'Pharmacology' },
      { q: 'Labetalol has:', opts: ['Alpha and beta blocking activity', 'Only beta', 'Only alpha', 'Neither'], a: 0, subj: 'Pharmacology' },
      { q: 'Esmolol is:', opts: ['Short-acting IV beta-blocker', 'Long-acting', 'Oral only', 'Alpha-blocker'], a: 0, subj: 'Pharmacology' },
      { q: 'Diltiazem and verapamil are:', opts: ['Non-dihydropyridine CCBs', 'Dihydropyridine', 'Beta-blockers', 'ACE inhibitors'], a: 0, subj: 'Pharmacology' },
      { q: 'Amlodipine is:', opts: ['Dihydropyridine CCB', 'Non-DHP', 'Beta-blocker', 'ACE inhibitor'], a: 0, subj: 'Pharmacology' },
      { q: 'ARBs (e.g., losartan) block:', opts: ['Angiotensin II receptors', 'ACE', 'Beta receptors', 'Calcium'], a: 0, subj: 'Pharmacology' },
      { q: 'ARBs do not typically cause:', opts: ['Dry cough (unlike ACEi)', 'Hyperkalemia', 'Renal effects', 'Hypotension'], a: 0, subj: 'Pharmacology' },
      { q: 'Sacubitril/valsartan (Entresto) is for:', opts: ['Heart failure with reduced EF', 'Hypertension only', 'MI only', 'Arrhythmia'], a: 0, subj: 'Pharmacology' },
      { q: 'Spironolactone in heart failure:', opts: ['Aldosterone antagonist, mortality benefit', 'Only diuresis', 'No benefit', 'Contraindicated'], a: 0, subj: 'Pharmacology' },
      { q: 'Ivabradine reduces:', opts: ['Heart rate in HF', 'BP', 'Fluid', 'Nothing'], a: 0, subj: 'Pharmacology' },
      { q: 'Sacubitril/valsartan requires:', opts: ['36-hour washout from ACEi', 'No washout', '1 day', '1 week'], a: 0, subj: 'Pharmacology' },
      { q: 'Entresto and ACEi together:', opts: ['Contraindicated (angioedema risk)', 'Recommended', 'No interaction', 'Optional'], a: 0, subj: 'Pharmacology' },
      { q: 'Prasugrel and ticagrelor are:', opts: ['P2Y12 inhibitors (antiplatelet)', 'Anticoagulants', 'Statins', 'ACE inhibitors'], a: 0, subj: 'Pharmacology' },
      { q: 'Clopidogrel is a prodrug requiring:', opts: ['CYP2C19 activation', 'No metabolism', 'Liver only', 'Kidney'], a: 0, subj: 'Pharmacology' },
      { q: 'CYP2C19 poor metabolizers with clopidogrel:', opts: ['May have reduced efficacy', 'Better efficacy', 'No difference', 'Toxicity'], a: 0, subj: 'Pharmacology' },
      { q: 'Apixaban and rivaroxaban are:', opts: ['Factor Xa inhibitors', 'Factor IIa', 'Vitamin K antagonists', 'Antiplatelet'], a: 0, subj: 'Pharmacology' },
      { q: 'Dabigatran is:', opts: ['Direct thrombin inhibitor', 'Factor Xa', 'Vitamin K antagonist', 'Antiplatelet'], a: 0, subj: 'Pharmacology' },
      { q: 'DOAC reversal: andexanet for:', opts: ['Factor Xa inhibitors', 'Dabigatran', 'Warfarin', 'Heparin'], a: 0, subj: 'Pharmacology' },
      { q: 'Idarucizumab reverses:', opts: ['Dabigatran only', 'All DOACs', 'Warfarin', 'Heparin'], a: 0, subj: 'Pharmacology' },
      { q: 'Which lab indicates kidney function?', opts: ['Creatinine and BUN', 'ALT and AST', 'Troponin', 'Hemoglobin'], a: 0, subj: 'Med-Surg' },
      { q: 'A patient with chest tube has continuous bubbling. This suggests:', opts: ['Possible air leak', 'Normal function', 'Clogged tube', 'Ready for removal'], a: 0, subj: 'Med-Surg' },
      { q: 'First intervention for suspected anaphylaxis:', opts: ['Epinephrine IM', 'Antihistamine', 'Steroids', 'IV fluids first'], a: 0, subj: 'Pharmacology' },
      { q: 'When a patient is confused and pulling at lines, the nurse should first:', opts: ['Assess cause, reorient, ensure safety', 'Apply restraints', 'Sedate', 'Ignore'], a: 0, subj: 'Fundamentals' },
      { q: 'C. difficile infection requires:', opts: ['Contact precautions, handwashing with soap', 'Droplet precautions', 'Airborne precautions', 'Standard only'], a: 0, subj: 'Fundamentals' },
      { q: 'Signs of respiratory distress in a child include:', opts: ['Nasal flaring, retractions, grunting', 'Slow breathing only', 'Pink skin', 'Normal activity'], a: 0, subj: 'Med-Surg' },
      { q: 'Before administering a blood transfusion, you must:', opts: ['Verify with another nurse, check type, match ID', 'Check type only', 'Start infusion quickly', 'No special checks'], a: 0, subj: 'Fundamentals' },
      { q: 'A patient on warfarin with INR of 5.5 should:', opts: ['Hold dose, notify provider', 'Continue as ordered', 'Give extra dose', 'Switch to heparin'], a: 0, subj: 'Pharmacology' },
      { q: 'Priority nursing action for pulmonary embolism:', opts: ['Oxygen, monitor, notify provider', 'Elevate legs', 'Restrict fluids', 'Ambulate'], a: 0, subj: 'Med-Surg' },
      { q: 'Manic episode is characterized by:', opts: ['Grandiosity, decreased need for sleep', 'Severe sadness', 'Anxiety only', 'Hallucinations only'], a: 0, subj: 'Psych' },
      { q: 'Which finding suggests hypoglycemia?', opts: ['Sweating, tremor, confusion', 'Kussmaul respirations', 'Fruity breath', 'Hot dry skin'], a: 0, subj: 'Med-Surg' },
      { q: 'Safe delegation to nursing assistant includes:', opts: ['Vital signs, ADLs, feeding', 'Assessment', 'Medication administration', 'IV insertion'], a: 0, subj: 'Fundamentals' },
      { q: 'ACE inhibitor that causes angioedema requires:', opts: ['Discontinue drug, ensure airway', 'Reduce dose', 'Add antihistamine', 'Continue medication'], a: 0, subj: 'Pharmacology' },
      { q: 'Priority for patient with active GI bleed:', opts: ['ABCs, IV access, fluid resuscitation', 'Oral fluids', 'Diet teaching', 'Discharge planning'], a: 0, subj: 'Med-Surg' },
      { q: 'Contraindication for tPA in stroke:', opts: ['Active bleeding, recent surgery', 'Hypertension', 'Diabetes', 'Age over 80'], a: 0, subj: 'Med-Surg' },
      { q: 'Lithium toxicity is worsened by:', opts: ['Dehydration, NSAIDs, diuretics', 'Fluid intake', 'Sodium intake', 'Food'], a: 0, subj: 'Psych' },
      { q: 'When patient refuses medication, nurse should:', opts: ['Document, educate on consequences, notify provider', 'Force administration', 'Hide in food', 'Skip documenting'], a: 0, subj: 'Fundamentals' },
      { q: 'Hyperkalemia ECG changes include:', opts: ['Peaked T waves, widened QRS', 'Flat T waves', 'Short PR', 'Normal ECG'], a: 0, subj: 'Med-Surg' },
      { q: 'Flumazenil is used to reverse:', opts: ['Benzodiazepine overdose', 'Opioid overdose', 'Warfarin', 'Heparin'], a: 0, subj: 'Pharmacology' },
      { q: 'Primary prevention of pressure ulcers:', opts: ['Repositioning, skin care, off-loading', 'Antibiotics', 'Surgery', 'Bed rest'], a: 0, subj: 'Fundamentals' },
      { q: 'Signs of sepsis include:', opts: ['Fever, tachycardia, altered mental status', 'Bradycardia only', 'Hypothermia only', 'Normal vitals'], a: 0, subj: 'Med-Surg' },
      { q: 'Metformin should be held before:', opts: ['Contrast imaging', 'Meals', 'Exercise', 'Sleep'], a: 0, subj: 'Pharmacology' },
      { q: 'Therapeutic communication for angry patient:', opts: ['Stay calm, validate feelings, set limits', 'Argue back', 'Leave immediately', 'Restrain'], a: 0, subj: 'Psych' },
      { q: 'Patient with DVT should avoid:', opts: ['Massaging the affected leg', 'Ambulation', 'Anticoagulants', 'Compression stockings'], a: 0, subj: 'Med-Surg' },
      { q: 'Cushing syndrome presents with:', opts: ['Moon face, buffalo hump, hyperglycemia', 'Weight loss', 'Hypotension', 'Hypoglycemia'], a: 0, subj: 'Med-Surg' },
      { q: 'Patient with dysphagia should be:', opts: ['Assessed for aspiration risk, positioned upright', 'Fed quickly', 'Given thin liquids only', 'NPO always'], a: 0, subj: 'Med-Surg' },
      { q: 'First action when patient has seizure:', opts: ['Ensure safety, protect head, time it', 'Restrain', 'Put something in mouth', 'Leave to get help'], a: 0, subj: 'Fundamentals' },
      { q: 'Signs of catheter-associated UTI:', opts: ['Fever, cloudy urine, dysuria', 'Normal urine', 'Back pain only', 'Rash'], a: 0, subj: 'Med-Surg' },
      { q: 'Patient on fluid restriction should:', opts: ['Space fluids, use ice chips, small cups', 'Drink freely', 'Avoid all fluids', 'Only IV fluids'], a: 0, subj: 'Med-Surg' },
      { q: 'Colostomy output that is liquid may indicate:', opts: ['Upper GI stoma, need for monitoring', 'Normal always', 'Infection', 'Closure'], a: 0, subj: 'Med-Surg' },
      { q: 'Tracheostomy care includes:', opts: ['Suction PRN, clean inner cannula, secure ties', 'Never suction', 'Change daily', 'No humidification'], a: 0, subj: 'Med-Surg' },
      { q: 'Braden scale assesses:', opts: ['Pressure injury risk', 'Fall risk', 'Pain', 'Mental status'], a: 0, subj: 'Fundamentals' },
      { q: 'Morse Fall Scale assesses:', opts: ['Fall risk', 'Pressure injury', 'Pain', 'Nutrition'], a: 0, subj: 'Fundamentals' },
      { q: 'Patient with latex allergy may cross-react with:', opts: ['Banana, avocado, chestnut', 'Milk', 'Wheat', 'Shellfish'], a: 0, subj: 'Fundamentals' },
      { q: 'Most common cause of hospital-acquired pneumonia:', opts: ['Aspiration', 'Contaminated food', 'Airborne virus', 'Contact'], a: 0, subj: 'Med-Surg' },
      { q: 'Negative pressure wound therapy:', opts: ['Promotes healing, removes exudate', 'Increases infection', 'Not used for wounds', 'Replaces dressings'], a: 0, subj: 'Med-Surg' },
      { q: 'Patient with neutropenia should:', opts: ['Avoid crowds, raw foods, fresh flowers', 'No restrictions', 'Avoid all contact', 'Stay outdoors'], a: 0, subj: 'Med-Surg' },
      { q: 'Symptom of serotonin syndrome:', opts: ['Agitation, hyperthermia, rigidity', 'Hypothermia', 'Bradycardia', 'Hypotension'], a: 0, subj: 'Pharmacology' },
      { q: 'Lamotrigine requires:', opts: ['Slow titration to reduce rash risk', 'Loading dose', 'No titration', 'IV only'], a: 0, subj: 'Pharmacology' },
      { q: 'Carbamazepine can cause:', opts: ['SIADH, hyponatremia', 'Hypernatremia', 'No electrolyte effect', 'Hyperkalemia'], a: 0, subj: 'Pharmacology' },
      { q: 'Wernicke-Korsakoff syndrome results from:', opts: ['Thiamine deficiency in alcoholism', 'Vitamin C', 'Iron', 'Calcium'], a: 0, subj: 'Psych' },
      { q: 'Priority for patient with acute delirium:', opts: ['Identify cause, ensure safety, orient', 'Restrain first', 'Sedate', 'Ignore'], a: 0, subj: 'Psych' },
      { q: 'When patient expresses suicidal ideation:', opts: ['Assess intent, plan, means; ensure safety', 'Ignore', 'Promise secrecy', 'Minimize'], a: 0, subj: 'Psych' },
      { q: 'Sign of compartment syndrome:', opts: ['Pain out of proportion, pallor, paresthesia', 'Mild discomfort', 'Warmth', 'Bounding pulse'], a: 0, subj: 'Med-Surg' },
      { q: 'Fat embolism often occurs after:', opts: ['Long bone fracture', 'Minor cuts', 'Surgery', 'Medication'], a: 0, subj: 'Med-Surg' },
      { q: 'Autonomic dysreflexia is triggered by:', opts: ['Distended bladder or bowel in spinal injury', 'Emotion', 'Food', 'Exercise'], a: 0, subj: 'Med-Surg' },
      { q: 'First action for autonomic dysreflexia:', opts: ['Sit upright, loosen clothes, check bladder', 'Lie flat', 'Give fluids', 'Call family'], a: 0, subj: 'Med-Surg' },
      { q: 'Bleeding precautions for thrombocytopenia:', opts: ['Soft toothbrush, avoid razors, no NSAIDs', 'Normal activities', 'Anticoagulants', 'Contact sports'], a: 0, subj: 'Med-Surg' },
      { q: 'Patient on continuous tube feeding with residual 300 mL:', opts: ['Hold, assess, recheck', 'Continue', 'Increase rate', 'Stop permanently'], a: 0, subj: 'Med-Surg' },
    ];
    const QUIZ_GAME_SIZE = 20;
    const QUIZ_TOPICS = ['Fundamentals', 'Med-Surg', 'Psych', 'Pharmacology'];
    const quizTopicSelector = document.getElementById('quiz-topic-selector');
    const quizTopicError = document.getElementById('quiz-topic-error');
    const quizStats = document.getElementById('quiz-stats');
    const quizActions = document.getElementById('quiz-actions');
    const quizArea = document.getElementById('quiz-area');
    const quizScoreEl = document.getElementById('quiz-score');
    const quizCurrentEl = document.getElementById('quiz-current');
    const quizWinEl = document.getElementById('quiz-win');
    const quizShareBtn = document.getElementById('quiz-share');
    const quizWrongReview = document.getElementById('quiz-wrong-review');
    let quizState = { index: 0, score: 0, answered: false, currentQuestions: [], wrongAnswers: [] };

    function showQuizTopicSelector() {
      quizTopicSelector.style.display = 'block';
      quizStats.style.display = 'none';
      quizActions.style.display = 'none';
      quizArea.innerHTML = '';
      quizWinEl.classList.remove('visible');
      quizWrongReview.innerHTML = '';
      quizTopicError.classList.add('hidden');
    }

    function startQuizFromTopics() {
      const selected = Array.from(document.querySelectorAll('input[name="quiz-topic"]:checked')).map(cb => cb.value);
      if (selected.length < 1) {
        quizTopicError.classList.remove('hidden');
        return;
      }
      quizTopicError.classList.add('hidden');
      quizTopicSelector.style.display = 'none';
      quizStats.style.display = '';
      quizActions.style.display = '';
      initQuiz(selected);
    }

    function initQuiz(selectedTopics) {
      const pool = QUIZ_QUESTIONS.filter(q => selectedTopics.includes(q.subj || 'Fundamentals'));
      if (pool.length < QUIZ_GAME_SIZE) {
        quizArea.innerHTML = `<p class="quiz-topic-error">Not enough questions for selected topics. Please select more topics.</p>`;
        return;
      }
      const indices = [];
      while (indices.length < QUIZ_GAME_SIZE) {
        const r = Math.floor(Math.random() * pool.length);
        if (!indices.includes(r)) indices.push(r);
      }
      quizState = { index: 0, score: 0, answered: false, currentQuestions: indices.map(i => pool[i]), wrongAnswers: [] };
      quizWinEl.classList.remove('visible');
      quizWrongReview.innerHTML = '';
      quizActions.style.display = 'none';
      renderQuizQuestion();
    }

    function shuffleOptions(opts, correctIndex) {
      const arr = opts.map((text, i) => ({ text, correct: i === correctIndex }));
      for (let i = arr.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [arr[i], arr[j]] = [arr[j], arr[i]];
      }
      return arr;
    }

    function renderQuizQuestion() {
      const q = quizState.currentQuestions[quizState.index];
      if (!q) return;
      quizCurrentEl.textContent = quizState.index + 1;
      quizScoreEl.textContent = quizState.score;
      const shuffled = shuffleOptions(q.opts, q.a);
      const subj = q.subj || 'Fundamentals';
      const subjClass = subj.toLowerCase().replace('-', '-');
      quizArea.innerHTML = `
        <div class="quiz-subject ${subjClass}">${subj}</div>
        <div class="quiz-question">${q.q}</div>
        <div class="quiz-options">
          ${shuffled.map((o, i) => `<button class="quiz-option" data-correct="${o.correct}">${o.text}</button>`).join('')}
        </div>
      `;
      quizArea.querySelectorAll('.quiz-option').forEach(opt => {
        opt.addEventListener('click', () => {
          if (quizState.answered) return;
          quizState.answered = true;
          const isCorrect = opt.dataset.correct === 'true';
          if (!isCorrect) quizState.wrongAnswers.push({ q, selectedText: opt.textContent.trim() });
          opt.classList.add(isCorrect ? 'correct' : 'wrong');
          if (isCorrect) quizState.score++;
          quizScoreEl.textContent = quizState.score;
          setTimeout(() => {
            quizState.index++;
            if (quizState.index >= quizState.currentQuestions.length) {
              quizWinEl.textContent = quizState.score === QUIZ_GAME_SIZE ? 'üéâ Perfect score! You know your care!' : `Quiz complete! You got ${quizState.score}/${QUIZ_GAME_SIZE}.`;
              quizWinEl.classList.add('visible');
              quizActions.style.display = '';
              if (quizShareBtn) quizShareBtn.style.display = 'inline-block';
              renderQuizWrongReview();
            } else {
              quizState.answered = false;
              renderQuizQuestion();
            }
          }, 800);
        });
      });
    }

    function renderQuizWrongReview() {
      if (quizState.wrongAnswers.length === 0) {
        quizWrongReview.innerHTML = '';
        return;
      }
      const subjClass = (s) => (s || 'Fundamentals').toLowerCase().replace('-', '-');
      quizWrongReview.innerHTML = `
        <h4>üìã Questions answered incorrectly (${quizState.wrongAnswers.length})</h4>
        ${quizState.wrongAnswers.map(({ q, selectedText }) => `
          <div class="quiz-wrong-item">
            <div class="quiz-subject ${subjClass(q.subj)}">${q.subj || 'Fundamentals'}</div>
            <div class="wrong-q">${q.q}</div>
            ${selectedText ? `<div class="wrong-your">Your answer: ${selectedText}</div>` : ''}
            <div class="wrong-correct">Correct: ${q.opts[q.a]}</div>
          </div>
        `).join('')}
      `;
    }

    document.getElementById('quiz-start').addEventListener('click', startQuizFromTopics);
    document.getElementById('quiz-reset').addEventListener('click', showQuizTopicSelector);

    async function createQuizShareImage(score, total) {
      const W = 600, H = 500;
      const cvs = document.createElement('canvas');
      cvs.width = W; cvs.height = H;
      const ctx = cvs.getContext('2d');
      ctx.fillStyle = 'linear-gradient(135deg, #5B8FB9 0%, #7DB8A8 100%)';
      const g = ctx.createLinearGradient(0, 0, W, H);
      g.addColorStop(0, '#5B8FB9');
      g.addColorStop(1, '#7DB8A8');
      ctx.fillStyle = g;
      ctx.fillRect(0, 0, W, H);
      ctx.fillStyle = 'rgba(255,255,255,0.15)';
      ctx.fillRect(0, 0, W, 80);

      ctx.fillStyle = '#fff';
      ctx.font = 'bold 28px Quicksand, sans-serif';
      ctx.textAlign = 'center';
      ctx.fillText('Bea\'s Care Quiz', W/2, 48);
      ctx.font = 'bold 48px Quicksand, sans-serif';
      ctx.fillText(`${score}/${total}`, W/2, 120);

      const photoSrc = (selectedPhotoIndices.length > 0 ? capturedPhotos[selectedPhotoIndices[0]] : null) || (capturedPhotos.length > 0 ? capturedPhotos[capturedPhotos.length - 1] : null);
      const photoW = 220, photoH = 220, photoY = 160, photoX = (W - photoW) / 2;

      if (photoSrc) {
        const img = new Image();
        img.crossOrigin = 'anonymous';
        await new Promise((resolve, reject) => {
          img.onload = resolve;
          img.onerror = reject;
          img.src = photoSrc;
        });
        ctx.beginPath();
        ctx.arc(photoX + photoW/2, photoY + photoH/2, photoW/2, 0, Math.PI * 2);
        ctx.closePath();
        ctx.save();
        ctx.clip();
        ctx.drawImage(img, photoX, photoY, photoW, photoH);
        ctx.restore();
        ctx.beginPath();
        ctx.arc(photoX + photoW/2, photoY + photoH/2, photoW/2, 0, Math.PI * 2);
        ctx.strokeStyle = 'rgba(255,255,255,0.8)';
        ctx.lineWidth = 4;
        ctx.stroke();
      } else {
        ctx.fillStyle = 'rgba(255,255,255,0.3)';
        ctx.beginPath();
        ctx.arc(photoX + photoW/2, photoY + photoH/2, photoW/2 - 4, 0, Math.PI * 2);
        ctx.fill();
        ctx.fillStyle = '#fff';
        ctx.font = '16px Quicksand, sans-serif';
        ctx.fillText('üì∑ Add a photo in Photo Booth!', W/2, photoY + photoH/2 + 6);
      }

      ctx.fillStyle = 'rgba(255,255,255,0.9)';
      ctx.font = '18px Quicksand, sans-serif';
      ctx.fillText('Care ‚ô• Chill ‚ô• Capture', W/2, H - 24);
      return cvs.toDataURL('image/png');
    }

    if (quizShareBtn) quizShareBtn.addEventListener('click', async () => {
      const score = quizState.score;
      const total = QUIZ_GAME_SIZE;
      try {
        const dataUrl = await createQuizShareImage(score, total);
        const blob = await (await fetch(dataUrl)).blob();
        const file = new File([blob], 'care-quiz-score.png', { type: 'image/png' });
        if (navigator.share && navigator.canShare && navigator.canShare({ files: [file] })) {
          await navigator.share({
            title: `Care Quiz: ${score}/${total}`,
            text: `I got ${score}/${total} on Bea's Care Quiz!`,
            files: [file]
          });
        } else {
          const a = document.createElement('a');
          a.href = dataUrl;
          a.download = 'care-quiz-score.png';
          a.click();
        }
      } catch (e) {
        if (e.name !== 'AbortError') {
          const dataUrl = await createQuizShareImage(score, total);
          const a = document.createElement('a');
          a.href = dataUrl;
          a.download = 'care-quiz-score.png';
          a.click();
        }
      }
    });

    showQuizTopicSelector();

    // Word Scramble - nursing/care words
    const SCRAMBLE_WORDS = [
      { word: 'STETHOSCOPE', hint: 'Listening to heart and lungs' },
      { word: 'THERMOMETER', hint: 'Measures body temperature' },
      { word: 'HYPERTENSION', hint: 'High blood pressure' },
      { word: 'MEDICATION', hint: 'Drug or treatment' },
      { word: 'RESPIRATORY', hint: 'Related to breathing' },
      { word: 'DOCUMENTATION', hint: 'Recording patient information' },
      { word: 'VACCINATION', hint: 'Immunization shot' },
      { word: 'PHLEBOTOMY', hint: 'Drawing blood' },
      { word: 'PRESCRIPTION', hint: 'Doctor\'s medication order' },
      { word: 'DIAGNOSIS', hint: 'Identifying a condition' },
      { word: 'STERILIZATION', hint: 'Making germ-free' },
      { word: 'IMMUNIZATION', hint: 'Building immunity' },
      { word: 'HYPOTENSION', hint: 'Low blood pressure' },
      { word: 'CIRCULATION', hint: 'Blood flow through body' },
      { word: 'DELEGATION', hint: 'Assigning tasks to others' },
      { word: 'AUSCULTATION', hint: 'Listening to body sounds' },
      { word: 'PALPATION', hint: 'Examining by touch' },
      { word: 'CONFIDENTIAL', hint: 'Private, not to be shared' },
      { word: 'RESUSCITATION', hint: 'Reviving from unconsciousness' },
      { word: 'PERCUSSION', hint: 'Tapping to assess density' },
      { word: 'OXIMETRY', hint: 'Measuring blood oxygen' },
      { word: 'INTRAVENOUS', hint: 'Administered into a vein' },
      { word: 'SUBCUTANEOUS', hint: 'Under the skin injection' },
      { word: 'INSULIN', hint: 'Blood sugar regulation hormone' },
      { word: 'ANESTHESIA', hint: 'Loss of sensation' },
      { word: 'CARDIAC', hint: 'Related to the heart' },
      { word: 'PNEUMONIA', hint: 'Lung infection' },
      { word: 'HEMATOMA', hint: 'Bruise or blood clot' },
      { word: 'HEMATURIA', hint: 'Blood in urine' },
      { word: 'NEUROLOGY', hint: 'Study of nervous system' },
      { word: 'ORTHOPEDIC', hint: 'Bones and joints' },
      { word: 'GASTROINTESTINAL', hint: 'Digestive system' },
      { word: 'URINARY', hint: 'Related to urine and kidneys' },
      { word: 'HEMATOLOGY', hint: 'Study of blood' },
      { word: 'ONCOLOGY', hint: 'Cancer care specialty' },
      { word: 'PEDIATRICS', hint: 'Care of children' },
      { word: 'GERIATRICS', hint: 'Care of older adults' },
      { word: 'OBSTETRICS', hint: 'Pregnancy and childbirth' },
      { word: 'REHABILITATION', hint: 'Recovery and therapy' },
      { word: 'NEBULIZER', hint: 'Breathing treatment device' },
      { word: 'DEFIBRILLATOR', hint: 'Heart rhythm restoration' },
      { word: 'CATHETER', hint: 'Tube for drainage' },
      { word: 'SPHYGMOMANOMETER', hint: 'Blood pressure cuff' },
      { word: 'GLUCOMETER', hint: 'Blood glucose monitor' },
      { word: 'HEPARIN', hint: 'Blood thinner medication' },
      { word: 'ANTIBIOTIC', hint: 'Fights bacterial infection' },
      { word: 'ANTISEPTIC', hint: 'Prevents infection' },
      { word: 'PROPHYLAXIS', hint: 'Preventive treatment' },
      { word: 'CONTRAINDICATION', hint: 'Reason to avoid treatment' }
    ];
    const SCRAMBLE_NO_REPEAT = 15;
    let scrambleState = { word: '', shuffled: [], chosen: [], score: 0, recentWords: [] };

    function getScrambleEls() {
      const panel = document.getElementById('game-scramble');
      if (!panel) return null;
      return {
        display: panel.querySelector('#scramble-display'),
        chosen: panel.querySelector('#scramble-chosen'),
        buttons: panel.querySelector('#scramble-buttons'),
        hint: panel.querySelector('#scramble-hint'),
        winEl: panel.querySelector('#scramble-win'),
        scoreEl: panel.querySelector('#scramble-score')
      };
    }

    function shuffleArr(arr) {
      const a = [...arr];
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    function initScramble() {
      const recent = scrambleState.recentWords || [];
      const available = SCRAMBLE_WORDS.filter(x => !recent.includes(x.word));
      const pool = available.length > 0 ? available : SCRAMBLE_WORDS;
      const w = pool[Math.floor(Math.random() * pool.length)];
      const newRecent = [...recent, w.word];
      if (newRecent.length > SCRAMBLE_NO_REPEAT) newRecent.shift();
      scrambleState = { word: w.word.trim(), shuffled: shuffleArr(w.word.trim().split('')), chosen: [], score: scrambleState.score, recentWords: newRecent, hint: w.hint };
      renderScramble();
    }

    function renderScramble() {
      const els = getScrambleEls();
      if (!els || !els.display || !els.buttons || !els.chosen) return;
      els.display.textContent = scrambleState.chosen.join('') || '_';
      if (els.hint) els.hint.textContent = 'Hint: ' + (scrambleState.hint || SCRAMBLE_WORDS.find(x => x.word === scrambleState.word)?.hint || '');
      if (els.winEl) els.winEl.classList.remove('visible');
      if (els.scoreEl) els.scoreEl.textContent = scrambleState.score;
      els.chosen.innerHTML = '';
      els.buttons.innerHTML = '';
      scrambleState.chosen.forEach((letter, i) => {
        const b = document.createElement('button');
        b.type = 'button';
        b.className = 'scramble-btn';
        b.textContent = letter;
        b.dataset.i = String(i);
        b.addEventListener('click', (e) => {
          e.preventDefault();
          const idx = parseInt(b.dataset.i, 10);
          const l = scrambleState.chosen.splice(idx, 1)[0];
          scrambleState.shuffled.push(l);
          scrambleState.shuffled.sort(() => Math.random() - 0.5);
          renderScramble();
        });
        els.chosen.appendChild(b);
      });
      scrambleState.shuffled.forEach((letter, i) => {
        const b = document.createElement('button');
        b.type = 'button';
        b.className = 'scramble-btn';
        b.textContent = letter;
        b.addEventListener('click', (e) => {
          e.preventDefault();
          scrambleState.shuffled.splice(i, 1);
          scrambleState.chosen.push(letter);
          const answer = scrambleState.chosen.join('');
          if (answer === scrambleState.word) {
            scrambleState.score++;
            const e2 = getScrambleEls();
            if (e2 && e2.scoreEl) e2.scoreEl.textContent = scrambleState.score;
            if (e2 && e2.winEl) e2.winEl.classList.add('visible');
            setTimeout(() => initScramble(), 1000);
          } else {
            renderScramble();
          }
        });
        els.buttons.appendChild(b);
      });
    }

    const scrambleSkipBtn = document.getElementById('scramble-skip');
    const scrambleResetBtn = document.getElementById('scramble-reset');
    if (scrambleSkipBtn) scrambleSkipBtn.addEventListener('click', initScramble);
    if (scrambleResetBtn) scrambleResetBtn.addEventListener('click', () => {
      scrambleState.score = 0;
      scrambleState.recentWords = [];
      const e = getScrambleEls();
      if (e && e.scoreEl) e.scoreEl.textContent = '0';
      initScramble();
    });
    setTimeout(() => initScramble(), 0);

    loadDraft();
    updateLoveLetter();

    function downloadPhoto(dataUrl, filename) {
      const a = document.createElement('a');
      a.href = dataUrl;
      a.download = filename;
      a.click();
    }

    // Stop camera when leaving
    window.addEventListener('beforeunload', () => {
      if (stream) stream.getTracks().forEach(t => t.stop());
    });

    /* --- Hidden developer feature: live user count ---
     * Trigger: triple-click the "Bea's Photo Booth" title
     * Setup: Add your Firebase config below. Get it at console.firebase.google.com
     * Create project ‚Üí Realtime Database ‚Üí Copy config. Set rules:
     * { "rules": { "presence": { ".read": true, ".write": true } } }
     */
    (function() {
      const DEV_CONFIG = null; /* Replace with: { apiKey:"...", authDomain:"...", databaseURL:"...", projectId:"...", storageBucket:"...", messagingSenderId:"...", appId:"..." } */
      const badge = document.getElementById('dev-presence-badge');
      const h1 = document.querySelector('h1');
      let db = null, presenceRef = null, myUid = null;

      function setBadge(text) {
        if (badge) badge.textContent = 'üë• Online: ' + text;
      }

      function toggleBadge() {
        if (!badge) return;
        badge.classList.toggle('visible');
        if (badge.classList.contains('visible') && DEV_CONFIG) {
          initPresence();
        } else if (badge.classList.contains('visible') && !DEV_CONFIG) {
          setBadge('Firebase not configured');
        }
      }

      function initPresence() {
        if (db) return;
        try {
          if (typeof firebase === 'undefined') { setBadge('Firebase not loaded'); return; }
          const app = firebase.apps.length ? firebase.app() : firebase.initializeApp(DEV_CONFIG);
          db = firebase.database(app);
          myUid = 'u_' + Math.random().toString(36).slice(2) + '_' + Date.now();
          presenceRef = db.ref('presence/' + myUid);
          presenceRef.onDisconnect().remove();
          presenceRef.set({ ts: Date.now() });
          db.ref('presence').on('value', snap => {
            const count = snap.numChildren();
            setBadge(count);
          });
        } catch (e) {
          setBadge('Error');
        }
      }

      if (h1) {
        let clicks = 0, t = 0;
        h1.addEventListener('click', () => {
          const now = Date.now();
          if (now - t > 400) clicks = 0;
          t = now;
          clicks++;
          if (clicks >= 3) {
            clicks = 0;
            toggleBadge();
          }
        });
      }
    })();
  </script>
</body>
</html>
